     1                                  ; ECE 291 Fall 2003 MP4    
     2                                  ; -- Paint291 --
     3                                  ;
     4                                  ; Completed By:
     5                                  ;  Ki Chung
     6                                  ;  Seunghoon Kim
     7                                  ;  Gi Hyun Ko
     8                                  ;  Hyun J Jeong
     9                                  ;
    10                                  ; Doug Jones
    11                                  ; Guest Author - Ryan Chmiel
    12                                  ; University of Illinois Urbana Champaign
    13                                  ; Dept. of Electrical & Computer Engineering
    14                                  ;
    15                                  ; Ver 1.0
    16                                  
    17                                  %include "lib291.inc"
    18                              <1> ; Main pmodelib include
    19                              <1> ;  By Peter Johnson, 1999-2000
    20                              <1> ;
    21                              <1> ; $Id: lib291.inc,v 1.9 2001/04/03 04:39:34 mu Exp $
    22                              <1> 
    23                              <1> %include "myC32.mac"
    24                              <2> ; NASM macro set to make interfacing to 32-bit programs easier
    25                              <2> ; Also cool little macros to make NASM emulate some MASM things.
    26                              <2> ;
    27                              <2> ; Originally included in NASM.  Modifications by Peter Johnson, 1999.
    28                              <2> ;
    29                              <2> ; $Id: myC32.mac,v 1.6 2002/03/31 08:18:22 mu Exp $
    30                              <2> 
    31                              <2> %imacro proc 1                  ; begin a procedure definition
    32                              <2> %ifctx proc
    33                              <2> %error Mismatched `endproc'/`proc'
    34                              <2> %else
    35                              <2> %push proc
    36                              <2>           global %1
    37                              <2> %1:       push  ebp
    38                              <2>           mov   ebp, esp
    39                              <2> %assign %$arg 8
    40                              <2> %assign %$local 0
    41                              <2> ;%assign %$argnum 0
    42                              <2> %define %$procname %1
    43                              <2> %endif
    44                              <2> %endmacro
    45                              <2> 
    46                              <2> %imacro arg 0-1 4               ; used with the argument name as a label
    47                              <2> %00       equ %$arg
    48                              <2> ;%assign %$argnum %$argnum+1
    49                              <2> ;.arg%$argnum   equ     %1
    50                              <2> %assign %$arg %1+%$arg
    51                              <2> %endmacro
    52                              <2> 
    53                              <2> %imacro local 0-1 4		; like arg, but declare c local variables
    54                              <2> %if %$local == 0
    55                              <2>           add   esp, .STACK_FRAME_SIZE
    56                              <2> %endif
    57                              <2> %assign %$local %$local-%1
    58                              <2> %00       equ %$local
    59                              <2> %endmacro
    60                              <2> 
    61                              <2> %imacro endproc 0
    62                              <2> %ifnctx proc
    63                              <2> %error Mismatched `endproc'/`proc'
    64                              <2> %else
    65                              <2> .STACK_FRAME_SIZE	equ	%$local	; stack size known by end
    66                              <2> ;        mov     esp, ebp
    67                              <2> ;        pop     ebp
    68                              <2> %ifdef LEGACY_ENDPROC
    69                              <2>         ret
    70                              <2> %endif
    71                              <2> ;__end_%$procname:               ; useful for calculating function size
    72                              <2> ;          global %{$procname}_arglen
    73                              <2> ;%{$procname}_arglen    equ     %$arg-8
    74                              <2> ;%assign %$i 1
    75                              <2> ;%rep %$argnum
    76                              <2> ;          global %{$procname}_arg%$i
    77                              <2> ;%{$procname}_arg%$i    equ     %{$procname}.arg%$i
    78                              <2> ;%assign %$i %$i+1
    79                              <2> ;%endrep
    80                              <2> %pop
    81                              <2> %endif
    82                              <2> %endmacro
    83                              <2> 
    84                              <2> ; redefine ret instructions for in-proc cases
    85                              <2> %imacro ret 0-1
    86                              <2> %ifnctx proc
    87                              <2> 	ret	%1
    88                              <2> %else
    89                              <2> 	mov	esp, ebp
    90                              <2> 	pop	ebp
    91                              <2> 	ret	%1
    92                              <2> %endif
    93                              <2> %endmacro
    94                              <2> 
    95                              <2> %imacro retf 0-1
    96                              <2> %ifnctx proc
    97                              <2> 	retf	%1
    98                              <2> %else
    99                              <2> 	mov	esp, ebp
   100                              <2> 	pop	ebp
   101                              <2> 	retf	%1
   102                              <2> %endif
   103                              <2> %endmacro
   104                              <2> 
   105                              <2> %imacro retn 0-1
   106                              <2> %ifnctx proc
   107                              <2> 	retn	%1
   108                              <2> %else
   109                              <2> 	mov	esp, ebp
   110                              <2> 	pop	ebp
   111                              <2> 	retn	%1
   112                              <2> %endif
   113                              <2> %endmacro
   114                              <2> 
   115                              <2> ; invoke calls a C function
   116                              <2> ; defaults to word (16 bit) size parameters
   117                              <2> %macro invoke 1-*
   118                              <2> %rotate -1
   119                              <2> ;%define invoketype word
   120                              <2> %rep (%0-1)
   121                              <2> ;       %ifidni %1,dword
   122                              <2> ;               %define invoketype dword
   123                              <2> ;       %elifidni %1,word
   124                              <2> ;               %define invoketype word
   125                              <2> ;       %elifidni %1,byte
   126                              <2> ;               %define invoketype byte
   127                              <2> ;       %else
   128                              <2>         %ifidni %1, cs
   129                              <2>                 o16 push %1
   130                              <2>         %elifidni %1, ds
   131                              <2>                 o16 push %1
   132                              <2>         %elifidni %1, es
   133                              <2>                 o16 push %1
   134                              <2>         %elifidni %1, fs
   135                              <2>                 o16 push %1
   136                              <2>         %elifidni %1, gs
   137                              <2>                 o16 push %1
   138                              <2>         %elifidni %1, word cs
   139                              <2>                 o16 push %1
   140                              <2>         %elifidni %1, word ds
   141                              <2>                 o16 push %1
   142                              <2>         %elifidni %1, word es
   143                              <2>                 o16 push %1
   144                              <2>         %elifidni %1, word fs
   145                              <2>                 o16 push %1
   146                              <2>         %elifidni %1, word gs
   147                              <2>                 o16 push %1
   148                              <2>         %else
   149                              <2>                 push %1
   150                              <2>         %endif
   151                              <2> ;       %endif
   152                              <2>         %rotate -1
   153                              <2> %endrep
   154                              <2> call %1
   155                              <2> %if (%0!=1)
   156                              <2>         add esp, byte %{1}_arglen
   157                              <2> %endif
   158                              <2> %endmacro
   159                              <2> 
   160                              <1> 
   161                              <1> %include "constant.inc"
   162                              <2> ; General constants
   163                              <2> ;  By Peter Johnson, 2001
   164                              <2> ;
   165                              <2> ; $Id: constant.inc,v 1.7 2001/12/14 19:31:20 pete Exp $
   166                              <2> 
   167                              <2> ; Socket constants:
   168                              <2> ;  Addresses:
   169                              <2> INADDR_ANY		equ	0
   170                              <2> INADDR_LOOPBACK		equ	7F000001h
   171                              <2> INADDR_BROADCAST	equ	0FFFFFFFFh
   172                              <2> INADDR_NONE		equ	0FFFFFFFFh
   173                              <2> ;  Types:
   174                              <2> SOCK_STREAM		equ	1
   175                              <2> SOCK_DGRAM		equ	2
   176                              <2> ;  Events:
   177                              <2> SOCKEVENT_READ		equ	01h
   178                              <2> SOCKEVENT_WRITE		equ	02h
   179                              <2> SOCKEVENT_OOB		equ	04h
   180                              <2> SOCKEVENT_ACCEPT	equ	08h
   181                              <2> SOCKEVENT_CONNECT	equ	10h
   182                              <2> SOCKEVENT_CLOSE		equ	20h
   183                              <2> ;  Protocols:
   184                              <2> IPPROTO_IP		equ	0
   185                              <2> IPPROTO_ICMP		equ	1
   186                              <2> IPPROTO_TCP		equ	6
   187                              <2> IPPROTO_UDP		equ	17
   188                              <2> SOL_SOCKET		equ	0FFFFh
   189                              <2> ;  Options
   190                              <2> SOCKOPT_DEBUG		equ	0001h
   191                              <2> SOCKOPT_ACCEPTCONN	equ	0002h
   192                              <2> SOCKOPT_REUSEADDR	equ	0004h
   193                              <2> SOCKOPT_KEEPALIVE	equ	0008h
   194                              <2> SOCKOPT_DONTROUTE	equ	0010h
   195                              <2> SOCKOPT_BROADCAST	equ	0020h
   196                              <2> SOCKOPT_USELOOPBACK	equ	0040h
   197                              <2> SOCKOPT_LINGER		equ	0080h
   198                              <2> SOCKOPT_DONTLINGER	equ	~0080h
   199                              <2> SOCKOPT_OOBINLINE	equ	0100h
   200                              <2> SOCKOPT_SNDBUF		equ	1001h
   201                              <2> SOCKOPT_RCVBUF		equ	1002h
   202                              <2> SOCKOPT_SNDLOWAT	equ	1003h
   203                              <2> SOCKOPT_RCVLOWAT	equ	1004h
   204                              <2> SOCKOPT_SNDTIMEOUT	equ	1005h
   205                              <2> SOCKOPT_RCVTIMEOUT	equ	1006h
   206                              <2> SOCKOPT_ERROR		equ	1007h
   207                              <2> SOCKOPT_TYPE		equ	1008h
   208                              <2> TCP_NODELAY		equ	0001h
   209                              <2> 
   210                              <2> ; Socket structures
   211                              <2> 	STRUC	SOCKADDR
   212 00000000 <res 00000002>      <2> .Port		resw	1	; Port number
   213 00000002 <res 00000004>      <2> .Address	resd	1	; Network address
   214                              <2> 	ENDSTRUC
   215                              <2> 
   216                              <2> 	STRUC	HOSTENT
   217 00000000 <res 00000004>      <2> .Name		resd	1	; Pointer to official name of host
   218 00000004 <res 00000004>      <2> .Aliases	resd	1	; Pointer to 0-terminated array of pointers to
   219                              <2> 				;  alias names
   220 00000008 <res 00000004>      <2> .AddrList	resd	1	; Pointer to 0-terminated array of pointers to
   221                              <2> 				;  addresses
   222                              <2> 	ENDSTRUC
   223                              <2> 
   224                              <1> %include "globals.inc"
   225                              <2> ; General constants and stuff
   226                              <2> ;  By Peter Johnson, 1999-2001
   227                              <2> ;
   228                              <2> ; $Id: globals.inc,v 1.4 2001/03/19 01:10:36 pete Exp $
   229                              <2> 
   230                              <2>         EXTERN _ScratchBlock    ; Scratch Block (1 meg)
   231                              <2>         EXTERN _textsel         ; Selector to the textmode ram
   232                              <2> 
   233                              <2> NET_BUFFER_SIZE equ     16*1024         ; Network send/receive buffer size
   234                              <2>                                         ; (per buffer)
   235                              <2>         
   236                              <2> RXBuffer        equ     0               ; Receive Data Buffer (offset into NetTransferSel)
   237                              <2> TXBuffer        equ     NET_BUFFER_SIZE ; Transmit Data Buffer (offset into NetTransferSel)
   238                              <2> 
   239                              <1> %include "dma.inc"
   240                              <2> ; DMA interface code (used primarily by sound routines)
   241                              <2> ;  By Peter Johnson, 1999
   242                              <2> ;
   243                              <2> ; $Id: dma.inc,v 1.2 2000/12/14 07:52:21 pete Exp $
   244                              <2> 
   245                              <2>         EXTERN  _DMA_Allocate_Mem
   246                              <2>         EXTERN  _DMA_Start
   247                              <2>         EXTERN  _DMA_Stop
   248                              <2>         EXTERN  _DMA_Todo
   249                              <2>         EXTERN  _DMA_Lock_Mem
   250                              <2> 
   251                              <2> _DMA_Allocate_Mem_arglen        equ     12
   252                              <2> _DMA_Start_arglen               equ     20
   253                              <2> _DMA_Stop_arglen                equ     4
   254                              <2> _DMA_Todo_arglen                equ     4
   255                              <2> 
   256                              <1> %include "dpmi_int.inc"
   257                              <2> ; DPMI Interrupt Interface header file
   258                              <2> ;  By Peter Johnson, 1999
   259                              <2> ;
   260                              <2> ; $Id: dpmi_int.inc,v 1.3 2000/12/14 07:52:21 pete Exp $
   261                              <2> 
   262                              <2> 	EXTERN DPMI_Int
   263                              <2> 	EXTERN _AllocTransferBuf
   264                              <2> 	EXTERN _FreeTransferBuf
   265                              <2> 
   266                              <2> 	EXTERN	DPMI_Regs
   267                              <2> 	EXTERN	DPMI_EDI
   268                              <2> 	EXTERN	DPMI_ESI
   269                              <2> 	EXTERN	DPMI_EBP
   270                              <2> 	EXTERN	DPMI_EBX
   271                              <2> 	EXTERN	DPMI_EDX
   272                              <2> 	EXTERN	DPMI_ECX
   273                              <2> 	EXTERN	DPMI_EAX
   274                              <2> 	EXTERN	DPMI_FLAGS
   275                              <2> 	EXTERN	DPMI_ES
   276                              <2> 	EXTERN	DPMI_DS
   277                              <2> 	EXTERN	DPMI_FS
   278                              <2> 	EXTERN	DPMI_GS
   279                              <2> 	EXTERN	DPMI_SP
   280                              <2> 	EXTERN	DPMI_SS
   281                              <2> 
   282                              <2> 	EXTERN	_Transfer_Buf
   283                              <2> 	EXTERN	_Transfer_Buf_Seg
   284                              <2> 	EXTERN	_Transfer_Buf_Size
   285                              <2> 
   286                              <2> DPMI_EDI_off    equ     00h
   287                              <2> DPMI_ESI_off    equ     04h
   288                              <2> DPMI_EBP_off    equ     08h
   289                              <2> ;DPMI_RES0_off  equ     0Ch
   290                              <2> DPMI_EBX_off    equ     10h
   291                              <2> DPMI_EDX_off    equ     14h
   292                              <2> DPMI_ECX_off    equ     18h
   293                              <2> DPMI_EAX_off    equ     1Ch
   294                              <2> DPMI_FLAGS_off  equ     20h
   295                              <2> DPMI_ES_off     equ     22h
   296                              <2> DPMI_DS_off     equ     24h
   297                              <2> DPMI_FS_off     equ     26h
   298                              <2> DPMI_GS_off     equ     28h
   299                              <2> DPMI_IP_off     equ     2Ah
   300                              <2> DPMI_CS_off     equ     2Ch
   301                              <2> DPMI_SP_off     equ     2Eh
   302                              <2> DPMI_SS_off     equ     30h
   303                              <1> %include "dpmi_mem.inc"
   304                              <2> ; DPMI Memory Interface header file
   305                              <2> ;  By Peter Johnson, 1999-2001
   306                              <2> ;
   307                              <2> ; $Id: dpmi_mem.inc,v 1.6 2001/03/16 23:52:18 pete Exp $
   308                              <2> 
   309                              <2> 	EXTERN _AllocMem
   310                              <2> 	EXTERN _AllocSelector
   311                              <2> 	EXTERN _FreeSelector
   312                              <2>         EXTERN _GetPhysicalMapping
   313                              <2>         EXTERN _FreePhysicalMapping
   314                              <2>         EXTERN _LockArea
   315                              <2> 
   316                              <2> _AllocMem_arglen		equ	4
   317                              <2> _AllocSelector_arglen		equ	4
   318                              <2> _FreeSelector_arglen		equ	2
   319                              <2> _GetPhysicalMapping_arglen      equ     16
   320                              <2> _FreePhysicalMapping_arglen     equ     8
   321                              <2> _LockArea_arglen                equ     10
   322                              <1> %include "filefunc.inc"
   323                              <2> ; File handling functions header file
   324                              <2> ;  By Peter Johnson, 1999-2001
   325                              <2> ;
   326                              <2> ; $Id: filefunc.inc,v 1.5 2001/03/16 22:58:36 pete Exp $
   327                              <2> 
   328                              <2> 	EXTERN _OpenFile
   329                              <2> 	EXTERN _CloseFile
   330                              <2> 	EXTERN _ReadFile
   331                              <2> 	EXTERN _ReadFile_Sel
   332                              <2> 	EXTERN _WriteFile
   333                              <2> 	EXTERN _WriteFile_Sel
   334                              <2> 	EXTERN _SeekFile
   335                              <2> 
   336                              <2> _OpenFile_arglen	equ	6
   337                              <2> _CloseFile_arglen	equ	4
   338                              <2> _ReadFile_arglen	equ	12
   339                              <2> _ReadFile_Sel_arglen	equ	14
   340                              <2> _WriteFile_arglen	equ	12
   341                              <2> _WriteFile_Sel_arglen	equ	14
   342                              <2> _SeekFile_arglen	equ	10
   343                              <1> %include "gfxfiles.inc"
   344                              <2> ; File loading functions header file
   345                              <2> ;  By Peter Johnson, 1999-2001
   346                              <2> ;
   347                              <2> ; $Id: gfxfiles.inc,v 1.6 2001/10/17 21:02:27 pete Exp $
   348                              <2> 
   349                              <2> 	EXTERN _LoadPNG
   350                              <2> 	EXTERN _LoadPNG_Sel
   351                              <2> 	EXTERN _LoadJPG
   352                              <2> 	EXTERN _LoadBMP
   353                              <2> 	EXTERN _LoadBMP_Sel
   354                              <2>         EXTERN _SaveBMP
   355                              <2>         EXTERN _SaveBMP_Sel
   356                              <2> 	
   357                              <2> _LoadPNG_arglen 	equ     16
   358                              <2> _LoadPNG_Sel_arglen 	equ     18
   359                              <2> _LoadJPG_arglen 	equ     16
   360                              <2> _LoadBMP_arglen		equ	8
   361                              <2> _LoadBMP_Sel_arglen	equ	10
   362                              <2> _SaveBMP_arglen 	equ     16
   363                              <2> _SaveBMP_Sel_arglen 	equ     18
   364                              <1> %include "int_wrap.inc"
   365                              <2> ; IRQ Wrappers and handling functions header file
   366                              <2> ;  By Peter Johnson, 1999
   367                              <2> ;
   368                              <2> ; $Id: int_wrap.inc,v 1.2 2000/12/14 07:52:21 pete Exp $
   369                              <2> 
   370                              <2>         EXTERN  _Install_Int
   371                              <2>         EXTERN  _Remove_Int
   372                              <2>         EXTERN  _Exit_IRQ
   373                              <2>         EXTERN  _Init_IRQ
   374                              <2>         EXTERN  _Restore_IRQ
   375                              <2>         EXTERN  _Enable_IRQ
   376                              <2>         EXTERN  _Disable_IRQ
   377                              <2> 
   378                              <2> _Install_Int_arglen             equ     8
   379                              <2> _Remove_Int_arglen              equ     4
   380                              <2> _Restore_IRQ_arglen             equ     4
   381                              <2> _Enable_IRQ_arglen              equ     4
   382                              <2> _Disable_IRQ_arglen             equ     4
   383                              <1> %include "lib_load.inc"
   384                              <2> ; Library Init/Deinit Header File
   385                              <2> ;  By Peter Johnson, 2000
   386                              <2> ;
   387                              <2> ; $Id: lib_load.inc,v 1.2 2000/12/14 07:52:21 pete Exp $
   388                              <2> 
   389                              <2> 	EXTERN _LibInit
   390                              <2>         EXTERN _LibExit
   391                              <2>  
   392                              <1> %include "misc.inc"
   393                              <2> ; Miscellaneous functions header file
   394                              <2> ;  By Peter Johnson, 2000
   395                              <2> ;
   396                              <2> ; $Id: misc.inc,v 1.3 2000/12/14 07:52:21 pete Exp $
   397                              <2> 
   398                              <2>         EXTERN BinAsc
   399                              <2> 	EXTERN AscBin
   400                              <2> 
   401                              <1> %include "netbios.inc"
   402                              <2> ; Include file for NetBIOS
   403                              <2> ;  Written by Peter Johnson, 2000
   404                              <2> ;
   405                              <2> ; $Id: netbios.inc,v 1.2 2000/12/14 07:52:21 pete Exp $
   406                              <2> 
   407                              <2>         EXTERN _NetInit
   408                              <2>         EXTERN _SendPacket
   409                              <2>         EXTERN _NetRelease
   410                              <2> 
   411                              <2>         EXTERN _NetTransferSel
   412                              <2> 
   413                              <2> _NetInit_arglen                 equ     12
   414                              <2> _SendPacket_arglen              equ     4
   415                              <2> 
   416                              <2> 
   417                              <1> %include "rmcbwrap.inc"
   418                              <2> ; IRQ Wrappers and handling functions header file
   419                              <2> ;  By Peter Johnson, 1999
   420                              <2> ;
   421                              <2> ; $Id: rmcbwrap.inc,v 1.2 2000/12/14 07:52:21 pete Exp $
   422                              <2> 
   423                              <2>         EXTERN  _Get_RMCB
   424                              <2>         EXTERN  _Free_RMCB
   425                              <2> 
   426                              <2> _Get_RMCB_arglen                equ     16
   427                              <2> _Free_RMCB_arglen               equ     4
   428                              <1> %include "sb16.inc"
   429                              <2> ; SB16 interface code
   430                              <2> ;  By Michael Urman, 2001
   431                              <2> ;
   432                              <2> ; $Id: sb16.inc,v 1.2 2001/04/07 20:52:00 mu Exp $
   433                              <2> 
   434                              <2> 	EXTERN	_SB16_Init
   435                              <2> 	EXTERN	_SB16_Exit
   436                              <2> 	EXTERN	_SB16_Start
   437                              <2> 	EXTERN	_SB16_Stop
   438                              <2> 	EXTERN	_SB16_SetCallback
   439                              <2> 	EXTERN	_SB16_SetFormat
   440                              <2> 	EXTERN	_SB16_SetMixers
   441                              <2> 	EXTERN	_SB16_GetChannel
   442                              <2> 
   443                              <2> 
   444                              <2> _SB16_Init_arglen		equ	4
   445                              <2> _SB16_Start_arglen		equ	12
   446                              <2> _SB16_SetCallback_arglen	equ	4
   447                              <2> _SB16_SetFormat_arglen		equ	12
   448                              <2> _SB16_SetMixers_arglen		equ	8
   449                              <1> %include "socket.inc"
   450                              <2> ; Socket (TCP/IP, UDP/IP) functions header file
   451                              <2> ;  By Peter Johnson, 2001
   452                              <2> ;
   453                              <2> ; $Id: socket.inc,v 1.4 2001/12/14 19:31:20 pete Exp $
   454                              <2> 
   455                              <2> 	EXTERN _InitSocket
   456                              <2> 	EXTERN _ExitSocket
   457                              <2> 	EXTERN _Socket_SetCallback
   458                              <2> 	EXTERN _Socket_AddCallback
   459                              <2> 	EXTERN _Socket_accept
   460                              <2> 	EXTERN _Socket_bind
   461                              <2> 	EXTERN _Socket_close
   462                              <2> 	EXTERN _Socket_connect
   463                              <2> 	EXTERN _Socket_getpeername
   464                              <2> 	EXTERN _Socket_getsockname
   465                              <2> 	EXTERN _Socket_ntohl
   466                              <2> 	EXTERN _Socket_htonl
   467                              <2> 	EXTERN _Socket_ntohs
   468                              <2> 	EXTERN _Socket_htons
   469                              <2> 	EXTERN _Socket_inet_addr
   470                              <2> 	EXTERN _Socket_inet_ntoa
   471                              <2> 	EXTERN _Socket_listen
   472                              <2> 	EXTERN _Socket_recv
   473                              <2> 	EXTERN _Socket_recvfrom
   474                              <2> 	EXTERN _Socket_send
   475                              <2> 	EXTERN _Socket_sendto
   476                              <2> 	EXTERN _Socket_shutdown
   477                              <2> 	EXTERN _Socket_create
   478                              <2> 	EXTERN _Socket_gethostbyaddr
   479                              <2> 	EXTERN _Socket_gethostbyname
   480                              <2> 	EXTERN _Socket_gethostname
   481                              <2> 	EXTERN _Socket_getsockopt
   482                              <2> 	EXTERN _Socket_setsockopt
   483                              <2> 	EXTERN _Socket_GetLastError
   484                              <2> 
   485                              <2> _Socket_SetCallback_arglen	equ	4
   486                              <2> _Socket_AddCallback_arglen	equ	8
   487                              <2> _Socket_accept_arglen		equ	8
   488                              <2> _Socket_bind_arglen		equ	8
   489                              <2> _Socket_close_arglen		equ	4
   490                              <2> _Socket_connect_arglen		equ	8
   491                              <2> _Socket_getpeername_arglen	equ	8
   492                              <2> _Socket_getsockname_arglen	equ	8
   493                              <2> _Socket_ntohl_arglen		equ	4
   494                              <2> _Socket_htonl_arglen		equ	4
   495                              <2> _Socket_ntohs_arglen		equ	2
   496                              <2> _Socket_htons_arglen		equ	2
   497                              <2> _Socket_inet_addr_arglen	equ	4
   498                              <2> _Socket_inet_ntoa_arglen	equ	4
   499                              <2> _Socket_listen_arglen		equ	8
   500                              <2> _Socket_recv_arglen		equ	16
   501                              <2> _Socket_recvfrom_arglen		equ	20
   502                              <2> _Socket_send_arglen		equ	16
   503                              <2> _Socket_sendto_arglen		equ	20
   504                              <2> _Socket_shutdown_arglen		equ	8
   505                              <2> _Socket_create_arglen		equ	4
   506                              <2> _Socket_gethostbyaddr_arglen	equ	4
   507                              <2> _Socket_gethostbyname_arglen	equ	4
   508                              <2> _Socket_gethostname_arglen	equ	8
   509                              <2> _Socket_getsockopt_arglen	equ	20
   510                              <2> _Socket_setsockopt_arglen	equ	20
   511                              <1> %include "textmode.inc"
   512                              <2> ; Text Mode (80x25x16) header file
   513                              <2> ;  By Peter Johnson, 1999
   514                              <2> ;
   515                              <2> ; $Id: textmode.inc,v 1.3 2000/12/14 07:52:21 pete Exp $
   516                              <2> 
   517                              <2>         EXTERN _SetModeC80
   518                              <2>         EXTERN _TextSetPage
   519                              <2> 	EXTERN _TextClearScreen
   520                              <2> 	EXTERN _TextWriteChar
   521                              <2> 	EXTERN _TextWriteString
   522                              <2> 
   523                              <2> _TextSetPage_arglen             equ     2
   524                              <2> _TextWriteChar_arglen		equ	8
   525                              <2> _TextWriteString_arglen		equ	10
   526                              <1> %include "vbeaf.inc"
   527                              <2> ; VBE/AF loadable graphics driver header file
   528                              <2> ;  By Peter Johnson, 2001
   529                              <2> ;
   530                              <2> ; $Id: vbeaf.inc,v 1.1 2001/03/02 08:03:39 pete Exp $
   531                              <2> 
   532                              <2> 	EXTERN _LoadGraphicsDriver
   533                              <2> 	EXTERN _InitGraphics
   534                              <2> 	EXTERN _ExitGraphics
   535                              <2> 	EXTERN _FindGraphicsMode
   536                              <2> 	EXTERN _SetGraphicsMode
   537                              <2> 	EXTERN _UnsetGraphicsMode
   538                              <2> 	EXTERN _CopyToScreen
   539                              <2> 
   540                              <2> _LoadGraphicsDriver_arglen	equ	4
   541                              <2> _InitGraphics_arglen		equ	12
   542                              <2> _FindGraphicsMode_arglen	equ	10
   543                              <2> _SetGraphicsMode_arglen		equ	2
   544                              <2> _CopyToScreen_arglen		equ	32
   545                                  %include "libmp4.inc"
   546                              <1> ; MP4 Header File
   547                              <1> 
   548                              <1> ; EXTERN all library functions
   549                              <1> 	EXTERN	_MP4LibExit
   550                              <1> 	EXTERN	_libPointInBox
   551                              <1> 	EXTERN	_libGetPixel
   552                              <1> 	EXTERN	_libDrawPixel
   553                              <1> 	EXTERN	_libDrawLine
   554                              <1> 	EXTERN	_libDrawRect
   555                              <1> 	EXTERN	_libDrawCircle
   556                              <1> 	EXTERN	_libDrawText
   557                              <1> 	EXTERN	_libClearBuffer
   558                              <1> 	EXTERN	_libCopyBuffer
   559                              <1> 	EXTERN	_libComposeBuffers
   560                              <1> 	EXTERN	_libBlurBuffer
   561                              <1> 	EXTERN	_libFloodFill
   562                              <1> 	EXTERN	_libInstallKeyboard
   563                              <1> 	EXTERN	_libRemoveKeyboard
   564                              <1> 	EXTERN	_libKeyboardISR
   565                              <1> 	EXTERN	_libInstallMouse
   566                              <1> 	EXTERN	_libRemoveMouse
   567                              <1> 	EXTERN	_libMouseCallback
   568                              <1> 	EXTERN	_MP4Main
   569                              <1> 	EXTERN	_DrawBackground
   570                              <1> 
   571                              <1> ; DEFINE all library function lengths
   572                              <1> 	_libPointInBox_arglen		EQU	12
   573                              <1> 	_libGetPixel_arglen		EQU	12
   574                              <1> 	_libDrawPixel_arglen		EQU	16
   575                              <1> 	_libDrawLine_arglen		EQU	20
   576                              <1> 	_libDrawRect_arglen		EQU	24
   577                              <1> 	_libDrawCircle_arglen		EQU	22
   578                              <1> 	_libDrawText_arglen		EQU	20
   579                              <1> 	_libClearBuffer_arglen		EQU	12
   580                              <1> 	_libCopyBuffer_arglen		EQU	20
   581                              <1> 	_libComposeBuffers_arglen	EQU	20
   582                              <1> 	_libBlurBuffer_arglen		EQU	12
   583                              <1> 	_libFloodFill_arglen		EQU	20
   584                              <1> 	_libMouseCallback_arglen	EQU	4
   585                              <1> 	_DrawBackground_arglen		EQU	8
   586                              <1> 
   587                              <1> ; GLOBAL all program functions
   588                              <1>     	GLOBAL	_PointInBox
   589                              <1> 	GLOBAL	_GetPixel
   590                              <1> 	GLOBAL	_DrawPixel
   591                              <1> 	GLOBAL	_DrawLine
   592                              <1> 	GLOBAL	_DrawRect
   593                              <1> 	GLOBAL	_DrawCircle
   594                              <1> 	GLOBAL	_DrawText
   595                              <1> 	GLOBAL	_ClearBuffer
   596                              <1> 	GLOBAL	_CopyBuffer
   597                              <1> 	GLOBAL	_ComposeBuffers
   598                              <1> 	GLOBAL	_FloodFill
   599                              <1> 	GLOBAL	_InstallKeyboard
   600                              <1> 	GLOBAL	_RemoveKeyboard
   601                              <1> 	GLOBAL	_KeyboardISR
   602                              <1> 	GLOBAL	_InstallMouse
   603                              <1> 	GLOBAL	_RemoveMouse
   604                              <1> 	GLOBAL	_MouseCallback
   605                              <1> 	GLOBAL	_MP4Main
   606                              <1> 	GLOBAL	_DrawBackground
   607                              <1> 
   608                              <1> ; GLOBAL all program variables
   609                              <1> 	GLOBAL	_GraphicsMode
   610                              <1> 	GLOBAL	_kbINT
   611                              <1> 	GLOBAL	_kbIRQ
   612                              <1> 	GLOBAL	_kbPort
   613                              <1> 	GLOBAL	_MouseSeg
   614                              <1> 	GLOBAL	_MouseOff
   615                              <1> 	GLOBAL	_MouseX
   616                              <1> 	GLOBAL	_MouseY					
   617                              <1> 	GLOBAL	_ScreenOff
   618                              <1> 	GLOBAL	_CanvasOff
   619                              <1> 	GLOBAL	_OverlayOff
   620                              <1> 	GLOBAL	_FontOff
   621                              <1> 	GLOBAL	_MenuOff
   622                              <1> 	GLOBAL	_TitleOff
   623                              <1> 	GLOBAL	_MPFlags			
   624                              <1> 	GLOBAL	_MenuItem				
   625                              <1> 	GLOBAL	_x
   626                              <1> 	GLOBAL	_y
   627                              <1> 	GLOBAL	_dx
   628                              <1> 	GLOBAL	_dy   
   629                              <1> 	GLOBAL	_lineerror
   630                              <1> 	GLOBAL	_xhorizinc
   631                              <1> 	GLOBAL	_xdiaginc
   632                              <1> 	GLOBAL	_yvertinc
   633                              <1> 	GLOBAL	_ydiaginc
   634                              <1> 	GLOBAL	_errordiaginc
   635                              <1> 	GLOBAL	_errornodiaginc
   636                              <1> 	GLOBAL	_radius
   637                              <1> 	GLOBAL	_circleerror
   638                              <1> 	GLOBAL	_xdist
   639                              <1> 	GLOBAL	_ydist
   640                              <1> 	GLOBAL	_PointQueue
   641                              <1> 	GLOBAL	_QueueHead
   642                              <1> 	GLOBAL	_QueueTail
   643                              <1> 	GLOBAL	_key
   644                              <1> 	GLOBAL	_FontFN
   645                              <1> 	GLOBAL	_MenuFN
   646                              <1> 	GLOBAL	_TitleFN
   647                              <1> 	GLOBAL	_CurrentColor
   648                              <1> 	GLOBAL	_ColorBlue
   649                              <1> 	GLOBAL	_ColorWhite
   650                              <1> 	GLOBAL	_ColorBlack
   651                              <1> 	GLOBAL	_ColorHalfBlack
   652                              <1> 	GLOBAL	_buffer
   653                              <1> 	GLOBAL	_ColorString1
   654                              <1> 	GLOBAL	_ColorString2
   655                              <1> 	GLOBAL	_ColorString3
   656                              <1> 	GLOBAL	_ColorString4
   657                              <1> 	GLOBAL	_MenuLocations
   658                              <1> 	GLOBAL	_ProcessMenu
   659                              <1> 	GLOBAL	_QwertyNames
   660                              <1> 	GLOBAL	_QwertyNames_end
   661                              <1> 	GLOBAL	_QwertyShift
   662                              <1> 	GLOBAL	_QwertyShift_end
   663                              <1> 	GLOBAL	_TextInputString
   664                              <1> 	GLOBAL	_ColorInputString
   665                              <1> 	GLOBAL	_RoundingFactor
   666                              <1> 
   667                                  
   668                                  	BITS 32
   669                                  
   670                                  	GLOBAL _main
   671                                  
   672                                  ;EXTERN	_LoadPNG
   673                                  
   674                                  ; Define Contstants
   675                                  
   676                                  	DOWNARROW	EQU	80
   677                                  	RIGHTARROW	EQU	77
   678                                  	LEFTARROW	EQU	75
   679                                  	UPARROW		EQU	72
   680                                  
   681                                  	CANVAS_X	EQU	20
   682                                  	CANVAS_Y	EQU	20
   683                                  
   684                                  	NUM_MENU_ITEMS	EQU	11
   685                                  
   686                                  	BKSP		EQU	8
   687                                  	ESC		EQU	1
   688                                  	ENTERKEY	EQU	13
   689                                  	SPACE		EQU	57
   690                                  	LSHIFT		EQU	42
   691                                  	RSHIFT		EQU	54
   692                                  
   693                                  
   694                                  	SECTION .bss
   695                                  
   696 00000000 <res 00000002>          _GraphicsMode	resw	1	; Graphics mode #
   697                                  
   698 00000002 <res 00000001>          _kbINT		resb	1	; Keyboard interrupt #
   699 00000003 <res 00000001>          _kbIRQ		resb	1	; Keyboard IRQ
   700 00000004 <res 00000002>          _kbPort		resw	1	; Keyboard port
   701                                  
   702 00000006 <res 00000002>          _MouseSeg	resw	1       ; real mode segment for MouseCallback
   703 00000008 <res 00000002>          _MouseOff	resw	1	; real mode offset for MouseCallback
   704 0000000A <res 00000002>          _MouseX		resw	1       ; X coordinate position of mouse on screen
   705 0000000C <res 00000002>          _MouseY		resw	1       ; Y coordinate position of mouse on screen
   706                                  					
   707 0000000E <res 00000004>          _ScreenOff	resd	1	; Screen image offset
   708 00000012 <res 00000004>          _CanvasOff	resd	1	; Canvas image offset
   709 00000016 <res 00000004>          _OverlayOff	resd	1	; Overlay image offset
   710 0000001A <res 00000004>          _FontOff	resd	1	; Font image offset
   711 0000001E <res 00000004>          _MenuOff	resd	1	; Menu image offset
   712 00000022 <res 00000004>          _TitleOff	resd	1	; Title Bar image offset
   713                                  
   714 00000026 <res 00000001>          _MPFlags	resb	1	; program flags
   715                                  				; Bit 0 - Exit program
   716                                  				; Bit 1 - Left mouse button (LMB) status: set if down, cleared if up
   717                                  				; Bit 2 - Change in LMB status: set if button status
   718                                  				;         moves from pressed->released or vice-versa
   719                                  				; Bit 3 - Right shift key status: set if down, cleared if up
   720                                  				; Bit 4 - Left shift key status: set if down, cleared if up
   721                                  				; Bit 5 - Key other than shift was pressed
   722                                  				; Bit 6 - Not Used Anymore
   723                                  				; Bit 7 - Status of chosen color: set if obtained with user input,
   724                                                                  ;         cleared if obtained with eyedrop (you do not have to deal
   725                                  				;         with this - the library code uses it)
   726                                  				
   727 00000027 <res 00000001>          _MenuItem	resb	1	; selected menu item
   728                                  
   729                                  ; line algorithm variables				
   730 00000028 <res 00000002>          _x		resw	1
   731 0000002A <res 00000002>          _y		resw	1
   732 0000002C <res 00000002>          _dx		resw	1
   733 0000002E <res 00000002>          _dy		resw	1
   734 00000030 <res 00000002>          _lineerror	resw	1
   735 00000032 <res 00000002>          _xhorizinc	resw	1
   736 00000034 <res 00000002>          _xdiaginc	resw	1
   737 00000036 <res 00000002>          _yvertinc	resw	1
   738 00000038 <res 00000002>          _ydiaginc	resw	1
   739 0000003A <res 00000002>          _errordiaginc	resw	1
   740 0000003C <res 00000002>          _errornodiaginc	resw	1
   741                                   
   742                                  ; circle algorithm variables
   743 0000003E <res 00000002>          _radius		resw	1
   744 00000040 <res 00000002>          _circleerror	resw	1
   745 00000042 <res 00000002>          _xdist		resw	1
   746 00000044 <res 00000002>          _ydist		resw	1
   747                                  
   748                                  ; flood fill variables
   749 00000046 <res 00000004>          _PointQueue	resd	1
   750 0000004A <res 00000004>          _QueueHead	resd	1
   751 0000004E <res 00000004>          _QueueTail	resd	1
   752                                  
   753 00000052 <res 00000001>          _key		resb	1
   754                                  
   755                                  
   756                                  	SECTION .data
   757                                  
   758                                  	
   759                                  ; Required image files
   760 00000000 666F6E742E706E6700      _FontFN		db	'font.png',0   
   761 00000009 6D656E752E706E6700      _MenuFN		db	'menu.png',0
   762 00000012 7469746C652E706E67-     _TitleFN	db	'title.png',0
   763 0000001B 00                 
   764                                  
   765                                  ; Defined color values
   766 0000001C 0000FFFF                _CurrentColor	dd	0ffff0000h	; current color
   767 00000020 FF3300FF                _ColorBlue	dd	0ff0033ffh
   768 00000024 FFFFFFFF                _ColorWhite	dd	0ffffffffh
   769 00000028 000000FF                _ColorBlack	dd	0ff000000h
   770 0000002C 000000CC                _ColorHalfBlack dd	0cc000000h
   771                                  
   772 00000030 2020202020202024        _buffer		db	'       ','$'
   773                                  
   774 00000038 456E746572206E756D-     _ColorString1	db	'Enter numerical values for','$'
   775 00000041 65726963616C207661-
   776 0000004A 6C75657320666F7224 
   777 00000053 65616368206368616E-     _ColorString2	db	'each channel (ARGB), and','$'
   778 0000005C 6E656C202841524742-
   779 00000065 292C20616E6424     
   780 0000006C 736570617261746520-     _ColorString3	db	'separate each number by a','$'
   781 00000075 65616368206E756D62-
   782 0000007E 6572206279206124   
   783 00000086 737061636520286578-     _ColorString4	db	'space (ex. 127 255 255 0).','$'
   784 0000008F 2E2031323720323535-
   785 00000098 203235352030292E24 
   786                                   
   787                                  _QwertyNames
   788 000000A1 00                      	db	0	; filler
   789 000000A2 003132333435363738-     	db	0,'1','2','3','4','5','6','7','8','9','0','-','=',BKSP
   790 000000AB 39302D3D08         
   791 000000B0 007177657274797569-     	db	0, 'q','w','e','r','t','y','u','i','o','p','[',']',ENTERKEY
   792 000000B9 6F705B5D0D         
   793 000000BE 006173646667686A6B-     	db	0,'a','s','d','f','g','h','j','k','l',';',"'","`"
   794 000000C7 6C3B2760           
   795 000000CB 005C7A786376626E6D-     	db	0,'\','z','x','c','v','b','n','m',",",'.','/',0,'*'
   796 000000D4 2C2E2F002A         
   797 000000D9 002000000000000000-     	db	0, ' ', 0, 0,0,0,0,0,0,0,0,0,0 ; F1-F10
   798 000000E2 00000000           
   799 000000E6 0000                    	db	0,0	; numlock, scroll lock
   800 000000E8 0000002D                	db	0, 0, 0, '-'
   801 000000EC 0000002B                	db	0, 0, 0, '+'
   802 000000F0 00000000                	db	0, 0, 0, 0
   803 000000F4 0000                    	db	0, 0; sysrq
   804                                  _QwertyNames_end resb 0
   805                                  
   806                                  _QwertyShift
   807 000000F6 00                      	db	0	; filler
   808 000000F7 0021402324255E262A-     	db	0,'!','@','#','$','%','^','&','*','(',')','_','+',BKSP
   809 00000100 28295F2B08         
   810 00000105 005157455254595549-     	db	0, 'Q','W','E','R','T','Y','U','I','O','P','{','}',ENTERKEY
   811 0000010E 4F507B7D0D         
   812 00000113 004153444647484A4B-     	db	0,'A','S','D','F','G','H','J','K','L',':','"','~'
   813 0000011C 4C3A227E           
   814 00000120 007C5A584356424E4D-     	db	0,'|','Z','X','C','V','B','N','M',"<",'>','?',0,'*'
   815 00000129 3C3E3F002A         
   816 0000012E 002000000000000000-     	db	0, ' ', 0, 0,0,0,0,0,0,0,0,0,0 ; F1-F10
   817 00000137 00000000           
   818 0000013B 0000                    	db	0,0	; numlock, scroll lock
   819 0000013D 0000002D                	db	0, 0, 0, '-'
   820 00000141 0000002B                	db	0, 0, 0, '+'
   821 00000145 00000000                	db	0, 0, 0, 0
   822 00000149 0000                    	db	0, 0; sysrq
   823                                  _QwertyShift_end resb 0
   824                                  
   825 0000014B 0024<rept>              _TextInputString	times 80 db 0,'$'
   826 000001EB 0024<rept>              _ColorInputString	times 15 db 0,'$'
   827                                  
   828 00000209 8000800080000000        _RoundingFactor	dd	000800080h, 00000080h
   829                                  
   830                                  
   831                                  	SECTION .text
   832                                  
   833                                  
   834                                  _main
   835 00000000 E8(00000000)            	call	_LibInit
   836                                  
   837                                  	; Allocate Screen Image buffer
   838                                  	invoke	_AllocMem, dword 640*480*4
   839                              <1> %rotate -1
   840                              <1> 
   841                              <1> %rep (%0-1)
   842                              <1> 
   843                              <1> 
   844                              <1> 
   845                              <1> 
   846                              <1> 
   847                              <1> 
   848                              <1> 
   849                              <1>  %ifidni %1, cs
   850                              <1>  o16 push %1
   851                              <1>  %elifidni %1, ds
   852                              <1>  o16 push %1
   853                              <1>  %elifidni %1, es
   854                              <1>  o16 push %1
   855                              <1>  %elifidni %1, fs
   856                              <1>  o16 push %1
   857                              <1>  %elifidni %1, gs
   858                              <1>  o16 push %1
   859                              <1>  %elifidni %1, word cs
   860                              <1>  o16 push %1
   861                              <1>  %elifidni %1, word ds
   862                              <1>  o16 push %1
   863                              <1>  %elifidni %1, word es
   864                              <1>  o16 push %1
   865                              <1>  %elifidni %1, word fs
   866                              <1>  o16 push %1
   867                              <1>  %elifidni %1, word gs
   868                              <1>  o16 push %1
   869                              <1>  %else
   870                              <1>  push %1
   871                              <1>  %endif
   872                              <1> 
   873                              <1>  %rotate -1
   874                              <1> %endrep
   875                              <2> 
   876                              <2> 
   877                              <2> 
   878                              <2> 
   879                              <2> 
   880                              <2> 
   881                              <2> 
   882                              <2>  %ifidni %1, cs
   883                              <2>  o16 push %1
   884                              <2>  %elifidni %1, ds
   885                              <2>  o16 push %1
   886                              <2>  %elifidni %1, es
   887                              <2>  o16 push %1
   888                              <2>  %elifidni %1, fs
   889                              <2>  o16 push %1
   890                              <2>  %elifidni %1, gs
   891                              <2>  o16 push %1
   892                              <2>  %elifidni %1, word cs
   893                              <2>  o16 push %1
   894                              <2>  %elifidni %1, word ds
   895                              <2>  o16 push %1
   896                              <2>  %elifidni %1, word es
   897                              <2>  o16 push %1
   898                              <2>  %elifidni %1, word fs
   899                              <2>  o16 push %1
   900                              <2>  %elifidni %1, word gs
   901                              <2>  o16 push %1
   902                              <2>  %else
   903 00000005 6800C01200          <2>  push %1
   904                              <2>  %endif
   905                              <2> 
   906                              <2>  %rotate -1
   907 0000000A E8(00000000)        <1> call %1
   908                              <1> %if (%0!=1)
   909 0000000F 83C404              <1>  add esp, byte %1_arglen
   910                              <1> %endif
   911 00000012 3DFFFFFFFF              	cmp	eax, -1
   912 00000017 0F849D010000            	je	near .memerror
   913 0000001D A3[0E000000]            	mov	[_ScreenOff], eax
   914                                  
   915                                  	; Allocate Canvas Image buffer
   916                                  	invoke	_AllocMem, dword 480*400*4
   917                              <1> %rotate -1
   918                              <1> 
   919                              <1> %rep (%0-1)
   920                              <1> 
   921                              <1> 
   922                              <1> 
   923                              <1> 
   924                              <1> 
   925                              <1> 
   926                              <1> 
   927                              <1>  %ifidni %1, cs
   928                              <1>  o16 push %1
   929                              <1>  %elifidni %1, ds
   930                              <1>  o16 push %1
   931                              <1>  %elifidni %1, es
   932                              <1>  o16 push %1
   933                              <1>  %elifidni %1, fs
   934                              <1>  o16 push %1
   935                              <1>  %elifidni %1, gs
   936                              <1>  o16 push %1
   937                              <1>  %elifidni %1, word cs
   938                              <1>  o16 push %1
   939                              <1>  %elifidni %1, word ds
   940                              <1>  o16 push %1
   941                              <1>  %elifidni %1, word es
   942                              <1>  o16 push %1
   943                              <1>  %elifidni %1, word fs
   944                              <1>  o16 push %1
   945                              <1>  %elifidni %1, word gs
   946                              <1>  o16 push %1
   947                              <1>  %else
   948                              <1>  push %1
   949                              <1>  %endif
   950                              <1> 
   951                              <1>  %rotate -1
   952                              <1> %endrep
   953                              <2> 
   954                              <2> 
   955                              <2> 
   956                              <2> 
   957                              <2> 
   958                              <2> 
   959                              <2> 
   960                              <2>  %ifidni %1, cs
   961                              <2>  o16 push %1
   962                              <2>  %elifidni %1, ds
   963                              <2>  o16 push %1
   964                              <2>  %elifidni %1, es
   965                              <2>  o16 push %1
   966                              <2>  %elifidni %1, fs
   967                              <2>  o16 push %1
   968                              <2>  %elifidni %1, gs
   969                              <2>  o16 push %1
   970                              <2>  %elifidni %1, word cs
   971                              <2>  o16 push %1
   972                              <2>  %elifidni %1, word ds
   973                              <2>  o16 push %1
   974                              <2>  %elifidni %1, word es
   975                              <2>  o16 push %1
   976                              <2>  %elifidni %1, word fs
   977                              <2>  o16 push %1
   978                              <2>  %elifidni %1, word gs
   979                              <2>  o16 push %1
   980                              <2>  %else
   981 00000022 6800B80B00          <2>  push %1
   982                              <2>  %endif
   983                              <2> 
   984                              <2>  %rotate -1
   985 00000027 E8(00000000)        <1> call %1
   986                              <1> %if (%0!=1)
   987 0000002C 83C404              <1>  add esp, byte %1_arglen
   988                              <1> %endif
   989 0000002F 3DFFFFFFFF              	cmp	eax, -1
   990 00000034 0F8480010000            	je	near .memerror
   991 0000003A A3[12000000]            	mov	[_CanvasOff], eax
   992                                  
   993                                  	; Allocate Overlay Image buffer
   994                                  	invoke	_AllocMem, dword 480*400*4
   995                              <1> %rotate -1
   996                              <1> 
   997                              <1> %rep (%0-1)
   998                              <1> 
   999                              <1> 
  1000                              <1> 
  1001                              <1> 
  1002                              <1> 
  1003                              <1> 
  1004                              <1> 
  1005                              <1>  %ifidni %1, cs
  1006                              <1>  o16 push %1
  1007                              <1>  %elifidni %1, ds
  1008                              <1>  o16 push %1
  1009                              <1>  %elifidni %1, es
  1010                              <1>  o16 push %1
  1011                              <1>  %elifidni %1, fs
  1012                              <1>  o16 push %1
  1013                              <1>  %elifidni %1, gs
  1014                              <1>  o16 push %1
  1015                              <1>  %elifidni %1, word cs
  1016                              <1>  o16 push %1
  1017                              <1>  %elifidni %1, word ds
  1018                              <1>  o16 push %1
  1019                              <1>  %elifidni %1, word es
  1020                              <1>  o16 push %1
  1021                              <1>  %elifidni %1, word fs
  1022                              <1>  o16 push %1
  1023                              <1>  %elifidni %1, word gs
  1024                              <1>  o16 push %1
  1025                              <1>  %else
  1026                              <1>  push %1
  1027                              <1>  %endif
  1028                              <1> 
  1029                              <1>  %rotate -1
  1030                              <1> %endrep
  1031                              <2> 
  1032                              <2> 
  1033                              <2> 
  1034                              <2> 
  1035                              <2> 
  1036                              <2> 
  1037                              <2> 
  1038                              <2>  %ifidni %1, cs
  1039                              <2>  o16 push %1
  1040                              <2>  %elifidni %1, ds
  1041                              <2>  o16 push %1
  1042                              <2>  %elifidni %1, es
  1043                              <2>  o16 push %1
  1044                              <2>  %elifidni %1, fs
  1045                              <2>  o16 push %1
  1046                              <2>  %elifidni %1, gs
  1047                              <2>  o16 push %1
  1048                              <2>  %elifidni %1, word cs
  1049                              <2>  o16 push %1
  1050                              <2>  %elifidni %1, word ds
  1051                              <2>  o16 push %1
  1052                              <2>  %elifidni %1, word es
  1053                              <2>  o16 push %1
  1054                              <2>  %elifidni %1, word fs
  1055                              <2>  o16 push %1
  1056                              <2>  %elifidni %1, word gs
  1057                              <2>  o16 push %1
  1058                              <2>  %else
  1059 0000003F 6800B80B00          <2>  push %1
  1060                              <2>  %endif
  1061                              <2> 
  1062                              <2>  %rotate -1
  1063 00000044 E8(00000000)        <1> call %1
  1064                              <1> %if (%0!=1)
  1065 00000049 83C404              <1>  add esp, byte %1_arglen
  1066                              <1> %endif
  1067 0000004C 3DFFFFFFFF              	cmp	eax, -1
  1068 00000051 0F8463010000            	je	near .memerror
  1069 00000057 A3[16000000]            	mov	[_OverlayOff], eax
  1070                                  
  1071                                  	; Allocate Font Image buffer
  1072                                  	invoke	_AllocMem, dword 2048*16*4
  1073                              <1> %rotate -1
  1074                              <1> 
  1075                              <1> %rep (%0-1)
  1076                              <1> 
  1077                              <1> 
  1078                              <1> 
  1079                              <1> 
  1080                              <1> 
  1081                              <1> 
  1082                              <1> 
  1083                              <1>  %ifidni %1, cs
  1084                              <1>  o16 push %1
  1085                              <1>  %elifidni %1, ds
  1086                              <1>  o16 push %1
  1087                              <1>  %elifidni %1, es
  1088                              <1>  o16 push %1
  1089                              <1>  %elifidni %1, fs
  1090                              <1>  o16 push %1
  1091                              <1>  %elifidni %1, gs
  1092                              <1>  o16 push %1
  1093                              <1>  %elifidni %1, word cs
  1094                              <1>  o16 push %1
  1095                              <1>  %elifidni %1, word ds
  1096                              <1>  o16 push %1
  1097                              <1>  %elifidni %1, word es
  1098                              <1>  o16 push %1
  1099                              <1>  %elifidni %1, word fs
  1100                              <1>  o16 push %1
  1101                              <1>  %elifidni %1, word gs
  1102                              <1>  o16 push %1
  1103                              <1>  %else
  1104                              <1>  push %1
  1105                              <1>  %endif
  1106                              <1> 
  1107                              <1>  %rotate -1
  1108                              <1> %endrep
  1109                              <2> 
  1110                              <2> 
  1111                              <2> 
  1112                              <2> 
  1113                              <2> 
  1114                              <2> 
  1115                              <2> 
  1116                              <2>  %ifidni %1, cs
  1117                              <2>  o16 push %1
  1118                              <2>  %elifidni %1, ds
  1119                              <2>  o16 push %1
  1120                              <2>  %elifidni %1, es
  1121                              <2>  o16 push %1
  1122                              <2>  %elifidni %1, fs
  1123                              <2>  o16 push %1
  1124                              <2>  %elifidni %1, gs
  1125                              <2>  o16 push %1
  1126                              <2>  %elifidni %1, word cs
  1127                              <2>  o16 push %1
  1128                              <2>  %elifidni %1, word ds
  1129                              <2>  o16 push %1
  1130                              <2>  %elifidni %1, word es
  1131                              <2>  o16 push %1
  1132                              <2>  %elifidni %1, word fs
  1133                              <2>  o16 push %1
  1134                              <2>  %elifidni %1, word gs
  1135                              <2>  o16 push %1
  1136                              <2>  %else
  1137 0000005C 6800000200          <2>  push %1
  1138                              <2>  %endif
  1139                              <2> 
  1140                              <2>  %rotate -1
  1141 00000061 E8(00000000)        <1> call %1
  1142                              <1> %if (%0!=1)
  1143 00000066 83C404              <1>  add esp, byte %1_arglen
  1144                              <1> %endif
  1145 00000069 3DFFFFFFFF              	cmp	eax, -1
  1146 0000006E 0F8446010000            	je	near .memerror
  1147 00000074 A3[1A000000]            	mov	[_FontOff], eax  
  1148                                  
  1149                                  	; Allocate Menu Image buffer
  1150                                  	invoke	_AllocMem, dword 400*100*4
  1151                              <1> %rotate -1
  1152                              <1> 
  1153                              <1> %rep (%0-1)
  1154                              <1> 
  1155                              <1> 
  1156                              <1> 
  1157                              <1> 
  1158                              <1> 
  1159                              <1> 
  1160                              <1> 
  1161                              <1>  %ifidni %1, cs
  1162                              <1>  o16 push %1
  1163                              <1>  %elifidni %1, ds
  1164                              <1>  o16 push %1
  1165                              <1>  %elifidni %1, es
  1166                              <1>  o16 push %1
  1167                              <1>  %elifidni %1, fs
  1168                              <1>  o16 push %1
  1169                              <1>  %elifidni %1, gs
  1170                              <1>  o16 push %1
  1171                              <1>  %elifidni %1, word cs
  1172                              <1>  o16 push %1
  1173                              <1>  %elifidni %1, word ds
  1174                              <1>  o16 push %1
  1175                              <1>  %elifidni %1, word es
  1176                              <1>  o16 push %1
  1177                              <1>  %elifidni %1, word fs
  1178                              <1>  o16 push %1
  1179                              <1>  %elifidni %1, word gs
  1180                              <1>  o16 push %1
  1181                              <1>  %else
  1182                              <1>  push %1
  1183                              <1>  %endif
  1184                              <1> 
  1185                              <1>  %rotate -1
  1186                              <1> %endrep
  1187                              <2> 
  1188                              <2> 
  1189                              <2> 
  1190                              <2> 
  1191                              <2> 
  1192                              <2> 
  1193                              <2> 
  1194                              <2>  %ifidni %1, cs
  1195                              <2>  o16 push %1
  1196                              <2>  %elifidni %1, ds
  1197                              <2>  o16 push %1
  1198                              <2>  %elifidni %1, es
  1199                              <2>  o16 push %1
  1200                              <2>  %elifidni %1, fs
  1201                              <2>  o16 push %1
  1202                              <2>  %elifidni %1, gs
  1203                              <2>  o16 push %1
  1204                              <2>  %elifidni %1, word cs
  1205                              <2>  o16 push %1
  1206                              <2>  %elifidni %1, word ds
  1207                              <2>  o16 push %1
  1208                              <2>  %elifidni %1, word es
  1209                              <2>  o16 push %1
  1210                              <2>  %elifidni %1, word fs
  1211                              <2>  o16 push %1
  1212                              <2>  %elifidni %1, word gs
  1213                              <2>  o16 push %1
  1214                              <2>  %else
  1215 00000079 6800710200          <2>  push %1
  1216                              <2>  %endif
  1217                              <2> 
  1218                              <2>  %rotate -1
  1219 0000007E E8(00000000)        <1> call %1
  1220                              <1> %if (%0!=1)
  1221 00000083 83C404              <1>  add esp, byte %1_arglen
  1222                              <1> %endif
  1223 00000086 3DFFFFFFFF              	cmp	eax, -1
  1224 0000008B 0F8429010000            	je	near .memerror
  1225 00000091 A3[1E000000]            	mov	[_MenuOff], eax 
  1226                                  
  1227                                  	; Allocate Title Bar Image buffer
  1228                                  	invoke	_AllocMem, dword 640*20*4
  1229                              <1> %rotate -1
  1230                              <1> 
  1231                              <1> %rep (%0-1)
  1232                              <1> 
  1233                              <1> 
  1234                              <1> 
  1235                              <1> 
  1236                              <1> 
  1237                              <1> 
  1238                              <1> 
  1239                              <1>  %ifidni %1, cs
  1240                              <1>  o16 push %1
  1241                              <1>  %elifidni %1, ds
  1242                              <1>  o16 push %1
  1243                              <1>  %elifidni %1, es
  1244                              <1>  o16 push %1
  1245                              <1>  %elifidni %1, fs
  1246                              <1>  o16 push %1
  1247                              <1>  %elifidni %1, gs
  1248                              <1>  o16 push %1
  1249                              <1>  %elifidni %1, word cs
  1250                              <1>  o16 push %1
  1251                              <1>  %elifidni %1, word ds
  1252                              <1>  o16 push %1
  1253                              <1>  %elifidni %1, word es
  1254                              <1>  o16 push %1
  1255                              <1>  %elifidni %1, word fs
  1256                              <1>  o16 push %1
  1257                              <1>  %elifidni %1, word gs
  1258                              <1>  o16 push %1
  1259                              <1>  %else
  1260                              <1>  push %1
  1261                              <1>  %endif
  1262                              <1> 
  1263                              <1>  %rotate -1
  1264                              <1> %endrep
  1265                              <2> 
  1266                              <2> 
  1267                              <2> 
  1268                              <2> 
  1269                              <2> 
  1270                              <2> 
  1271                              <2> 
  1272                              <2>  %ifidni %1, cs
  1273                              <2>  o16 push %1
  1274                              <2>  %elifidni %1, ds
  1275                              <2>  o16 push %1
  1276                              <2>  %elifidni %1, es
  1277                              <2>  o16 push %1
  1278                              <2>  %elifidni %1, fs
  1279                              <2>  o16 push %1
  1280                              <2>  %elifidni %1, gs
  1281                              <2>  o16 push %1
  1282                              <2>  %elifidni %1, word cs
  1283                              <2>  o16 push %1
  1284                              <2>  %elifidni %1, word ds
  1285                              <2>  o16 push %1
  1286                              <2>  %elifidni %1, word es
  1287                              <2>  o16 push %1
  1288                              <2>  %elifidni %1, word fs
  1289                              <2>  o16 push %1
  1290                              <2>  %elifidni %1, word gs
  1291                              <2>  o16 push %1
  1292                              <2>  %else
  1293 00000096 6800C80000          <2>  push %1
  1294                              <2>  %endif
  1295                              <2> 
  1296                              <2>  %rotate -1
  1297 0000009B E8(00000000)        <1> call %1
  1298                              <1> %if (%0!=1)
  1299 000000A0 83C404              <1>  add esp, byte %1_arglen
  1300                              <1> %endif
  1301 000000A3 3DFFFFFFFF              	cmp	eax, -1
  1302 000000A8 0F840C010000            	je	near .memerror
  1303 000000AE A3[22000000]            	mov	[_TitleOff], eax 
  1304                                  
  1305                                  	; Allocate Point Queue
  1306                                  	invoke	_AllocMem, dword 480*400*4*4
  1307                              <1> %rotate -1
  1308                              <1> 
  1309                              <1> %rep (%0-1)
  1310                              <1> 
  1311                              <1> 
  1312                              <1> 
  1313                              <1> 
  1314                              <1> 
  1315                              <1> 
  1316                              <1> 
  1317                              <1>  %ifidni %1, cs
  1318                              <1>  o16 push %1
  1319                              <1>  %elifidni %1, ds
  1320                              <1>  o16 push %1
  1321                              <1>  %elifidni %1, es
  1322                              <1>  o16 push %1
  1323                              <1>  %elifidni %1, fs
  1324                              <1>  o16 push %1
  1325                              <1>  %elifidni %1, gs
  1326                              <1>  o16 push %1
  1327                              <1>  %elifidni %1, word cs
  1328                              <1>  o16 push %1
  1329                              <1>  %elifidni %1, word ds
  1330                              <1>  o16 push %1
  1331                              <1>  %elifidni %1, word es
  1332                              <1>  o16 push %1
  1333                              <1>  %elifidni %1, word fs
  1334                              <1>  o16 push %1
  1335                              <1>  %elifidni %1, word gs
  1336                              <1>  o16 push %1
  1337                              <1>  %else
  1338                              <1>  push %1
  1339                              <1>  %endif
  1340                              <1> 
  1341                              <1>  %rotate -1
  1342                              <1> %endrep
  1343                              <2> 
  1344                              <2> 
  1345                              <2> 
  1346                              <2> 
  1347                              <2> 
  1348                              <2> 
  1349                              <2> 
  1350                              <2>  %ifidni %1, cs
  1351                              <2>  o16 push %1
  1352                              <2>  %elifidni %1, ds
  1353                              <2>  o16 push %1
  1354                              <2>  %elifidni %1, es
  1355                              <2>  o16 push %1
  1356                              <2>  %elifidni %1, fs
  1357                              <2>  o16 push %1
  1358                              <2>  %elifidni %1, gs
  1359                              <2>  o16 push %1
  1360                              <2>  %elifidni %1, word cs
  1361                              <2>  o16 push %1
  1362                              <2>  %elifidni %1, word ds
  1363                              <2>  o16 push %1
  1364                              <2>  %elifidni %1, word es
  1365                              <2>  o16 push %1
  1366                              <2>  %elifidni %1, word fs
  1367                              <2>  o16 push %1
  1368                              <2>  %elifidni %1, word gs
  1369                              <2>  o16 push %1
  1370                              <2>  %else
  1371 000000B3 6800E02E00          <2>  push %1
  1372                              <2>  %endif
  1373                              <2> 
  1374                              <2>  %rotate -1
  1375 000000B8 E8(00000000)        <1> call %1
  1376                              <1> %if (%0!=1)
  1377 000000BD 83C404              <1>  add esp, byte %1_arglen
  1378                              <1> %endif
  1379 000000C0 3DFFFFFFFF              	cmp	eax, -1
  1380 000000C5 0F84EF000000            	je	near .memerror
  1381 000000CB A3[46000000]            	mov	[_PointQueue], eax
  1382                                  
  1383                                  	; Load image files
  1384                                  	invoke	_LoadPNG, dword _FontFN, dword [_FontOff], dword 0, dword 0 
  1385                              <1> %rotate -1
  1386                              <1> 
  1387                              <1> %rep (%0-1)
  1388                              <1> 
  1389                              <1> 
  1390                              <1> 
  1391                              <1> 
  1392                              <1> 
  1393                              <1> 
  1394                              <1> 
  1395                              <1>  %ifidni %1, cs
  1396                              <1>  o16 push %1
  1397                              <1>  %elifidni %1, ds
  1398                              <1>  o16 push %1
  1399                              <1>  %elifidni %1, es
  1400                              <1>  o16 push %1
  1401                              <1>  %elifidni %1, fs
  1402                              <1>  o16 push %1
  1403                              <1>  %elifidni %1, gs
  1404                              <1>  o16 push %1
  1405                              <1>  %elifidni %1, word cs
  1406                              <1>  o16 push %1
  1407                              <1>  %elifidni %1, word ds
  1408                              <1>  o16 push %1
  1409                              <1>  %elifidni %1, word es
  1410                              <1>  o16 push %1
  1411                              <1>  %elifidni %1, word fs
  1412                              <1>  o16 push %1
  1413                              <1>  %elifidni %1, word gs
  1414                              <1>  o16 push %1
  1415                              <1>  %else
  1416                              <1>  push %1
  1417                              <1>  %endif
  1418                              <1> 
  1419                              <1>  %rotate -1
  1420                              <1> %endrep
  1421                              <2> 
  1422                              <2> 
  1423                              <2> 
  1424                              <2> 
  1425                              <2> 
  1426                              <2> 
  1427                              <2> 
  1428                              <2>  %ifidni %1, cs
  1429                              <2>  o16 push %1
  1430                              <2>  %elifidni %1, ds
  1431                              <2>  o16 push %1
  1432                              <2>  %elifidni %1, es
  1433                              <2>  o16 push %1
  1434                              <2>  %elifidni %1, fs
  1435                              <2>  o16 push %1
  1436                              <2>  %elifidni %1, gs
  1437                              <2>  o16 push %1
  1438                              <2>  %elifidni %1, word cs
  1439                              <2>  o16 push %1
  1440                              <2>  %elifidni %1, word ds
  1441                              <2>  o16 push %1
  1442                              <2>  %elifidni %1, word es
  1443                              <2>  o16 push %1
  1444                              <2>  %elifidni %1, word fs
  1445                              <2>  o16 push %1
  1446                              <2>  %elifidni %1, word gs
  1447                              <2>  o16 push %1
  1448                              <2>  %else
  1449 000000D0 6800000000          <2>  push %1
  1450                              <2>  %endif
  1451                              <2> 
  1452                              <2>  %rotate -1
  1453                              <2> 
  1454                              <2> 
  1455                              <2> 
  1456                              <2> 
  1457                              <2> 
  1458                              <2> 
  1459                              <2> 
  1460                              <2>  %ifidni %1, cs
  1461                              <2>  o16 push %1
  1462                              <2>  %elifidni %1, ds
  1463                              <2>  o16 push %1
  1464                              <2>  %elifidni %1, es
  1465                              <2>  o16 push %1
  1466                              <2>  %elifidni %1, fs
  1467                              <2>  o16 push %1
  1468                              <2>  %elifidni %1, gs
  1469                              <2>  o16 push %1
  1470                              <2>  %elifidni %1, word cs
  1471                              <2>  o16 push %1
  1472                              <2>  %elifidni %1, word ds
  1473                              <2>  o16 push %1
  1474                              <2>  %elifidni %1, word es
  1475                              <2>  o16 push %1
  1476                              <2>  %elifidni %1, word fs
  1477                              <2>  o16 push %1
  1478                              <2>  %elifidni %1, word gs
  1479                              <2>  o16 push %1
  1480                              <2>  %else
  1481 000000D5 6800000000          <2>  push %1
  1482                              <2>  %endif
  1483                              <2> 
  1484                              <2>  %rotate -1
  1485                              <2> 
  1486                              <2> 
  1487                              <2> 
  1488                              <2> 
  1489                              <2> 
  1490                              <2> 
  1491                              <2> 
  1492                              <2>  %ifidni %1, cs
  1493                              <2>  o16 push %1
  1494                              <2>  %elifidni %1, ds
  1495                              <2>  o16 push %1
  1496                              <2>  %elifidni %1, es
  1497                              <2>  o16 push %1
  1498                              <2>  %elifidni %1, fs
  1499                              <2>  o16 push %1
  1500                              <2>  %elifidni %1, gs
  1501                              <2>  o16 push %1
  1502                              <2>  %elifidni %1, word cs
  1503                              <2>  o16 push %1
  1504                              <2>  %elifidni %1, word ds
  1505                              <2>  o16 push %1
  1506                              <2>  %elifidni %1, word es
  1507                              <2>  o16 push %1
  1508                              <2>  %elifidni %1, word fs
  1509                              <2>  o16 push %1
  1510                              <2>  %elifidni %1, word gs
  1511                              <2>  o16 push %1
  1512                              <2>  %else
  1513 000000DA FF35[1A000000]      <2>  push %1
  1514                              <2>  %endif
  1515                              <2> 
  1516                              <2>  %rotate -1
  1517                              <2> 
  1518                              <2> 
  1519                              <2> 
  1520                              <2> 
  1521                              <2> 
  1522                              <2> 
  1523                              <2> 
  1524                              <2>  %ifidni %1, cs
  1525                              <2>  o16 push %1
  1526                              <2>  %elifidni %1, ds
  1527                              <2>  o16 push %1
  1528                              <2>  %elifidni %1, es
  1529                              <2>  o16 push %1
  1530                              <2>  %elifidni %1, fs
  1531                              <2>  o16 push %1
  1532                              <2>  %elifidni %1, gs
  1533                              <2>  o16 push %1
  1534                              <2>  %elifidni %1, word cs
  1535                              <2>  o16 push %1
  1536                              <2>  %elifidni %1, word ds
  1537                              <2>  o16 push %1
  1538                              <2>  %elifidni %1, word es
  1539                              <2>  o16 push %1
  1540                              <2>  %elifidni %1, word fs
  1541                              <2>  o16 push %1
  1542                              <2>  %elifidni %1, word gs
  1543                              <2>  o16 push %1
  1544                              <2>  %else
  1545 000000E0 68[00000000]        <2>  push %1
  1546                              <2>  %endif
  1547                              <2> 
  1548                              <2>  %rotate -1
  1549 000000E5 E8(00000000)        <1> call %1
  1550                              <1> %if (%0!=1)
  1551 000000EA 83C410              <1>  add esp, byte %1_arglen
  1552                              <1> %endif
  1553                                  	invoke	_LoadPNG, dword _MenuFN, dword [_MenuOff], dword 0, dword 0 
  1554                              <1> %rotate -1
  1555                              <1> 
  1556                              <1> %rep (%0-1)
  1557                              <1> 
  1558                              <1> 
  1559                              <1> 
  1560                              <1> 
  1561                              <1> 
  1562                              <1> 
  1563                              <1> 
  1564                              <1>  %ifidni %1, cs
  1565                              <1>  o16 push %1
  1566                              <1>  %elifidni %1, ds
  1567                              <1>  o16 push %1
  1568                              <1>  %elifidni %1, es
  1569                              <1>  o16 push %1
  1570                              <1>  %elifidni %1, fs
  1571                              <1>  o16 push %1
  1572                              <1>  %elifidni %1, gs
  1573                              <1>  o16 push %1
  1574                              <1>  %elifidni %1, word cs
  1575                              <1>  o16 push %1
  1576                              <1>  %elifidni %1, word ds
  1577                              <1>  o16 push %1
  1578                              <1>  %elifidni %1, word es
  1579                              <1>  o16 push %1
  1580                              <1>  %elifidni %1, word fs
  1581                              <1>  o16 push %1
  1582                              <1>  %elifidni %1, word gs
  1583                              <1>  o16 push %1
  1584                              <1>  %else
  1585                              <1>  push %1
  1586                              <1>  %endif
  1587                              <1> 
  1588                              <1>  %rotate -1
  1589                              <1> %endrep
  1590                              <2> 
  1591                              <2> 
  1592                              <2> 
  1593                              <2> 
  1594                              <2> 
  1595                              <2> 
  1596                              <2> 
  1597                              <2>  %ifidni %1, cs
  1598                              <2>  o16 push %1
  1599                              <2>  %elifidni %1, ds
  1600                              <2>  o16 push %1
  1601                              <2>  %elifidni %1, es
  1602                              <2>  o16 push %1
  1603                              <2>  %elifidni %1, fs
  1604                              <2>  o16 push %1
  1605                              <2>  %elifidni %1, gs
  1606                              <2>  o16 push %1
  1607                              <2>  %elifidni %1, word cs
  1608                              <2>  o16 push %1
  1609                              <2>  %elifidni %1, word ds
  1610                              <2>  o16 push %1
  1611                              <2>  %elifidni %1, word es
  1612                              <2>  o16 push %1
  1613                              <2>  %elifidni %1, word fs
  1614                              <2>  o16 push %1
  1615                              <2>  %elifidni %1, word gs
  1616                              <2>  o16 push %1
  1617                              <2>  %else
  1618 000000ED 6800000000          <2>  push %1
  1619                              <2>  %endif
  1620                              <2> 
  1621                              <2>  %rotate -1
  1622                              <2> 
  1623                              <2> 
  1624                              <2> 
  1625                              <2> 
  1626                              <2> 
  1627                              <2> 
  1628                              <2> 
  1629                              <2>  %ifidni %1, cs
  1630                              <2>  o16 push %1
  1631                              <2>  %elifidni %1, ds
  1632                              <2>  o16 push %1
  1633                              <2>  %elifidni %1, es
  1634                              <2>  o16 push %1
  1635                              <2>  %elifidni %1, fs
  1636                              <2>  o16 push %1
  1637                              <2>  %elifidni %1, gs
  1638                              <2>  o16 push %1
  1639                              <2>  %elifidni %1, word cs
  1640                              <2>  o16 push %1
  1641                              <2>  %elifidni %1, word ds
  1642                              <2>  o16 push %1
  1643                              <2>  %elifidni %1, word es
  1644                              <2>  o16 push %1
  1645                              <2>  %elifidni %1, word fs
  1646                              <2>  o16 push %1
  1647                              <2>  %elifidni %1, word gs
  1648                              <2>  o16 push %1
  1649                              <2>  %else
  1650 000000F2 6800000000          <2>  push %1
  1651                              <2>  %endif
  1652                              <2> 
  1653                              <2>  %rotate -1
  1654                              <2> 
  1655                              <2> 
  1656                              <2> 
  1657                              <2> 
  1658                              <2> 
  1659                              <2> 
  1660                              <2> 
  1661                              <2>  %ifidni %1, cs
  1662                              <2>  o16 push %1
  1663                              <2>  %elifidni %1, ds
  1664                              <2>  o16 push %1
  1665                              <2>  %elifidni %1, es
  1666                              <2>  o16 push %1
  1667                              <2>  %elifidni %1, fs
  1668                              <2>  o16 push %1
  1669                              <2>  %elifidni %1, gs
  1670                              <2>  o16 push %1
  1671                              <2>  %elifidni %1, word cs
  1672                              <2>  o16 push %1
  1673                              <2>  %elifidni %1, word ds
  1674                              <2>  o16 push %1
  1675                              <2>  %elifidni %1, word es
  1676                              <2>  o16 push %1
  1677                              <2>  %elifidni %1, word fs
  1678                              <2>  o16 push %1
  1679                              <2>  %elifidni %1, word gs
  1680                              <2>  o16 push %1
  1681                              <2>  %else
  1682 000000F7 FF35[1E000000]      <2>  push %1
  1683                              <2>  %endif
  1684                              <2> 
  1685                              <2>  %rotate -1
  1686                              <2> 
  1687                              <2> 
  1688                              <2> 
  1689                              <2> 
  1690                              <2> 
  1691                              <2> 
  1692                              <2> 
  1693                              <2>  %ifidni %1, cs
  1694                              <2>  o16 push %1
  1695                              <2>  %elifidni %1, ds
  1696                              <2>  o16 push %1
  1697                              <2>  %elifidni %1, es
  1698                              <2>  o16 push %1
  1699                              <2>  %elifidni %1, fs
  1700                              <2>  o16 push %1
  1701                              <2>  %elifidni %1, gs
  1702                              <2>  o16 push %1
  1703                              <2>  %elifidni %1, word cs
  1704                              <2>  o16 push %1
  1705                              <2>  %elifidni %1, word ds
  1706                              <2>  o16 push %1
  1707                              <2>  %elifidni %1, word es
  1708                              <2>  o16 push %1
  1709                              <2>  %elifidni %1, word fs
  1710                              <2>  o16 push %1
  1711                              <2>  %elifidni %1, word gs
  1712                              <2>  o16 push %1
  1713                              <2>  %else
  1714 000000FD 68[09000000]        <2>  push %1
  1715                              <2>  %endif
  1716                              <2> 
  1717                              <2>  %rotate -1
  1718 00000102 E8(00000000)        <1> call %1
  1719                              <1> %if (%0!=1)
  1720 00000107 83C410              <1>  add esp, byte %1_arglen
  1721                              <1> %endif
  1722                                  	invoke	_LoadPNG, dword _TitleFN, dword [_TitleOff], dword 0, dword 0 
  1723                              <1> %rotate -1
  1724                              <1> 
  1725                              <1> %rep (%0-1)
  1726                              <1> 
  1727                              <1> 
  1728                              <1> 
  1729                              <1> 
  1730                              <1> 
  1731                              <1> 
  1732                              <1> 
  1733                              <1>  %ifidni %1, cs
  1734                              <1>  o16 push %1
  1735                              <1>  %elifidni %1, ds
  1736                              <1>  o16 push %1
  1737                              <1>  %elifidni %1, es
  1738                              <1>  o16 push %1
  1739                              <1>  %elifidni %1, fs
  1740                              <1>  o16 push %1
  1741                              <1>  %elifidni %1, gs
  1742                              <1>  o16 push %1
  1743                              <1>  %elifidni %1, word cs
  1744                              <1>  o16 push %1
  1745                              <1>  %elifidni %1, word ds
  1746                              <1>  o16 push %1
  1747                              <1>  %elifidni %1, word es
  1748                              <1>  o16 push %1
  1749                              <1>  %elifidni %1, word fs
  1750                              <1>  o16 push %1
  1751                              <1>  %elifidni %1, word gs
  1752                              <1>  o16 push %1
  1753                              <1>  %else
  1754                              <1>  push %1
  1755                              <1>  %endif
  1756                              <1> 
  1757                              <1>  %rotate -1
  1758                              <1> %endrep
  1759                              <2> 
  1760                              <2> 
  1761                              <2> 
  1762                              <2> 
  1763                              <2> 
  1764                              <2> 
  1765                              <2> 
  1766                              <2>  %ifidni %1, cs
  1767                              <2>  o16 push %1
  1768                              <2>  %elifidni %1, ds
  1769                              <2>  o16 push %1
  1770                              <2>  %elifidni %1, es
  1771                              <2>  o16 push %1
  1772                              <2>  %elifidni %1, fs
  1773                              <2>  o16 push %1
  1774                              <2>  %elifidni %1, gs
  1775                              <2>  o16 push %1
  1776                              <2>  %elifidni %1, word cs
  1777                              <2>  o16 push %1
  1778                              <2>  %elifidni %1, word ds
  1779                              <2>  o16 push %1
  1780                              <2>  %elifidni %1, word es
  1781                              <2>  o16 push %1
  1782                              <2>  %elifidni %1, word fs
  1783                              <2>  o16 push %1
  1784                              <2>  %elifidni %1, word gs
  1785                              <2>  o16 push %1
  1786                              <2>  %else
  1787 0000010A 6800000000          <2>  push %1
  1788                              <2>  %endif
  1789                              <2> 
  1790                              <2>  %rotate -1
  1791                              <2> 
  1792                              <2> 
  1793                              <2> 
  1794                              <2> 
  1795                              <2> 
  1796                              <2> 
  1797                              <2> 
  1798                              <2>  %ifidni %1, cs
  1799                              <2>  o16 push %1
  1800                              <2>  %elifidni %1, ds
  1801                              <2>  o16 push %1
  1802                              <2>  %elifidni %1, es
  1803                              <2>  o16 push %1
  1804                              <2>  %elifidni %1, fs
  1805                              <2>  o16 push %1
  1806                              <2>  %elifidni %1, gs
  1807                              <2>  o16 push %1
  1808                              <2>  %elifidni %1, word cs
  1809                              <2>  o16 push %1
  1810                              <2>  %elifidni %1, word ds
  1811                              <2>  o16 push %1
  1812                              <2>  %elifidni %1, word es
  1813                              <2>  o16 push %1
  1814                              <2>  %elifidni %1, word fs
  1815                              <2>  o16 push %1
  1816                              <2>  %elifidni %1, word gs
  1817                              <2>  o16 push %1
  1818                              <2>  %else
  1819 0000010F 6800000000          <2>  push %1
  1820                              <2>  %endif
  1821                              <2> 
  1822                              <2>  %rotate -1
  1823                              <2> 
  1824                              <2> 
  1825                              <2> 
  1826                              <2> 
  1827                              <2> 
  1828                              <2> 
  1829                              <2> 
  1830                              <2>  %ifidni %1, cs
  1831                              <2>  o16 push %1
  1832                              <2>  %elifidni %1, ds
  1833                              <2>  o16 push %1
  1834                              <2>  %elifidni %1, es
  1835                              <2>  o16 push %1
  1836                              <2>  %elifidni %1, fs
  1837                              <2>  o16 push %1
  1838                              <2>  %elifidni %1, gs
  1839                              <2>  o16 push %1
  1840                              <2>  %elifidni %1, word cs
  1841                              <2>  o16 push %1
  1842                              <2>  %elifidni %1, word ds
  1843                              <2>  o16 push %1
  1844                              <2>  %elifidni %1, word es
  1845                              <2>  o16 push %1
  1846                              <2>  %elifidni %1, word fs
  1847                              <2>  o16 push %1
  1848                              <2>  %elifidni %1, word gs
  1849                              <2>  o16 push %1
  1850                              <2>  %else
  1851 00000114 FF35[22000000]      <2>  push %1
  1852                              <2>  %endif
  1853                              <2> 
  1854                              <2>  %rotate -1
  1855                              <2> 
  1856                              <2> 
  1857                              <2> 
  1858                              <2> 
  1859                              <2> 
  1860                              <2> 
  1861                              <2> 
  1862                              <2>  %ifidni %1, cs
  1863                              <2>  o16 push %1
  1864                              <2>  %elifidni %1, ds
  1865                              <2>  o16 push %1
  1866                              <2>  %elifidni %1, es
  1867                              <2>  o16 push %1
  1868                              <2>  %elifidni %1, fs
  1869                              <2>  o16 push %1
  1870                              <2>  %elifidni %1, gs
  1871                              <2>  o16 push %1
  1872                              <2>  %elifidni %1, word cs
  1873                              <2>  o16 push %1
  1874                              <2>  %elifidni %1, word ds
  1875                              <2>  o16 push %1
  1876                              <2>  %elifidni %1, word es
  1877                              <2>  o16 push %1
  1878                              <2>  %elifidni %1, word fs
  1879                              <2>  o16 push %1
  1880                              <2>  %elifidni %1, word gs
  1881                              <2>  o16 push %1
  1882                              <2>  %else
  1883 0000011A 68[12000000]        <2>  push %1
  1884                              <2>  %endif
  1885                              <2> 
  1886                              <2>  %rotate -1
  1887 0000011F E8(00000000)        <1> call %1
  1888                              <1> %if (%0!=1)
  1889 00000124 83C410              <1>  add esp, byte %1_arglen
  1890                              <1> %endif
  1891                                   
  1892                                  	; Graphics init
  1893                                  	invoke	_InitGraphics, dword _kbINT, dword _kbIRQ, dword _kbPort
  1894                              <1> %rotate -1
  1895                              <1> 
  1896                              <1> %rep (%0-1)
  1897                              <1> 
  1898                              <1> 
  1899                              <1> 
  1900                              <1> 
  1901                              <1> 
  1902                              <1> 
  1903                              <1> 
  1904                              <1>  %ifidni %1, cs
  1905                              <1>  o16 push %1
  1906                              <1>  %elifidni %1, ds
  1907                              <1>  o16 push %1
  1908                              <1>  %elifidni %1, es
  1909                              <1>  o16 push %1
  1910                              <1>  %elifidni %1, fs
  1911                              <1>  o16 push %1
  1912                              <1>  %elifidni %1, gs
  1913                              <1>  o16 push %1
  1914                              <1>  %elifidni %1, word cs
  1915                              <1>  o16 push %1
  1916                              <1>  %elifidni %1, word ds
  1917                              <1>  o16 push %1
  1918                              <1>  %elifidni %1, word es
  1919                              <1>  o16 push %1
  1920                              <1>  %elifidni %1, word fs
  1921                              <1>  o16 push %1
  1922                              <1>  %elifidni %1, word gs
  1923                              <1>  o16 push %1
  1924                              <1>  %else
  1925                              <1>  push %1
  1926                              <1>  %endif
  1927                              <1> 
  1928                              <1>  %rotate -1
  1929                              <1> %endrep
  1930                              <2> 
  1931                              <2> 
  1932                              <2> 
  1933                              <2> 
  1934                              <2> 
  1935                              <2> 
  1936                              <2> 
  1937                              <2>  %ifidni %1, cs
  1938                              <2>  o16 push %1
  1939                              <2>  %elifidni %1, ds
  1940                              <2>  o16 push %1
  1941                              <2>  %elifidni %1, es
  1942                              <2>  o16 push %1
  1943                              <2>  %elifidni %1, fs
  1944                              <2>  o16 push %1
  1945                              <2>  %elifidni %1, gs
  1946                              <2>  o16 push %1
  1947                              <2>  %elifidni %1, word cs
  1948                              <2>  o16 push %1
  1949                              <2>  %elifidni %1, word ds
  1950                              <2>  o16 push %1
  1951                              <2>  %elifidni %1, word es
  1952                              <2>  o16 push %1
  1953                              <2>  %elifidni %1, word fs
  1954                              <2>  o16 push %1
  1955                              <2>  %elifidni %1, word gs
  1956                              <2>  o16 push %1
  1957                              <2>  %else
  1958 00000127 68[04000000]        <2>  push %1
  1959                              <2>  %endif
  1960                              <2> 
  1961                              <2>  %rotate -1
  1962                              <2> 
  1963                              <2> 
  1964                              <2> 
  1965                              <2> 
  1966                              <2> 
  1967                              <2> 
  1968                              <2> 
  1969                              <2>  %ifidni %1, cs
  1970                              <2>  o16 push %1
  1971                              <2>  %elifidni %1, ds
  1972                              <2>  o16 push %1
  1973                              <2>  %elifidni %1, es
  1974                              <2>  o16 push %1
  1975                              <2>  %elifidni %1, fs
  1976                              <2>  o16 push %1
  1977                              <2>  %elifidni %1, gs
  1978                              <2>  o16 push %1
  1979                              <2>  %elifidni %1, word cs
  1980                              <2>  o16 push %1
  1981                              <2>  %elifidni %1, word ds
  1982                              <2>  o16 push %1
  1983                              <2>  %elifidni %1, word es
  1984                              <2>  o16 push %1
  1985                              <2>  %elifidni %1, word fs
  1986                              <2>  o16 push %1
  1987                              <2>  %elifidni %1, word gs
  1988                              <2>  o16 push %1
  1989                              <2>  %else
  1990 0000012C 68[03000000]        <2>  push %1
  1991                              <2>  %endif
  1992                              <2> 
  1993                              <2>  %rotate -1
  1994                              <2> 
  1995                              <2> 
  1996                              <2> 
  1997                              <2> 
  1998                              <2> 
  1999                              <2> 
  2000                              <2> 
  2001                              <2>  %ifidni %1, cs
  2002                              <2>  o16 push %1
  2003                              <2>  %elifidni %1, ds
  2004                              <2>  o16 push %1
  2005                              <2>  %elifidni %1, es
  2006                              <2>  o16 push %1
  2007                              <2>  %elifidni %1, fs
  2008                              <2>  o16 push %1
  2009                              <2>  %elifidni %1, gs
  2010                              <2>  o16 push %1
  2011                              <2>  %elifidni %1, word cs
  2012                              <2>  o16 push %1
  2013                              <2>  %elifidni %1, word ds
  2014                              <2>  o16 push %1
  2015                              <2>  %elifidni %1, word es
  2016                              <2>  o16 push %1
  2017                              <2>  %elifidni %1, word fs
  2018                              <2>  o16 push %1
  2019                              <2>  %elifidni %1, word gs
  2020                              <2>  o16 push %1
  2021                              <2>  %else
  2022 00000131 68[02000000]        <2>  push %1
  2023                              <2>  %endif
  2024                              <2> 
  2025                              <2>  %rotate -1
  2026 00000136 E8(00000000)        <1> call %1
  2027                              <1> %if (%0!=1)
  2028 0000013B 83C40C              <1>  add esp, byte %1_arglen
  2029                              <1> %endif
  2030 0000013E 85C0                    	test	eax, eax
  2031 00000140 0F856F000000            	jnz	near .graphicserror
  2032                                  
  2033                                  	; Find graphics mode: 640x480x32, allow driver-emulated modes
  2034                                  	invoke	_FindGraphicsMode, word 640, word 480, word 32, dword 1
  2035                              <1> %rotate -1
  2036                              <1> 
  2037                              <1> %rep (%0-1)
  2038                              <1> 
  2039                              <1> 
  2040                              <1> 
  2041                              <1> 
  2042                              <1> 
  2043                              <1> 
  2044                              <1> 
  2045                              <1>  %ifidni %1, cs
  2046                              <1>  o16 push %1
  2047                              <1>  %elifidni %1, ds
  2048                              <1>  o16 push %1
  2049                              <1>  %elifidni %1, es
  2050                              <1>  o16 push %1
  2051                              <1>  %elifidni %1, fs
  2052                              <1>  o16 push %1
  2053                              <1>  %elifidni %1, gs
  2054                              <1>  o16 push %1
  2055                              <1>  %elifidni %1, word cs
  2056                              <1>  o16 push %1
  2057                              <1>  %elifidni %1, word ds
  2058                              <1>  o16 push %1
  2059                              <1>  %elifidni %1, word es
  2060                              <1>  o16 push %1
  2061                              <1>  %elifidni %1, word fs
  2062                              <1>  o16 push %1
  2063                              <1>  %elifidni %1, word gs
  2064                              <1>  o16 push %1
  2065                              <1>  %else
  2066                              <1>  push %1
  2067                              <1>  %endif
  2068                              <1> 
  2069                              <1>  %rotate -1
  2070                              <1> %endrep
  2071                              <2> 
  2072                              <2> 
  2073                              <2> 
  2074                              <2> 
  2075                              <2> 
  2076                              <2> 
  2077                              <2> 
  2078                              <2>  %ifidni %1, cs
  2079                              <2>  o16 push %1
  2080                              <2>  %elifidni %1, ds
  2081                              <2>  o16 push %1
  2082                              <2>  %elifidni %1, es
  2083                              <2>  o16 push %1
  2084                              <2>  %elifidni %1, fs
  2085                              <2>  o16 push %1
  2086                              <2>  %elifidni %1, gs
  2087                              <2>  o16 push %1
  2088                              <2>  %elifidni %1, word cs
  2089                              <2>  o16 push %1
  2090                              <2>  %elifidni %1, word ds
  2091                              <2>  o16 push %1
  2092                              <2>  %elifidni %1, word es
  2093                              <2>  o16 push %1
  2094                              <2>  %elifidni %1, word fs
  2095                              <2>  o16 push %1
  2096                              <2>  %elifidni %1, word gs
  2097                              <2>  o16 push %1
  2098                              <2>  %else
  2099 00000146 6801000000          <2>  push %1
  2100                              <2>  %endif
  2101                              <2> 
  2102                              <2>  %rotate -1
  2103                              <2> 
  2104                              <2> 
  2105                              <2> 
  2106                              <2> 
  2107                              <2> 
  2108                              <2> 
  2109                              <2> 
  2110                              <2>  %ifidni %1, cs
  2111                              <2>  o16 push %1
  2112                              <2>  %elifidni %1, ds
  2113                              <2>  o16 push %1
  2114                              <2>  %elifidni %1, es
  2115                              <2>  o16 push %1
  2116                              <2>  %elifidni %1, fs
  2117                              <2>  o16 push %1
  2118                              <2>  %elifidni %1, gs
  2119                              <2>  o16 push %1
  2120                              <2>  %elifidni %1, word cs
  2121                              <2>  o16 push %1
  2122                              <2>  %elifidni %1, word ds
  2123                              <2>  o16 push %1
  2124                              <2>  %elifidni %1, word es
  2125                              <2>  o16 push %1
  2126                              <2>  %elifidni %1, word fs
  2127                              <2>  o16 push %1
  2128                              <2>  %elifidni %1, word gs
  2129                              <2>  o16 push %1
  2130                              <2>  %else
  2131 0000014B 66682000            <2>  push %1
  2132                              <2>  %endif
  2133                              <2> 
  2134                              <2>  %rotate -1
  2135                              <2> 
  2136                              <2> 
  2137                              <2> 
  2138                              <2> 
  2139                              <2> 
  2140                              <2> 
  2141                              <2> 
  2142                              <2>  %ifidni %1, cs
  2143                              <2>  o16 push %1
  2144                              <2>  %elifidni %1, ds
  2145                              <2>  o16 push %1
  2146                              <2>  %elifidni %1, es
  2147                              <2>  o16 push %1
  2148                              <2>  %elifidni %1, fs
  2149                              <2>  o16 push %1
  2150                              <2>  %elifidni %1, gs
  2151                              <2>  o16 push %1
  2152                              <2>  %elifidni %1, word cs
  2153                              <2>  o16 push %1
  2154                              <2>  %elifidni %1, word ds
  2155                              <2>  o16 push %1
  2156                              <2>  %elifidni %1, word es
  2157                              <2>  o16 push %1
  2158                              <2>  %elifidni %1, word fs
  2159                              <2>  o16 push %1
  2160                              <2>  %elifidni %1, word gs
  2161                              <2>  o16 push %1
  2162                              <2>  %else
  2163 0000014F 6668E001            <2>  push %1
  2164                              <2>  %endif
  2165                              <2> 
  2166                              <2>  %rotate -1
  2167                              <2> 
  2168                              <2> 
  2169                              <2> 
  2170                              <2> 
  2171                              <2> 
  2172                              <2> 
  2173                              <2> 
  2174                              <2>  %ifidni %1, cs
  2175                              <2>  o16 push %1
  2176                              <2>  %elifidni %1, ds
  2177                              <2>  o16 push %1
  2178                              <2>  %elifidni %1, es
  2179                              <2>  o16 push %1
  2180                              <2>  %elifidni %1, fs
  2181                              <2>  o16 push %1
  2182                              <2>  %elifidni %1, gs
  2183                              <2>  o16 push %1
  2184                              <2>  %elifidni %1, word cs
  2185                              <2>  o16 push %1
  2186                              <2>  %elifidni %1, word ds
  2187                              <2>  o16 push %1
  2188                              <2>  %elifidni %1, word es
  2189                              <2>  o16 push %1
  2190                              <2>  %elifidni %1, word fs
  2191                              <2>  o16 push %1
  2192                              <2>  %elifidni %1, word gs
  2193                              <2>  o16 push %1
  2194                              <2>  %else
  2195 00000153 66688002            <2>  push %1
  2196                              <2>  %endif
  2197                              <2> 
  2198                              <2>  %rotate -1
  2199 00000157 E8(00000000)        <1> call %1
  2200                              <1> %if (%0!=1)
  2201 0000015C 83C40A              <1>  add esp, byte %1_arglen
  2202                              <1> %endif
  2203 0000015F 66A3[00000000]          	mov	[_GraphicsMode], ax
  2204                                  
  2205                                  	; Keyboard/Mouse init
  2206 00000165 E8470B0000              	call	_InstallKeyboard
  2207 0000016A 85C0                    	test	eax, eax
  2208 0000016C 0F853E000000            	jnz	near .keyboarderror
  2209                                  	invoke	_SetGraphicsMode, word [_GraphicsMode]
  2210                              <1> %rotate -1
  2211                              <1> 
  2212                              <1> %rep (%0-1)
  2213                              <1> 
  2214                              <1> 
  2215                              <1> 
  2216                              <1> 
  2217                              <1> 
  2218                              <1> 
  2219                              <1> 
  2220                              <1>  %ifidni %1, cs
  2221                              <1>  o16 push %1
  2222                              <1>  %elifidni %1, ds
  2223                              <1>  o16 push %1
  2224                              <1>  %elifidni %1, es
  2225                              <1>  o16 push %1
  2226                              <1>  %elifidni %1, fs
  2227                              <1>  o16 push %1
  2228                              <1>  %elifidni %1, gs
  2229                              <1>  o16 push %1
  2230                              <1>  %elifidni %1, word cs
  2231                              <1>  o16 push %1
  2232                              <1>  %elifidni %1, word ds
  2233                              <1>  o16 push %1
  2234                              <1>  %elifidni %1, word es
  2235                              <1>  o16 push %1
  2236                              <1>  %elifidni %1, word fs
  2237                              <1>  o16 push %1
  2238                              <1>  %elifidni %1, word gs
  2239                              <1>  o16 push %1
  2240                              <1>  %else
  2241                              <1>  push %1
  2242                              <1>  %endif
  2243                              <1> 
  2244                              <1>  %rotate -1
  2245                              <1> %endrep
  2246                              <2> 
  2247                              <2> 
  2248                              <2> 
  2249                              <2> 
  2250                              <2> 
  2251                              <2> 
  2252                              <2> 
  2253                              <2>  %ifidni %1, cs
  2254                              <2>  o16 push %1
  2255                              <2>  %elifidni %1, ds
  2256                              <2>  o16 push %1
  2257                              <2>  %elifidni %1, es
  2258                              <2>  o16 push %1
  2259                              <2>  %elifidni %1, fs
  2260                              <2>  o16 push %1
  2261                              <2>  %elifidni %1, gs
  2262                              <2>  o16 push %1
  2263                              <2>  %elifidni %1, word cs
  2264                              <2>  o16 push %1
  2265                              <2>  %elifidni %1, word ds
  2266                              <2>  o16 push %1
  2267                              <2>  %elifidni %1, word es
  2268                              <2>  o16 push %1
  2269                              <2>  %elifidni %1, word fs
  2270                              <2>  o16 push %1
  2271                              <2>  %elifidni %1, word gs
  2272                              <2>  o16 push %1
  2273                              <2>  %else
  2274 00000172 66FF35[00000000]    <2>  push %1
  2275                              <2>  %endif
  2276                              <2> 
  2277                              <2>  %rotate -1
  2278 00000179 E8(00000000)        <1> call %1
  2279                              <1> %if (%0!=1)
  2280 0000017E 83C402              <1>  add esp, byte %1_arglen
  2281                              <1> %endif
  2282 00000181 85C0                    	test	eax, eax
  2283 00000183 7526                    	jnz	.setgraphicserror
  2284 00000185 E8800C0000              	call	_InstallMouse
  2285 0000018A 85C0                    	test	eax, eax
  2286 0000018C 7518                    	jnz	.mouseerror
  2287                                  
  2288                                  	; Show mouse cursor	
  2289 0000018E C705[00000000]0100-     	mov	dword [DPMI_EAX], 01h
  2290 00000196 0000               
  2291 00000198 66BB3300                	mov	bx, 33h
  2292 0000019C E8(00000000)            	call	DPMI_Int
  2293                                  
  2294 000001A1 E8(00000000)            	call	_MP4Main	
  2295                                  
  2296                                  	; Shutdown and cleanup	      
  2297                                  
  2298                                  .mouseerror
  2299 000001A6 E81B0D0000              	call	_RemoveMouse
  2300                                  
  2301                                  .setgraphicserror
  2302 000001AB E8(00000000)            	call	_UnsetGraphicsMode
  2303                                  
  2304                                  .keyboarderror
  2305 000001B0 E8710B0000              	call	_RemoveKeyboard
  2306                                  
  2307                                  .graphicserror
  2308 000001B5 E8(00000000)            	call	_ExitGraphics
  2309                                  
  2310                                  .memerror
  2311 000001BA E8(00000000)            	call	_MP4LibExit
  2312 000001BF E8(00000000)            	call	_LibExit
  2313                                  	ret
  2314                              <1> %ifnctx proc
  2315 000001C4 C3                  <1>  ret %1
  2316                              <1> %else
  2317                              <1>  mov esp, ebp
  2318                              <1>  pop ebp
  2319                              <1>  ret %1
  2320                              <1> %endif
  2321                                  
  2322                                  
  2323                                  ;--------------------------------------------------------------
  2324                                  ;--          Replace Library Calls with your Code!           --
  2325                                  ;--          Do not forget to add Function Headers           --
  2326                                  ;--------------------------------------------------------------
  2327                                  
  2328                                  
  2329                                  ;------------------------------------------------------------------------------------------------------------------
  2330                                  ;-- dword PointInBox(word X, word Y, word BoxULCornerX, word BoxULCornerY, word BoxLRCornerX, word BoxLRCornerY) --
  2331                                  ;------------------------------------------------------------------------------------------------------------------
  2332                                  ; Inputs : X - x coordinate of point in question
  2333                                  ;          Y - y coordinate of point in question
  2334                                  ;          BoxULCornerX - x coordinate of upper-left hand corner of box
  2335                                  ;          BoxULCornerY - y coordinate of upper-left hand corner of box
  2336                                  ;          BoxLRCornerX - x coordinate of lower-right hand corner of box
  2337                                  ;          BoxLRCornerY - y coordinate of lower-right hand corner of box
  2338                                  ; Outputs : -
  2339                                  ; Returns : 1 if BoxULCornerX <= X <= BoxLRCornerX and BoxULCornerY <= Y <= BoxLRCornerY; 0 otherwise
  2340                                  ; Calls : -
  2341                                  ; - determines if the point (X, Y) is located in the box formed by the points (BoxULCornerX, BoxULCornerY) and
  2342                                  ;   (BoxLRCornerX, BoxLRCornerY)
  2343                                  proc _PointInBox
  2344                              <1> %ifctx proc
  2345                              <1> %error Mismatched `endproc'/`proc'
  2346                              <1> %else
  2347                              <1> %push proc
  2348                              <1>  global %1
  2349 000001C5 55                  <1> %1: push ebp
  2350 000001C6 89E5                <1>  mov ebp, esp
  2351                              <1> %assign %$arg 8
  2352                              <1> %assign %$local 0
  2353                              <1> 
  2354                              <1> %define %$procname %1
  2355                              <1> %endif
  2356                                  .X		arg	2
  2357                              <1> .X equ %$arg
  2358                              <1> 
  2359                              <1> 
  2360                              <1> %assign %$arg %1+%$arg
  2361                                  .Y		arg	2
  2362                              <1> .Y equ %$arg
  2363                              <1> 
  2364                              <1> 
  2365                              <1> %assign %$arg %1+%$arg
  2366                                  .BoxULCornerX	arg	2
  2367                              <1> .BoxULCornerX equ %$arg
  2368                              <1> 
  2369                              <1> 
  2370                              <1> %assign %$arg %1+%$arg
  2371                                  .BoxULCornerY	arg	2
  2372                              <1> .BoxULCornerY equ %$arg
  2373                              <1> 
  2374                              <1> 
  2375                              <1> %assign %$arg %1+%$arg
  2376                                  .BoxLRCornerX	arg	2
  2377                              <1> .BoxLRCornerX equ %$arg
  2378                              <1> 
  2379                              <1> 
  2380                              <1> %assign %$arg %1+%$arg
  2381                                  .BoxLRCornerY	arg	2
  2382                              <1> .BoxLRCornerY equ %$arg
  2383                              <1> 
  2384                              <1> 
  2385                              <1> %assign %$arg %1+%$arg
  2386                                  
  2387                                  ;	invoke	_libPointInBox, word [ebp+.X], word [ebp+.Y], word [ebp+.BoxULCornerX], word [ebp+.BoxULCornerY], word [ebp+.BoxLRCornerX], word [ebp+.BoxLRCornerY]
  2388                                  
  2389 000001C8 668B4508                	mov	ax, [.X + ebp]			; check X if inside box
  2390 000001CC 663B450C                	cmp	ax, [.BoxULCornerX + ebp]	;
  2391 000001D0 7220                    	jb	.outsideOfBox			;
  2392 000001D2 663B4510                	cmp	ax, [.BoxLRCornerX + ebp]	;
  2393 000001D6 771A                    	ja	.outsideOfBox			;
  2394                                  
  2395 000001D8 668B450A                	mov	ax, [.Y + ebp]			; check Y if inside box
  2396 000001DC 663B450E                	cmp	ax, [.BoxULCornerY + ebp]	;
  2397 000001E0 7210                    	jb	.outsideOfBox			;
  2398 000001E2 663B4512                	cmp	ax, [.BoxLRCornerY + ebp]	;
  2399 000001E6 770A                    	ja	.outsideOfBox			;
  2400                                  
  2401 000001E8 B801000000              	mov	eax, 1
  2402 000001ED E905000000              	jmp	.done
  2403                                  
  2404                                  .outsideOfBox
  2405 000001F2 B800000000              	mov	eax, 0
  2406                                  
  2407                                  .done
  2408                                  	ret
  2409                              <1> %ifnctx proc
  2410                              <1>  ret %1
  2411                              <1> %else
  2412 000001F7 89EC                <1>  mov esp, ebp
  2413 000001F9 5D                  <1>  pop ebp
  2414 000001FA C3                  <1>  ret %1
  2415                              <1> %endif
  2416                                  
  2417                                  endproc
  2418                              <1> %ifnctx proc
  2419                              <1> %error Mismatched `endproc'/`proc'
  2420                              <1> %else
  2421                              <1> .STACK_FRAME_SIZE equ %$local
  2422                              <1> 
  2423                              <1> 
  2424                              <1> %ifdef LEGACY_ENDPROC
  2425                              <1>  ret
  2426                              <1> %endif
  2427                              <1> 
  2428                              <1> 
  2429                              <1> 
  2430                              <1> 
  2431                              <1> 
  2432                              <1> 
  2433                              <1> 
  2434                              <1> 
  2435                              <1> 
  2436                              <1> %pop
  2437                              <1> %endif
  2438                                  _PointInBox_arglen	EQU	12	   
  2439                                  
  2440                                  ;-------------------------------------------------------------------------------------
  2441                                  ;-- dword GetPixel(dword *DestOff, word DestWidth, word DestHeight, word X, word Y) --
  2442                                  ;-------------------------------------------------------------------------------------
  2443                                  ; Inputs : DestOff - offset of an image buffer in memory
  2444                                  ;          DestWidth - width of the buffer
  2445                                  ;          DestHeight - height of the buffer
  2446                                  ;          X - x coordinate of point
  2447                                  ;          Y - y coordinate of point
  2448                                  ; Outputs : -
  2449                                  ; Returns : color of the pixel located at (X, Y) in the buffer; otherwise 0 if the
  2450                                  ;           point (X, Y) is not within the boundary of the buffer
  2451                                  ; Calls : _PointInBox
  2452                                  ; - gets the color of the pixel located at the point (X, Y) in the buffer pointed by DestOff
  2453                                  proc _GetPixel
  2454                              <1> %ifctx proc
  2455                              <1> %error Mismatched `endproc'/`proc'
  2456                              <1> %else
  2457                              <1> %push proc
  2458                              <1>  global %1
  2459 000001FB 55                  <1> %1: push ebp
  2460 000001FC 89E5                <1>  mov ebp, esp
  2461                              <1> %assign %$arg 8
  2462                              <1> %assign %$local 0
  2463                              <1> 
  2464                              <1> %define %$procname %1
  2465                              <1> %endif
  2466                                  .DestOff	arg	4
  2467                              <1> .DestOff equ %$arg
  2468                              <1> 
  2469                              <1> 
  2470                              <1> %assign %$arg %1+%$arg
  2471                                  .DestWidth	arg	2
  2472                              <1> .DestWidth equ %$arg
  2473                              <1> 
  2474                              <1> 
  2475                              <1> %assign %$arg %1+%$arg
  2476                                  .DestHeight	arg	2
  2477                              <1> .DestHeight equ %$arg
  2478                              <1> 
  2479                              <1> 
  2480                              <1> %assign %$arg %1+%$arg
  2481                                  .X		arg	2
  2482                              <1> .X equ %$arg
  2483                              <1> 
  2484                              <1> 
  2485                              <1> %assign %$arg %1+%$arg
  2486                                  .Y		arg	2
  2487                              <1> .Y equ %$arg
  2488                              <1> 
  2489                              <1> 
  2490                              <1> %assign %$arg %1+%$arg
  2491                                  
  2492                                  ;	invoke	_libGetPixel, dword [ebp+.DestOff], word [ebp+.DestWidth], word [ebp+.DestHeight], word [ebp+.X], word [ebp+.Y]
  2493                                  
  2494                                  	invoke	_PointInBox, word [.X + ebp], word [.Y + ebp], word 0, word 0, word [.DestWidth + ebp], word [.DestHeight + ebp]
  2495                              <1> %rotate -1
  2496                              <1> 
  2497                              <1> %rep (%0-1)
  2498                              <1> 
  2499                              <1> 
  2500                              <1> 
  2501                              <1> 
  2502                              <1> 
  2503                              <1> 
  2504                              <1> 
  2505                              <1>  %ifidni %1, cs
  2506                              <1>  o16 push %1
  2507                              <1>  %elifidni %1, ds
  2508                              <1>  o16 push %1
  2509                              <1>  %elifidni %1, es
  2510                              <1>  o16 push %1
  2511                              <1>  %elifidni %1, fs
  2512                              <1>  o16 push %1
  2513                              <1>  %elifidni %1, gs
  2514                              <1>  o16 push %1
  2515                              <1>  %elifidni %1, word cs
  2516                              <1>  o16 push %1
  2517                              <1>  %elifidni %1, word ds
  2518                              <1>  o16 push %1
  2519                              <1>  %elifidni %1, word es
  2520                              <1>  o16 push %1
  2521                              <1>  %elifidni %1, word fs
  2522                              <1>  o16 push %1
  2523                              <1>  %elifidni %1, word gs
  2524                              <1>  o16 push %1
  2525                              <1>  %else
  2526                              <1>  push %1
  2527                              <1>  %endif
  2528                              <1> 
  2529                              <1>  %rotate -1
  2530                              <1> %endrep
  2531                              <2> 
  2532                              <2> 
  2533                              <2> 
  2534                              <2> 
  2535                              <2> 
  2536                              <2> 
  2537                              <2> 
  2538                              <2>  %ifidni %1, cs
  2539                              <2>  o16 push %1
  2540                              <2>  %elifidni %1, ds
  2541                              <2>  o16 push %1
  2542                              <2>  %elifidni %1, es
  2543                              <2>  o16 push %1
  2544                              <2>  %elifidni %1, fs
  2545                              <2>  o16 push %1
  2546                              <2>  %elifidni %1, gs
  2547                              <2>  o16 push %1
  2548                              <2>  %elifidni %1, word cs
  2549                              <2>  o16 push %1
  2550                              <2>  %elifidni %1, word ds
  2551                              <2>  o16 push %1
  2552                              <2>  %elifidni %1, word es
  2553                              <2>  o16 push %1
  2554                              <2>  %elifidni %1, word fs
  2555                              <2>  o16 push %1
  2556                              <2>  %elifidni %1, word gs
  2557                              <2>  o16 push %1
  2558                              <2>  %else
  2559 000001FE 66FF750E            <2>  push %1
  2560                              <2>  %endif
  2561                              <2> 
  2562                              <2>  %rotate -1
  2563                              <2> 
  2564                              <2> 
  2565                              <2> 
  2566                              <2> 
  2567                              <2> 
  2568                              <2> 
  2569                              <2> 
  2570                              <2>  %ifidni %1, cs
  2571                              <2>  o16 push %1
  2572                              <2>  %elifidni %1, ds
  2573                              <2>  o16 push %1
  2574                              <2>  %elifidni %1, es
  2575                              <2>  o16 push %1
  2576                              <2>  %elifidni %1, fs
  2577                              <2>  o16 push %1
  2578                              <2>  %elifidni %1, gs
  2579                              <2>  o16 push %1
  2580                              <2>  %elifidni %1, word cs
  2581                              <2>  o16 push %1
  2582                              <2>  %elifidni %1, word ds
  2583                              <2>  o16 push %1
  2584                              <2>  %elifidni %1, word es
  2585                              <2>  o16 push %1
  2586                              <2>  %elifidni %1, word fs
  2587                              <2>  o16 push %1
  2588                              <2>  %elifidni %1, word gs
  2589                              <2>  o16 push %1
  2590                              <2>  %else
  2591 00000202 66FF750C            <2>  push %1
  2592                              <2>  %endif
  2593                              <2> 
  2594                              <2>  %rotate -1
  2595                              <2> 
  2596                              <2> 
  2597                              <2> 
  2598                              <2> 
  2599                              <2> 
  2600                              <2> 
  2601                              <2> 
  2602                              <2>  %ifidni %1, cs
  2603                              <2>  o16 push %1
  2604                              <2>  %elifidni %1, ds
  2605                              <2>  o16 push %1
  2606                              <2>  %elifidni %1, es
  2607                              <2>  o16 push %1
  2608                              <2>  %elifidni %1, fs
  2609                              <2>  o16 push %1
  2610                              <2>  %elifidni %1, gs
  2611                              <2>  o16 push %1
  2612                              <2>  %elifidni %1, word cs
  2613                              <2>  o16 push %1
  2614                              <2>  %elifidni %1, word ds
  2615                              <2>  o16 push %1
  2616                              <2>  %elifidni %1, word es
  2617                              <2>  o16 push %1
  2618                              <2>  %elifidni %1, word fs
  2619                              <2>  o16 push %1
  2620                              <2>  %elifidni %1, word gs
  2621                              <2>  o16 push %1
  2622                              <2>  %else
  2623 00000206 66680000            <2>  push %1
  2624                              <2>  %endif
  2625                              <2> 
  2626                              <2>  %rotate -1
  2627                              <2> 
  2628                              <2> 
  2629                              <2> 
  2630                              <2> 
  2631                              <2> 
  2632                              <2> 
  2633                              <2> 
  2634                              <2>  %ifidni %1, cs
  2635                              <2>  o16 push %1
  2636                              <2>  %elifidni %1, ds
  2637                              <2>  o16 push %1
  2638                              <2>  %elifidni %1, es
  2639                              <2>  o16 push %1
  2640                              <2>  %elifidni %1, fs
  2641                              <2>  o16 push %1
  2642                              <2>  %elifidni %1, gs
  2643                              <2>  o16 push %1
  2644                              <2>  %elifidni %1, word cs
  2645                              <2>  o16 push %1
  2646                              <2>  %elifidni %1, word ds
  2647                              <2>  o16 push %1
  2648                              <2>  %elifidni %1, word es
  2649                              <2>  o16 push %1
  2650                              <2>  %elifidni %1, word fs
  2651                              <2>  o16 push %1
  2652                              <2>  %elifidni %1, word gs
  2653                              <2>  o16 push %1
  2654                              <2>  %else
  2655 0000020A 66680000            <2>  push %1
  2656                              <2>  %endif
  2657                              <2> 
  2658                              <2>  %rotate -1
  2659                              <2> 
  2660                              <2> 
  2661                              <2> 
  2662                              <2> 
  2663                              <2> 
  2664                              <2> 
  2665                              <2> 
  2666                              <2>  %ifidni %1, cs
  2667                              <2>  o16 push %1
  2668                              <2>  %elifidni %1, ds
  2669                              <2>  o16 push %1
  2670                              <2>  %elifidni %1, es
  2671                              <2>  o16 push %1
  2672                              <2>  %elifidni %1, fs
  2673                              <2>  o16 push %1
  2674                              <2>  %elifidni %1, gs
  2675                              <2>  o16 push %1
  2676                              <2>  %elifidni %1, word cs
  2677                              <2>  o16 push %1
  2678                              <2>  %elifidni %1, word ds
  2679                              <2>  o16 push %1
  2680                              <2>  %elifidni %1, word es
  2681                              <2>  o16 push %1
  2682                              <2>  %elifidni %1, word fs
  2683                              <2>  o16 push %1
  2684                              <2>  %elifidni %1, word gs
  2685                              <2>  o16 push %1
  2686                              <2>  %else
  2687 0000020E 66FF7512            <2>  push %1
  2688                              <2>  %endif
  2689                              <2> 
  2690                              <2>  %rotate -1
  2691                              <2> 
  2692                              <2> 
  2693                              <2> 
  2694                              <2> 
  2695                              <2> 
  2696                              <2> 
  2697                              <2> 
  2698                              <2>  %ifidni %1, cs
  2699                              <2>  o16 push %1
  2700                              <2>  %elifidni %1, ds
  2701                              <2>  o16 push %1
  2702                              <2>  %elifidni %1, es
  2703                              <2>  o16 push %1
  2704                              <2>  %elifidni %1, fs
  2705                              <2>  o16 push %1
  2706                              <2>  %elifidni %1, gs
  2707                              <2>  o16 push %1
  2708                              <2>  %elifidni %1, word cs
  2709                              <2>  o16 push %1
  2710                              <2>  %elifidni %1, word ds
  2711                              <2>  o16 push %1
  2712                              <2>  %elifidni %1, word es
  2713                              <2>  o16 push %1
  2714                              <2>  %elifidni %1, word fs
  2715                              <2>  o16 push %1
  2716                              <2>  %elifidni %1, word gs
  2717                              <2>  o16 push %1
  2718                              <2>  %else
  2719 00000212 66FF7510            <2>  push %1
  2720                              <2>  %endif
  2721                              <2> 
  2722                              <2>  %rotate -1
  2723 00000216 E8AAFFFFFF          <1> call %1
  2724                              <1> %if (%0!=1)
  2725 0000021B 83C40C              <1>  add esp, byte %1_arglen
  2726                              <1> %endif
  2727 0000021E 3D00000000              	cmp	eax, 0
  2728 00000223 7418                    	je	.outsideBoundary
  2729                                  
  2730 00000225 0FB7450C                	movzx	eax, word [.DestWidth + ebp]
  2731 00000229 0FB75D12                	movzx	ebx, word [.Y + ebp]
  2732 0000022D F7E3                    	mul	ebx				; (DestWidth * Y) + X
  2733 0000022F 0FB75D10                	movzx	ebx, word [.X + ebp]		;
  2734 00000233 01D8                    	add	eax, ebx
  2735 00000235 C1E002                  	shl	eax, 2				; each pixel 4 byte
  2736 00000238 034508                  	add	eax, [.DestOff + ebp]
  2737 0000023B 8B00                    	mov	eax, [eax]
  2738                                  
  2739                                  .outsideBoundary
  2740                                  	ret
  2741                              <1> %ifnctx proc
  2742                              <1>  ret %1
  2743                              <1> %else
  2744 0000023D 89EC                <1>  mov esp, ebp
  2745 0000023F 5D                  <1>  pop ebp
  2746 00000240 C3                  <1>  ret %1
  2747                              <1> %endif
  2748                                  
  2749                                  endproc
  2750                              <1> %ifnctx proc
  2751                              <1> %error Mismatched `endproc'/`proc'
  2752                              <1> %else
  2753                              <1> .STACK_FRAME_SIZE equ %$local
  2754                              <1> 
  2755                              <1> 
  2756                              <1> %ifdef LEGACY_ENDPROC
  2757                              <1>  ret
  2758                              <1> %endif
  2759                              <1> 
  2760                              <1> 
  2761                              <1> 
  2762                              <1> 
  2763                              <1> 
  2764                              <1> 
  2765                              <1> 
  2766                              <1> 
  2767                              <1> 
  2768                              <1> %pop
  2769                              <1> %endif
  2770                                  _GetPixel_arglen	EQU	12
  2771                                  
  2772                                  ;--------------------------------------------------------------------------------------------------
  2773                                  ;-- void DrawPixel(dword *DestOff, word DestWidth, word DestHeight, word X, word Y, dword Color) --
  2774                                  ;--------------------------------------------------------------------------------------------------
  2775                                  ; Inputs : DestOff - offset of an image buffer in memory
  2776                                  ;          DestWidth - width of the buffer
  2777                                  ;          DestHeight - height of the buffer
  2778                                  ;          X - x coordinate of point
  2779                                  ;          Y - y coordinate of point
  2780                                  ;          Color - color of pixel to draw
  2781                                  ; Outputs : pixel drawn to buffer
  2782                                  ; Returns : -
  2783                                  ; Calls : _PointInBox
  2784                                  ; - draws a pixel with color Color at point (X, Y) in the buffer pointed to by DestOff
  2785                                  proc _DrawPixel
  2786                              <1> %ifctx proc
  2787                              <1> %error Mismatched `endproc'/`proc'
  2788                              <1> %else
  2789                              <1> %push proc
  2790                              <1>  global %1
  2791 00000241 55                  <1> %1: push ebp
  2792 00000242 89E5                <1>  mov ebp, esp
  2793                              <1> %assign %$arg 8
  2794                              <1> %assign %$local 0
  2795                              <1> 
  2796                              <1> %define %$procname %1
  2797                              <1> %endif
  2798                                  .DestOff	arg	4
  2799                              <1> .DestOff equ %$arg
  2800                              <1> 
  2801                              <1> 
  2802                              <1> %assign %$arg %1+%$arg
  2803                                  .DestWidth	arg	2
  2804                              <1> .DestWidth equ %$arg
  2805                              <1> 
  2806                              <1> 
  2807                              <1> %assign %$arg %1+%$arg
  2808                                  .DestHeight	arg	2
  2809                              <1> .DestHeight equ %$arg
  2810                              <1> 
  2811                              <1> 
  2812                              <1> %assign %$arg %1+%$arg
  2813                                  .X		arg	2
  2814                              <1> .X equ %$arg
  2815                              <1> 
  2816                              <1> 
  2817                              <1> %assign %$arg %1+%$arg
  2818                                  .Y		arg	2
  2819                              <1> .Y equ %$arg
  2820                              <1> 
  2821                              <1> 
  2822                              <1> %assign %$arg %1+%$arg
  2823                                  .Color		arg	4
  2824                              <1> .Color equ %$arg
  2825                              <1> 
  2826                              <1> 
  2827                              <1> %assign %$arg %1+%$arg
  2828                                  
  2829                                  ;	invoke	_libDrawPixel, dword [ebp+.DestOff], word [ebp+.DestWidth], word [ebp+.DestHeight], word [ebp+.X], word [ebp+.Y], dword [ebp+.Color]
  2830                                  
  2831                                  	invoke	_PointInBox, word [.X + ebp], word [.Y + ebp], word 0, word 0, word [.DestWidth + ebp], word [.DestHeight + ebp]
  2832                              <1> %rotate -1
  2833                              <1> 
  2834                              <1> %rep (%0-1)
  2835                              <1> 
  2836                              <1> 
  2837                              <1> 
  2838                              <1> 
  2839                              <1> 
  2840                              <1> 
  2841                              <1> 
  2842                              <1>  %ifidni %1, cs
  2843                              <1>  o16 push %1
  2844                              <1>  %elifidni %1, ds
  2845                              <1>  o16 push %1
  2846                              <1>  %elifidni %1, es
  2847                              <1>  o16 push %1
  2848                              <1>  %elifidni %1, fs
  2849                              <1>  o16 push %1
  2850                              <1>  %elifidni %1, gs
  2851                              <1>  o16 push %1
  2852                              <1>  %elifidni %1, word cs
  2853                              <1>  o16 push %1
  2854                              <1>  %elifidni %1, word ds
  2855                              <1>  o16 push %1
  2856                              <1>  %elifidni %1, word es
  2857                              <1>  o16 push %1
  2858                              <1>  %elifidni %1, word fs
  2859                              <1>  o16 push %1
  2860                              <1>  %elifidni %1, word gs
  2861                              <1>  o16 push %1
  2862                              <1>  %else
  2863                              <1>  push %1
  2864                              <1>  %endif
  2865                              <1> 
  2866                              <1>  %rotate -1
  2867                              <1> %endrep
  2868                              <2> 
  2869                              <2> 
  2870                              <2> 
  2871                              <2> 
  2872                              <2> 
  2873                              <2> 
  2874                              <2> 
  2875                              <2>  %ifidni %1, cs
  2876                              <2>  o16 push %1
  2877                              <2>  %elifidni %1, ds
  2878                              <2>  o16 push %1
  2879                              <2>  %elifidni %1, es
  2880                              <2>  o16 push %1
  2881                              <2>  %elifidni %1, fs
  2882                              <2>  o16 push %1
  2883                              <2>  %elifidni %1, gs
  2884                              <2>  o16 push %1
  2885                              <2>  %elifidni %1, word cs
  2886                              <2>  o16 push %1
  2887                              <2>  %elifidni %1, word ds
  2888                              <2>  o16 push %1
  2889                              <2>  %elifidni %1, word es
  2890                              <2>  o16 push %1
  2891                              <2>  %elifidni %1, word fs
  2892                              <2>  o16 push %1
  2893                              <2>  %elifidni %1, word gs
  2894                              <2>  o16 push %1
  2895                              <2>  %else
  2896 00000244 66FF750E            <2>  push %1
  2897                              <2>  %endif
  2898                              <2> 
  2899                              <2>  %rotate -1
  2900                              <2> 
  2901                              <2> 
  2902                              <2> 
  2903                              <2> 
  2904                              <2> 
  2905                              <2> 
  2906                              <2> 
  2907                              <2>  %ifidni %1, cs
  2908                              <2>  o16 push %1
  2909                              <2>  %elifidni %1, ds
  2910                              <2>  o16 push %1
  2911                              <2>  %elifidni %1, es
  2912                              <2>  o16 push %1
  2913                              <2>  %elifidni %1, fs
  2914                              <2>  o16 push %1
  2915                              <2>  %elifidni %1, gs
  2916                              <2>  o16 push %1
  2917                              <2>  %elifidni %1, word cs
  2918                              <2>  o16 push %1
  2919                              <2>  %elifidni %1, word ds
  2920                              <2>  o16 push %1
  2921                              <2>  %elifidni %1, word es
  2922                              <2>  o16 push %1
  2923                              <2>  %elifidni %1, word fs
  2924                              <2>  o16 push %1
  2925                              <2>  %elifidni %1, word gs
  2926                              <2>  o16 push %1
  2927                              <2>  %else
  2928 00000248 66FF750C            <2>  push %1
  2929                              <2>  %endif
  2930                              <2> 
  2931                              <2>  %rotate -1
  2932                              <2> 
  2933                              <2> 
  2934                              <2> 
  2935                              <2> 
  2936                              <2> 
  2937                              <2> 
  2938                              <2> 
  2939                              <2>  %ifidni %1, cs
  2940                              <2>  o16 push %1
  2941                              <2>  %elifidni %1, ds
  2942                              <2>  o16 push %1
  2943                              <2>  %elifidni %1, es
  2944                              <2>  o16 push %1
  2945                              <2>  %elifidni %1, fs
  2946                              <2>  o16 push %1
  2947                              <2>  %elifidni %1, gs
  2948                              <2>  o16 push %1
  2949                              <2>  %elifidni %1, word cs
  2950                              <2>  o16 push %1
  2951                              <2>  %elifidni %1, word ds
  2952                              <2>  o16 push %1
  2953                              <2>  %elifidni %1, word es
  2954                              <2>  o16 push %1
  2955                              <2>  %elifidni %1, word fs
  2956                              <2>  o16 push %1
  2957                              <2>  %elifidni %1, word gs
  2958                              <2>  o16 push %1
  2959                              <2>  %else
  2960 0000024C 66680000            <2>  push %1
  2961                              <2>  %endif
  2962                              <2> 
  2963                              <2>  %rotate -1
  2964                              <2> 
  2965                              <2> 
  2966                              <2> 
  2967                              <2> 
  2968                              <2> 
  2969                              <2> 
  2970                              <2> 
  2971                              <2>  %ifidni %1, cs
  2972                              <2>  o16 push %1
  2973                              <2>  %elifidni %1, ds
  2974                              <2>  o16 push %1
  2975                              <2>  %elifidni %1, es
  2976                              <2>  o16 push %1
  2977                              <2>  %elifidni %1, fs
  2978                              <2>  o16 push %1
  2979                              <2>  %elifidni %1, gs
  2980                              <2>  o16 push %1
  2981                              <2>  %elifidni %1, word cs
  2982                              <2>  o16 push %1
  2983                              <2>  %elifidni %1, word ds
  2984                              <2>  o16 push %1
  2985                              <2>  %elifidni %1, word es
  2986                              <2>  o16 push %1
  2987                              <2>  %elifidni %1, word fs
  2988                              <2>  o16 push %1
  2989                              <2>  %elifidni %1, word gs
  2990                              <2>  o16 push %1
  2991                              <2>  %else
  2992 00000250 66680000            <2>  push %1
  2993                              <2>  %endif
  2994                              <2> 
  2995                              <2>  %rotate -1
  2996                              <2> 
  2997                              <2> 
  2998                              <2> 
  2999                              <2> 
  3000                              <2> 
  3001                              <2> 
  3002                              <2> 
  3003                              <2>  %ifidni %1, cs
  3004                              <2>  o16 push %1
  3005                              <2>  %elifidni %1, ds
  3006                              <2>  o16 push %1
  3007                              <2>  %elifidni %1, es
  3008                              <2>  o16 push %1
  3009                              <2>  %elifidni %1, fs
  3010                              <2>  o16 push %1
  3011                              <2>  %elifidni %1, gs
  3012                              <2>  o16 push %1
  3013                              <2>  %elifidni %1, word cs
  3014                              <2>  o16 push %1
  3015                              <2>  %elifidni %1, word ds
  3016                              <2>  o16 push %1
  3017                              <2>  %elifidni %1, word es
  3018                              <2>  o16 push %1
  3019                              <2>  %elifidni %1, word fs
  3020                              <2>  o16 push %1
  3021                              <2>  %elifidni %1, word gs
  3022                              <2>  o16 push %1
  3023                              <2>  %else
  3024 00000254 66FF7512            <2>  push %1
  3025                              <2>  %endif
  3026                              <2> 
  3027                              <2>  %rotate -1
  3028                              <2> 
  3029                              <2> 
  3030                              <2> 
  3031                              <2> 
  3032                              <2> 
  3033                              <2> 
  3034                              <2> 
  3035                              <2>  %ifidni %1, cs
  3036                              <2>  o16 push %1
  3037                              <2>  %elifidni %1, ds
  3038                              <2>  o16 push %1
  3039                              <2>  %elifidni %1, es
  3040                              <2>  o16 push %1
  3041                              <2>  %elifidni %1, fs
  3042                              <2>  o16 push %1
  3043                              <2>  %elifidni %1, gs
  3044                              <2>  o16 push %1
  3045                              <2>  %elifidni %1, word cs
  3046                              <2>  o16 push %1
  3047                              <2>  %elifidni %1, word ds
  3048                              <2>  o16 push %1
  3049                              <2>  %elifidni %1, word es
  3050                              <2>  o16 push %1
  3051                              <2>  %elifidni %1, word fs
  3052                              <2>  o16 push %1
  3053                              <2>  %elifidni %1, word gs
  3054                              <2>  o16 push %1
  3055                              <2>  %else
  3056 00000258 66FF7510            <2>  push %1
  3057                              <2>  %endif
  3058                              <2> 
  3059                              <2>  %rotate -1
  3060 0000025C E864FFFFFF          <1> call %1
  3061                              <1> %if (%0!=1)
  3062 00000261 83C40C              <1>  add esp, byte %1_arglen
  3063                              <1> %endif
  3064 00000264 85C0                    	test	eax, eax
  3065 00000266 741B                    	jz	.outsideBoundary
  3066                                  
  3067 00000268 0FB7450C                	movzx	eax, word [.DestWidth + ebp]
  3068 0000026C 0FB75D12                	movzx	ebx, word [.Y + ebp]
  3069 00000270 F7E3                    	mul	ebx				; (DestWidth * Y) + X
  3070 00000272 0FB75D10                	movzx	ebx, word [.X + ebp]		;
  3071 00000276 01D8                    	add	eax, ebx
  3072 00000278 C1E002                  	shl	eax, 2				; each pixel 4 byte
  3073 0000027B 034508                  	add	eax, [.DestOff + ebp]
  3074 0000027E 8B5D14                  	mov	ebx, [.Color + ebp]
  3075 00000281 8918                    	mov	[eax], ebx
  3076                                  
  3077                                  .outsideBoundary
  3078                                  	ret
  3079                              <1> %ifnctx proc
  3080                              <1>  ret %1
  3081                              <1> %else
  3082 00000283 89EC                <1>  mov esp, ebp
  3083 00000285 5D                  <1>  pop ebp
  3084 00000286 C3                  <1>  ret %1
  3085                              <1> %endif
  3086                                  
  3087                                  endproc
  3088                              <1> %ifnctx proc
  3089                              <1> %error Mismatched `endproc'/`proc'
  3090                              <1> %else
  3091                              <1> .STACK_FRAME_SIZE equ %$local
  3092                              <1> 
  3093                              <1> 
  3094                              <1> %ifdef LEGACY_ENDPROC
  3095                              <1>  ret
  3096                              <1> %endif
  3097                              <1> 
  3098                              <1> 
  3099                              <1> 
  3100                              <1> 
  3101                              <1> 
  3102                              <1> 
  3103                              <1> 
  3104                              <1> 
  3105                              <1> 
  3106                              <1> %pop
  3107                              <1> %endif
  3108                                  _DrawPixel_arglen	EQU	16
  3109                                  
  3110                                  ;---------------------------------------------------------------------------------------------------------------------
  3111                                  ;-- void DrawLine(dword *DestOff, word DestWidth, word DestHeight, word X1, word Y1, word X2, word Y2, dword Color) --
  3112                                  ;---------------------------------------------------------------------------------------------------------------------
  3113                                  ; Inputs : DestOff - offset of an image buffer in memory
  3114                                  ;          DestWidth - width of the buffer
  3115                                  ;          DestHeight - height of the buffer
  3116                                  ;          X1 - x coordinate of start point
  3117                                  ;          Y1 - y coordinate of start point
  3118                                  ;          X2 - x coordinate of end point
  3119                                  ;          Y2 - y coordinate of end point
  3120                                  ;          Color - color of line to draw
  3121                                  ; Outputs : line drawn to buffer
  3122                                  ; Returns : -
  3123                                  ; Calls : _DrawPixel
  3124                                  ; - draws a line with color Color from point (X1, Y1) to (X2, Y2) in the buffer pointed to by DestOff
  3125                                  proc _DrawLine
  3126                              <1> %ifctx proc
  3127                              <1> %error Mismatched `endproc'/`proc'
  3128                              <1> %else
  3129                              <1> %push proc
  3130                              <1>  global %1
  3131 00000287 55                  <1> %1: push ebp
  3132 00000288 89E5                <1>  mov ebp, esp
  3133                              <1> %assign %$arg 8
  3134                              <1> %assign %$local 0
  3135                              <1> 
  3136                              <1> %define %$procname %1
  3137                              <1> %endif
  3138                                  .DestOff	arg	4
  3139                              <1> .DestOff equ %$arg
  3140                              <1> 
  3141                              <1> 
  3142                              <1> %assign %$arg %1+%$arg
  3143                                  .DestWidth	arg	2
  3144                              <1> .DestWidth equ %$arg
  3145                              <1> 
  3146                              <1> 
  3147                              <1> %assign %$arg %1+%$arg
  3148                                  .DestHeight	arg	2
  3149                              <1> .DestHeight equ %$arg
  3150                              <1> 
  3151                              <1> 
  3152                              <1> %assign %$arg %1+%$arg
  3153                                  .X1		arg	2
  3154                              <1> .X1 equ %$arg
  3155                              <1> 
  3156                              <1> 
  3157                              <1> %assign %$arg %1+%$arg
  3158                                  .Y1		arg	2
  3159                              <1> .Y1 equ %$arg
  3160                              <1> 
  3161                              <1> 
  3162                              <1> %assign %$arg %1+%$arg
  3163                                  .X2		arg	2
  3164                              <1> .X2 equ %$arg
  3165                              <1> 
  3166                              <1> 
  3167                              <1> %assign %$arg %1+%$arg
  3168                                  .Y2		arg	2
  3169                              <1> .Y2 equ %$arg
  3170                              <1> 
  3171                              <1> 
  3172                              <1> %assign %$arg %1+%$arg
  3173                                  .Color		arg	4
  3174                              <1> .Color equ %$arg
  3175                              <1> 
  3176                              <1> 
  3177                              <1> %assign %$arg %1+%$arg
  3178                                  
  3179                                  ;	invoke	_libDrawLine, dword [ebp+.DestOff], word [ebp+.DestWidth], word [ebp+.DestHeight], word [ebp+.X1], word [ebp+.Y1], word [ebp+.X2], word [ebp+.Y2], dword [ebp+.Color]
  3180                                  
  3181 0000028A 668B4510                	mov	ax, [.X1 + ebp]		; abs(X2 - X1)
  3182 0000028E 668B5D14                	mov	bx, [.X2 + ebp]		;
  3183 00000292 6639D8                  	cmp	ax, bx			;
  3184 00000295 7C0E                    	jl	.X2Greater		;
  3185 00000297 6629D8                  	sub	ax, bx			;
  3186 0000029A 66A3[2C000000]          	mov	[_dx], ax		;
  3187 000002A0 E90A000000              	jmp	.calc_dy		;
  3188                                  					;
  3189                                  .X2Greater				;
  3190 000002A5 6629C3                  	sub	bx, ax			;
  3191 000002A8 66891D[2C000000]        	mov	[_dx], bx		;
  3192                                  
  3193                                  .calc_dy
  3194 000002AF 668B4512                	mov	ax, [.Y1 + ebp]		; abs(Y2 - Y1)
  3195 000002B3 668B5D16                	mov	bx, [.Y2 + ebp]		;
  3196 000002B7 6639D8                  	cmp	ax, bx			;
  3197 000002BA 7C0E                    	jl	.Y2Greater		;
  3198 000002BC 6629D8                  	sub	ax, bx			;
  3199 000002BF 66A3[2E000000]          	mov	[_dy], ax		;
  3200 000002C5 E90A000000              	jmp	.doneCalc_dx_dy		;
  3201                                  					;
  3202                                  .Y2Greater				;
  3203 000002CA 6629C3                  	sub	bx, ax			;
  3204 000002CD 66891D[2E000000]        	mov	[_dy], bx		;
  3205                                  
  3206                                  .doneCalc_dx_dy
  3207 000002D4 66A1[2C000000]          	mov	ax, [_dx]
  3208 000002DA 668B1D[2E000000]        	mov	bx, [_dy]
  3209 000002E1 6639D8                  	cmp	ax, bx
  3210 000002E4 7255                    	jb	._dxLessThan_dy
  3211 000002E6 0FB7C8                  	movzx	ecx, ax			;
  3212 000002E9 41                      	inc	ecx			; numpixels = ecx = dx + 1
  3213 000002EA 66D1E3                  	shl	bx, 1			;
  3214 000002ED 66891D[3C000000]        	mov	[_errornodiaginc], bx	; _errornodiaginc = 2 * dy
  3215 000002F4 6629C3                  	sub	bx, ax			;
  3216 000002F7 66891D[30000000]        	mov	[_lineerror], bx	; _lineerror = (2 * dy) - dx
  3217 000002FE 668B1D[2E000000]        	mov	bx, [_dy]
  3218 00000305 6629C3                  	sub	bx, ax			;
  3219 00000308 66D1E3                  	shl	bx, 1			;
  3220 0000030B 66891D[3A000000]        	mov	[_errordiaginc], bx	; _errordiaginc = 2 * (dy - dx)
  3221 00000312 66C705[32000000]01-     	mov	word [_xhorizinc], 1
  3222 0000031A 00                 
  3223 0000031B 66C705[34000000]01-     	mov	word [_xdiaginc], 1
  3224 00000323 00                 
  3225 00000324 66C705[36000000]00-     	mov	word [_yvertinc], 0
  3226 0000032C 00                 
  3227 0000032D 66C705[38000000]01-     	mov	word [_ydiaginc], 1
  3228 00000335 00                 
  3229 00000336 E94C000000              	jmp	.correctVars
  3230                                  
  3231                                  ._dxLessThan_dy
  3232 0000033B 0FB7CB                  	movzx	ecx, bx			;
  3233 0000033E 41                      	inc	ecx			; numpixels = ecx = dy + 1
  3234 0000033F 66D1E0                  	shl	ax, 1			;
  3235 00000342 66A3[3C000000]          	mov	[_errornodiaginc], ax	; _errornodiaginc = 2 * dx
  3236 00000348 6629D8                  	sub	ax, bx			;
  3237 0000034B 66A3[30000000]          	mov	[_lineerror], ax	; _lineerror = (2 * dx) - dy
  3238 00000351 66A1[2C000000]          	mov	ax, [_dx]
  3239 00000357 6629D8                  	sub	ax, bx			;
  3240 0000035A 66D1E0                  	shl	ax, 1			;
  3241 0000035D 66A3[3A000000]          	mov	[_errordiaginc], ax	; _errordiaginc = 2 * (dx - dy)
  3242 00000363 66C705[32000000]00-     	mov	word [_xhorizinc], 0
  3243 0000036B 00                 
  3244 0000036C 66C705[34000000]01-     	mov	word [_xdiaginc], 1
  3245 00000374 00                 
  3246 00000375 66C705[36000000]01-     	mov	word [_yvertinc], 1
  3247 0000037D 00                 
  3248 0000037E 66C705[38000000]01-     	mov	word [_ydiaginc], 1
  3249 00000386 00                 
  3250                                  
  3251                                  .correctVars
  3252 00000387 668B4510                	mov	ax, [.X1 + ebp]
  3253 0000038B 663B4514                	cmp	ax, [.X2 + ebp]
  3254 0000038F 7E0E                    	jle	.checkY
  3255 00000391 66F71D[32000000]        	neg	word [_xhorizinc]
  3256 00000398 66F71D[34000000]        	neg	word [_xdiaginc]
  3257                                  
  3258                                  .checkY
  3259 0000039F 668B4512                	mov	ax, [.Y1 + ebp]
  3260 000003A3 663B4516                	cmp	ax, [.Y2 + ebp]
  3261 000003A7 7E0E                    	jle	.draw
  3262 000003A9 66F71D[36000000]        	neg	word [_yvertinc]
  3263 000003B0 66F71D[38000000]        	neg	word [_ydiaginc]
  3264                                  
  3265                                  .draw
  3266 000003B7 668B4510                	mov	ax, [.X1 + ebp]
  3267 000003BB 668B5D12                	mov	bx, [.Y1 + ebp]
  3268 000003BF 668B15[30000000]        	mov	dx, [_lineerror]
  3269                                  
  3270                                  .loopDraw
  3271 000003C6 6650                    	push	ax
  3272 000003C8 6653                    	push	bx
  3273 000003CA 6652                    	push	dx
  3274                                  	invoke	_DrawPixel, dword [.DestOff + ebp], word [.DestWidth + ebp], word [.DestHeight + ebp], ax, bx, dword [.Color + ebp]
  3275                              <1> %rotate -1
  3276                              <1> 
  3277                              <1> %rep (%0-1)
  3278                              <1> 
  3279                              <1> 
  3280                              <1> 
  3281                              <1> 
  3282                              <1> 
  3283                              <1> 
  3284                              <1> 
  3285                              <1>  %ifidni %1, cs
  3286                              <1>  o16 push %1
  3287                              <1>  %elifidni %1, ds
  3288                              <1>  o16 push %1
  3289                              <1>  %elifidni %1, es
  3290                              <1>  o16 push %1
  3291                              <1>  %elifidni %1, fs
  3292                              <1>  o16 push %1
  3293                              <1>  %elifidni %1, gs
  3294                              <1>  o16 push %1
  3295                              <1>  %elifidni %1, word cs
  3296                              <1>  o16 push %1
  3297                              <1>  %elifidni %1, word ds
  3298                              <1>  o16 push %1
  3299                              <1>  %elifidni %1, word es
  3300                              <1>  o16 push %1
  3301                              <1>  %elifidni %1, word fs
  3302                              <1>  o16 push %1
  3303                              <1>  %elifidni %1, word gs
  3304                              <1>  o16 push %1
  3305                              <1>  %else
  3306                              <1>  push %1
  3307                              <1>  %endif
  3308                              <1> 
  3309                              <1>  %rotate -1
  3310                              <1> %endrep
  3311                              <2> 
  3312                              <2> 
  3313                              <2> 
  3314                              <2> 
  3315                              <2> 
  3316                              <2> 
  3317                              <2> 
  3318                              <2>  %ifidni %1, cs
  3319                              <2>  o16 push %1
  3320                              <2>  %elifidni %1, ds
  3321                              <2>  o16 push %1
  3322                              <2>  %elifidni %1, es
  3323                              <2>  o16 push %1
  3324                              <2>  %elifidni %1, fs
  3325                              <2>  o16 push %1
  3326                              <2>  %elifidni %1, gs
  3327                              <2>  o16 push %1
  3328                              <2>  %elifidni %1, word cs
  3329                              <2>  o16 push %1
  3330                              <2>  %elifidni %1, word ds
  3331                              <2>  o16 push %1
  3332                              <2>  %elifidni %1, word es
  3333                              <2>  o16 push %1
  3334                              <2>  %elifidni %1, word fs
  3335                              <2>  o16 push %1
  3336                              <2>  %elifidni %1, word gs
  3337                              <2>  o16 push %1
  3338                              <2>  %else
  3339 000003CC FF7518              <2>  push %1
  3340                              <2>  %endif
  3341                              <2> 
  3342                              <2>  %rotate -1
  3343                              <2> 
  3344                              <2> 
  3345                              <2> 
  3346                              <2> 
  3347                              <2> 
  3348                              <2> 
  3349                              <2> 
  3350                              <2>  %ifidni %1, cs
  3351                              <2>  o16 push %1
  3352                              <2>  %elifidni %1, ds
  3353                              <2>  o16 push %1
  3354                              <2>  %elifidni %1, es
  3355                              <2>  o16 push %1
  3356                              <2>  %elifidni %1, fs
  3357                              <2>  o16 push %1
  3358                              <2>  %elifidni %1, gs
  3359                              <2>  o16 push %1
  3360                              <2>  %elifidni %1, word cs
  3361                              <2>  o16 push %1
  3362                              <2>  %elifidni %1, word ds
  3363                              <2>  o16 push %1
  3364                              <2>  %elifidni %1, word es
  3365                              <2>  o16 push %1
  3366                              <2>  %elifidni %1, word fs
  3367                              <2>  o16 push %1
  3368                              <2>  %elifidni %1, word gs
  3369                              <2>  o16 push %1
  3370                              <2>  %else
  3371 000003CF 6653                <2>  push %1
  3372                              <2>  %endif
  3373                              <2> 
  3374                              <2>  %rotate -1
  3375                              <2> 
  3376                              <2> 
  3377                              <2> 
  3378                              <2> 
  3379                              <2> 
  3380                              <2> 
  3381                              <2> 
  3382                              <2>  %ifidni %1, cs
  3383                              <2>  o16 push %1
  3384                              <2>  %elifidni %1, ds
  3385                              <2>  o16 push %1
  3386                              <2>  %elifidni %1, es
  3387                              <2>  o16 push %1
  3388                              <2>  %elifidni %1, fs
  3389                              <2>  o16 push %1
  3390                              <2>  %elifidni %1, gs
  3391                              <2>  o16 push %1
  3392                              <2>  %elifidni %1, word cs
  3393                              <2>  o16 push %1
  3394                              <2>  %elifidni %1, word ds
  3395                              <2>  o16 push %1
  3396                              <2>  %elifidni %1, word es
  3397                              <2>  o16 push %1
  3398                              <2>  %elifidni %1, word fs
  3399                              <2>  o16 push %1
  3400                              <2>  %elifidni %1, word gs
  3401                              <2>  o16 push %1
  3402                              <2>  %else
  3403 000003D1 6650                <2>  push %1
  3404                              <2>  %endif
  3405                              <2> 
  3406                              <2>  %rotate -1
  3407                              <2> 
  3408                              <2> 
  3409                              <2> 
  3410                              <2> 
  3411                              <2> 
  3412                              <2> 
  3413                              <2> 
  3414                              <2>  %ifidni %1, cs
  3415                              <2>  o16 push %1
  3416                              <2>  %elifidni %1, ds
  3417                              <2>  o16 push %1
  3418                              <2>  %elifidni %1, es
  3419                              <2>  o16 push %1
  3420                              <2>  %elifidni %1, fs
  3421                              <2>  o16 push %1
  3422                              <2>  %elifidni %1, gs
  3423                              <2>  o16 push %1
  3424                              <2>  %elifidni %1, word cs
  3425                              <2>  o16 push %1
  3426                              <2>  %elifidni %1, word ds
  3427                              <2>  o16 push %1
  3428                              <2>  %elifidni %1, word es
  3429                              <2>  o16 push %1
  3430                              <2>  %elifidni %1, word fs
  3431                              <2>  o16 push %1
  3432                              <2>  %elifidni %1, word gs
  3433                              <2>  o16 push %1
  3434                              <2>  %else
  3435 000003D3 66FF750E            <2>  push %1
  3436                              <2>  %endif
  3437                              <2> 
  3438                              <2>  %rotate -1
  3439                              <2> 
  3440                              <2> 
  3441                              <2> 
  3442                              <2> 
  3443                              <2> 
  3444                              <2> 
  3445                              <2> 
  3446                              <2>  %ifidni %1, cs
  3447                              <2>  o16 push %1
  3448                              <2>  %elifidni %1, ds
  3449                              <2>  o16 push %1
  3450                              <2>  %elifidni %1, es
  3451                              <2>  o16 push %1
  3452                              <2>  %elifidni %1, fs
  3453                              <2>  o16 push %1
  3454                              <2>  %elifidni %1, gs
  3455                              <2>  o16 push %1
  3456                              <2>  %elifidni %1, word cs
  3457                              <2>  o16 push %1
  3458                              <2>  %elifidni %1, word ds
  3459                              <2>  o16 push %1
  3460                              <2>  %elifidni %1, word es
  3461                              <2>  o16 push %1
  3462                              <2>  %elifidni %1, word fs
  3463                              <2>  o16 push %1
  3464                              <2>  %elifidni %1, word gs
  3465                              <2>  o16 push %1
  3466                              <2>  %else
  3467 000003D7 66FF750C            <2>  push %1
  3468                              <2>  %endif
  3469                              <2> 
  3470                              <2>  %rotate -1
  3471                              <2> 
  3472                              <2> 
  3473                              <2> 
  3474                              <2> 
  3475                              <2> 
  3476                              <2> 
  3477                              <2> 
  3478                              <2>  %ifidni %1, cs
  3479                              <2>  o16 push %1
  3480                              <2>  %elifidni %1, ds
  3481                              <2>  o16 push %1
  3482                              <2>  %elifidni %1, es
  3483                              <2>  o16 push %1
  3484                              <2>  %elifidni %1, fs
  3485                              <2>  o16 push %1
  3486                              <2>  %elifidni %1, gs
  3487                              <2>  o16 push %1
  3488                              <2>  %elifidni %1, word cs
  3489                              <2>  o16 push %1
  3490                              <2>  %elifidni %1, word ds
  3491                              <2>  o16 push %1
  3492                              <2>  %elifidni %1, word es
  3493                              <2>  o16 push %1
  3494                              <2>  %elifidni %1, word fs
  3495                              <2>  o16 push %1
  3496                              <2>  %elifidni %1, word gs
  3497                              <2>  o16 push %1
  3498                              <2>  %else
  3499 000003DB FF7508              <2>  push %1
  3500                              <2>  %endif
  3501                              <2> 
  3502                              <2>  %rotate -1
  3503 000003DE E85EFEFFFF          <1> call %1
  3504                              <1> %if (%0!=1)
  3505 000003E3 83C410              <1>  add esp, byte %1_arglen
  3506                              <1> %endif
  3507 000003E6 665A                    	pop	dx
  3508 000003E8 665B                    	pop	bx
  3509 000003EA 6658                    	pop	ax
  3510 000003EC 6681FA0000              	cmp	dx, 0
  3511 000003F1 7D1A                    	jge	.lineerrorNotNegative
  3512 000003F3 660315[3C000000]        	add	dx, [_errornodiaginc]	; update _lineerror
  3513 000003FA 660305[32000000]        	add	ax, [_xhorizinc]	; update x
  3514 00000401 66031D[36000000]        	add	bx, [_yvertinc]		; update y
  3515 00000408 E915000000              	jmp	.done
  3516                                  
  3517                                  .lineerrorNotNegative
  3518 0000040D 660315[3A000000]        	add	dx, [_errordiaginc]	; update _lineerror
  3519 00000414 660305[34000000]        	add	ax, [_xdiaginc]		; update x
  3520 0000041B 66031D[38000000]        	add	bx, [_ydiaginc]		; update y
  3521                                  
  3522                                  .done
  3523 00000422 E2A2                    	loop	.loopDraw
  3524                                  	ret
  3525                              <1> %ifnctx proc
  3526                              <1>  ret %1
  3527                              <1> %else
  3528 00000424 89EC                <1>  mov esp, ebp
  3529 00000426 5D                  <1>  pop ebp
  3530 00000427 C3                  <1>  ret %1
  3531                              <1> %endif
  3532                                  
  3533                                  endproc
  3534                              <1> %ifnctx proc
  3535                              <1> %error Mismatched `endproc'/`proc'
  3536                              <1> %else
  3537                              <1> .STACK_FRAME_SIZE equ %$local
  3538                              <1> 
  3539                              <1> 
  3540                              <1> %ifdef LEGACY_ENDPROC
  3541                              <1>  ret
  3542                              <1> %endif
  3543                              <1> 
  3544                              <1> 
  3545                              <1> 
  3546                              <1> 
  3547                              <1> 
  3548                              <1> 
  3549                              <1> 
  3550                              <1> 
  3551                              <1> 
  3552                              <1> %pop
  3553                              <1> %endif
  3554                                  _DrawLine_arglen	EQU	20
  3555                                  	  
  3556                                  ;-----------------------------------------------------------------------------------------------------------------------------------------
  3557                                  ;-- void DrawRect(dword *DestOff, word DestWidth, word DestHeight, word X1, word Y1, word X2, word Y2, dword Color, dword FillRectFlag) --
  3558                                  ;-----------------------------------------------------------------------------------------------------------------------------------------
  3559                                  ; Inputs : DestOff - offset of an image buffer in memory
  3560                                  ;          DestWidth - width of the buffer
  3561                                  ;          DestHeight - height of the buffer
  3562                                  ;          X1 - x coordinate of start point
  3563                                  ;          Y1 - y coordinate of start point
  3564                                  ;          X2 - x coordinate of end point
  3565                                  ;          Y2 - y coordinate of end point
  3566                                  ;          Color - color of rectangle to draw
  3567                                  ;          FillRectFlag - flag to determine whether or not to fill the rectangle
  3568                                  ; Outputs : rectangle drawn to buffer, filled if necessary
  3569                                  ; Returns : -
  3570                                  ; Calls : _DrawLine, _FloodFill
  3571                                  ; - draws a rectangle with color Color from point (X1, Y1) to (X2, Y2) in the buffer pointed to by DestOff
  3572                                  proc _DrawRect
  3573                              <1> %ifctx proc
  3574                              <1> %error Mismatched `endproc'/`proc'
  3575                              <1> %else
  3576                              <1> %push proc
  3577                              <1>  global %1
  3578 00000428 55                  <1> %1: push ebp
  3579 00000429 89E5                <1>  mov ebp, esp
  3580                              <1> %assign %$arg 8
  3581                              <1> %assign %$local 0
  3582                              <1> 
  3583                              <1> %define %$procname %1
  3584                              <1> %endif
  3585                                  .DestOff	arg	4
  3586                              <1> .DestOff equ %$arg
  3587                              <1> 
  3588                              <1> 
  3589                              <1> %assign %$arg %1+%$arg
  3590                                  .DestWidth	arg	2
  3591                              <1> .DestWidth equ %$arg
  3592                              <1> 
  3593                              <1> 
  3594                              <1> %assign %$arg %1+%$arg
  3595                                  .DestHeight	arg	2
  3596                              <1> .DestHeight equ %$arg
  3597                              <1> 
  3598                              <1> 
  3599                              <1> %assign %$arg %1+%$arg
  3600                                  .X1		arg	2
  3601                              <1> .X1 equ %$arg
  3602                              <1> 
  3603                              <1> 
  3604                              <1> %assign %$arg %1+%$arg
  3605                                  .Y1		arg	2
  3606                              <1> .Y1 equ %$arg
  3607                              <1> 
  3608                              <1> 
  3609                              <1> %assign %$arg %1+%$arg
  3610                                  .X2		arg	2
  3611                              <1> .X2 equ %$arg
  3612                              <1> 
  3613                              <1> 
  3614                              <1> %assign %$arg %1+%$arg
  3615                                  .Y2		arg	2
  3616                              <1> .Y2 equ %$arg
  3617                              <1> 
  3618                              <1> 
  3619                              <1> %assign %$arg %1+%$arg
  3620                                  .Color		arg	4
  3621                              <1> .Color equ %$arg
  3622                              <1> 
  3623                              <1> 
  3624                              <1> %assign %$arg %1+%$arg
  3625                                  .FillRectFlag	arg	4
  3626                              <1> .FillRectFlag equ %$arg
  3627                              <1> 
  3628                              <1> 
  3629                              <1> %assign %$arg %1+%$arg
  3630                                  
  3631                                  ;	invoke	_libDrawRect, dword [ebp+.DestOff], word [ebp+.DestWidth], word [ebp+.DestHeight], word [ebp+.X1], word [ebp+.Y1], word [ebp+.X2], word [ebp+.Y2], dword [ebp+.Color], dword [ebp+.FillRectFlag]
  3632                                  
  3633                                  	invoke _DrawLine, dword [.DestOff + ebp], word [.DestWidth + ebp], word [.DestHeight + ebp], word [.X1 + ebp], word [.Y1 + ebp], word [.X2 + ebp], word [.Y1 + ebp], dword [.Color + ebp]
  3634                              <1> %rotate -1
  3635                              <1> 
  3636                              <1> %rep (%0-1)
  3637                              <1> 
  3638                              <1> 
  3639                              <1> 
  3640                              <1> 
  3641                              <1> 
  3642                              <1> 
  3643                              <1> 
  3644                              <1>  %ifidni %1, cs
  3645                              <1>  o16 push %1
  3646                              <1>  %elifidni %1, ds
  3647                              <1>  o16 push %1
  3648                              <1>  %elifidni %1, es
  3649                              <1>  o16 push %1
  3650                              <1>  %elifidni %1, fs
  3651                              <1>  o16 push %1
  3652                              <1>  %elifidni %1, gs
  3653                              <1>  o16 push %1
  3654                              <1>  %elifidni %1, word cs
  3655                              <1>  o16 push %1
  3656                              <1>  %elifidni %1, word ds
  3657                              <1>  o16 push %1
  3658                              <1>  %elifidni %1, word es
  3659                              <1>  o16 push %1
  3660                              <1>  %elifidni %1, word fs
  3661                              <1>  o16 push %1
  3662                              <1>  %elifidni %1, word gs
  3663                              <1>  o16 push %1
  3664                              <1>  %else
  3665                              <1>  push %1
  3666                              <1>  %endif
  3667                              <1> 
  3668                              <1>  %rotate -1
  3669                              <1> %endrep
  3670                              <2> 
  3671                              <2> 
  3672                              <2> 
  3673                              <2> 
  3674                              <2> 
  3675                              <2> 
  3676                              <2> 
  3677                              <2>  %ifidni %1, cs
  3678                              <2>  o16 push %1
  3679                              <2>  %elifidni %1, ds
  3680                              <2>  o16 push %1
  3681                              <2>  %elifidni %1, es
  3682                              <2>  o16 push %1
  3683                              <2>  %elifidni %1, fs
  3684                              <2>  o16 push %1
  3685                              <2>  %elifidni %1, gs
  3686                              <2>  o16 push %1
  3687                              <2>  %elifidni %1, word cs
  3688                              <2>  o16 push %1
  3689                              <2>  %elifidni %1, word ds
  3690                              <2>  o16 push %1
  3691                              <2>  %elifidni %1, word es
  3692                              <2>  o16 push %1
  3693                              <2>  %elifidni %1, word fs
  3694                              <2>  o16 push %1
  3695                              <2>  %elifidni %1, word gs
  3696                              <2>  o16 push %1
  3697                              <2>  %else
  3698 0000042B FF7518              <2>  push %1
  3699                              <2>  %endif
  3700                              <2> 
  3701                              <2>  %rotate -1
  3702                              <2> 
  3703                              <2> 
  3704                              <2> 
  3705                              <2> 
  3706                              <2> 
  3707                              <2> 
  3708                              <2> 
  3709                              <2>  %ifidni %1, cs
  3710                              <2>  o16 push %1
  3711                              <2>  %elifidni %1, ds
  3712                              <2>  o16 push %1
  3713                              <2>  %elifidni %1, es
  3714                              <2>  o16 push %1
  3715                              <2>  %elifidni %1, fs
  3716                              <2>  o16 push %1
  3717                              <2>  %elifidni %1, gs
  3718                              <2>  o16 push %1
  3719                              <2>  %elifidni %1, word cs
  3720                              <2>  o16 push %1
  3721                              <2>  %elifidni %1, word ds
  3722                              <2>  o16 push %1
  3723                              <2>  %elifidni %1, word es
  3724                              <2>  o16 push %1
  3725                              <2>  %elifidni %1, word fs
  3726                              <2>  o16 push %1
  3727                              <2>  %elifidni %1, word gs
  3728                              <2>  o16 push %1
  3729                              <2>  %else
  3730 0000042E 66FF7512            <2>  push %1
  3731                              <2>  %endif
  3732                              <2> 
  3733                              <2>  %rotate -1
  3734                              <2> 
  3735                              <2> 
  3736                              <2> 
  3737                              <2> 
  3738                              <2> 
  3739                              <2> 
  3740                              <2> 
  3741                              <2>  %ifidni %1, cs
  3742                              <2>  o16 push %1
  3743                              <2>  %elifidni %1, ds
  3744                              <2>  o16 push %1
  3745                              <2>  %elifidni %1, es
  3746                              <2>  o16 push %1
  3747                              <2>  %elifidni %1, fs
  3748                              <2>  o16 push %1
  3749                              <2>  %elifidni %1, gs
  3750                              <2>  o16 push %1
  3751                              <2>  %elifidni %1, word cs
  3752                              <2>  o16 push %1
  3753                              <2>  %elifidni %1, word ds
  3754                              <2>  o16 push %1
  3755                              <2>  %elifidni %1, word es
  3756                              <2>  o16 push %1
  3757                              <2>  %elifidni %1, word fs
  3758                              <2>  o16 push %1
  3759                              <2>  %elifidni %1, word gs
  3760                              <2>  o16 push %1
  3761                              <2>  %else
  3762 00000432 66FF7514            <2>  push %1
  3763                              <2>  %endif
  3764                              <2> 
  3765                              <2>  %rotate -1
  3766                              <2> 
  3767                              <2> 
  3768                              <2> 
  3769                              <2> 
  3770                              <2> 
  3771                              <2> 
  3772                              <2> 
  3773                              <2>  %ifidni %1, cs
  3774                              <2>  o16 push %1
  3775                              <2>  %elifidni %1, ds
  3776                              <2>  o16 push %1
  3777                              <2>  %elifidni %1, es
  3778                              <2>  o16 push %1
  3779                              <2>  %elifidni %1, fs
  3780                              <2>  o16 push %1
  3781                              <2>  %elifidni %1, gs
  3782                              <2>  o16 push %1
  3783                              <2>  %elifidni %1, word cs
  3784                              <2>  o16 push %1
  3785                              <2>  %elifidni %1, word ds
  3786                              <2>  o16 push %1
  3787                              <2>  %elifidni %1, word es
  3788                              <2>  o16 push %1
  3789                              <2>  %elifidni %1, word fs
  3790                              <2>  o16 push %1
  3791                              <2>  %elifidni %1, word gs
  3792                              <2>  o16 push %1
  3793                              <2>  %else
  3794 00000436 66FF7512            <2>  push %1
  3795                              <2>  %endif
  3796                              <2> 
  3797                              <2>  %rotate -1
  3798                              <2> 
  3799                              <2> 
  3800                              <2> 
  3801                              <2> 
  3802                              <2> 
  3803                              <2> 
  3804                              <2> 
  3805                              <2>  %ifidni %1, cs
  3806                              <2>  o16 push %1
  3807                              <2>  %elifidni %1, ds
  3808                              <2>  o16 push %1
  3809                              <2>  %elifidni %1, es
  3810                              <2>  o16 push %1
  3811                              <2>  %elifidni %1, fs
  3812                              <2>  o16 push %1
  3813                              <2>  %elifidni %1, gs
  3814                              <2>  o16 push %1
  3815                              <2>  %elifidni %1, word cs
  3816                              <2>  o16 push %1
  3817                              <2>  %elifidni %1, word ds
  3818                              <2>  o16 push %1
  3819                              <2>  %elifidni %1, word es
  3820                              <2>  o16 push %1
  3821                              <2>  %elifidni %1, word fs
  3822                              <2>  o16 push %1
  3823                              <2>  %elifidni %1, word gs
  3824                              <2>  o16 push %1
  3825                              <2>  %else
  3826 0000043A 66FF7510            <2>  push %1
  3827                              <2>  %endif
  3828                              <2> 
  3829                              <2>  %rotate -1
  3830                              <2> 
  3831                              <2> 
  3832                              <2> 
  3833                              <2> 
  3834                              <2> 
  3835                              <2> 
  3836                              <2> 
  3837                              <2>  %ifidni %1, cs
  3838                              <2>  o16 push %1
  3839                              <2>  %elifidni %1, ds
  3840                              <2>  o16 push %1
  3841                              <2>  %elifidni %1, es
  3842                              <2>  o16 push %1
  3843                              <2>  %elifidni %1, fs
  3844                              <2>  o16 push %1
  3845                              <2>  %elifidni %1, gs
  3846                              <2>  o16 push %1
  3847                              <2>  %elifidni %1, word cs
  3848                              <2>  o16 push %1
  3849                              <2>  %elifidni %1, word ds
  3850                              <2>  o16 push %1
  3851                              <2>  %elifidni %1, word es
  3852                              <2>  o16 push %1
  3853                              <2>  %elifidni %1, word fs
  3854                              <2>  o16 push %1
  3855                              <2>  %elifidni %1, word gs
  3856                              <2>  o16 push %1
  3857                              <2>  %else
  3858 0000043E 66FF750E            <2>  push %1
  3859                              <2>  %endif
  3860                              <2> 
  3861                              <2>  %rotate -1
  3862                              <2> 
  3863                              <2> 
  3864                              <2> 
  3865                              <2> 
  3866                              <2> 
  3867                              <2> 
  3868                              <2> 
  3869                              <2>  %ifidni %1, cs
  3870                              <2>  o16 push %1
  3871                              <2>  %elifidni %1, ds
  3872                              <2>  o16 push %1
  3873                              <2>  %elifidni %1, es
  3874                              <2>  o16 push %1
  3875                              <2>  %elifidni %1, fs
  3876                              <2>  o16 push %1
  3877                              <2>  %elifidni %1, gs
  3878                              <2>  o16 push %1
  3879                              <2>  %elifidni %1, word cs
  3880                              <2>  o16 push %1
  3881                              <2>  %elifidni %1, word ds
  3882                              <2>  o16 push %1
  3883                              <2>  %elifidni %1, word es
  3884                              <2>  o16 push %1
  3885                              <2>  %elifidni %1, word fs
  3886                              <2>  o16 push %1
  3887                              <2>  %elifidni %1, word gs
  3888                              <2>  o16 push %1
  3889                              <2>  %else
  3890 00000442 66FF750C            <2>  push %1
  3891                              <2>  %endif
  3892                              <2> 
  3893                              <2>  %rotate -1
  3894                              <2> 
  3895                              <2> 
  3896                              <2> 
  3897                              <2> 
  3898                              <2> 
  3899                              <2> 
  3900                              <2> 
  3901                              <2>  %ifidni %1, cs
  3902                              <2>  o16 push %1
  3903                              <2>  %elifidni %1, ds
  3904                              <2>  o16 push %1
  3905                              <2>  %elifidni %1, es
  3906                              <2>  o16 push %1
  3907                              <2>  %elifidni %1, fs
  3908                              <2>  o16 push %1
  3909                              <2>  %elifidni %1, gs
  3910                              <2>  o16 push %1
  3911                              <2>  %elifidni %1, word cs
  3912                              <2>  o16 push %1
  3913                              <2>  %elifidni %1, word ds
  3914                              <2>  o16 push %1
  3915                              <2>  %elifidni %1, word es
  3916                              <2>  o16 push %1
  3917                              <2>  %elifidni %1, word fs
  3918                              <2>  o16 push %1
  3919                              <2>  %elifidni %1, word gs
  3920                              <2>  o16 push %1
  3921                              <2>  %else
  3922 00000446 FF7508              <2>  push %1
  3923                              <2>  %endif
  3924                              <2> 
  3925                              <2>  %rotate -1
  3926 00000449 E839FEFFFF          <1> call %1
  3927                              <1> %if (%0!=1)
  3928 0000044E 83C414              <1>  add esp, byte %1_arglen
  3929                              <1> %endif
  3930                                  	invoke _DrawLine, dword [.DestOff + ebp], word [.DestWidth + ebp], word [.DestHeight + ebp], word [.X1 + ebp], word [.Y2 + ebp], word [.X2 + ebp], word [.Y2 + ebp], dword [.Color + ebp]
  3931                              <1> %rotate -1
  3932                              <1> 
  3933                              <1> %rep (%0-1)
  3934                              <1> 
  3935                              <1> 
  3936                              <1> 
  3937                              <1> 
  3938                              <1> 
  3939                              <1> 
  3940                              <1> 
  3941                              <1>  %ifidni %1, cs
  3942                              <1>  o16 push %1
  3943                              <1>  %elifidni %1, ds
  3944                              <1>  o16 push %1
  3945                              <1>  %elifidni %1, es
  3946                              <1>  o16 push %1
  3947                              <1>  %elifidni %1, fs
  3948                              <1>  o16 push %1
  3949                              <1>  %elifidni %1, gs
  3950                              <1>  o16 push %1
  3951                              <1>  %elifidni %1, word cs
  3952                              <1>  o16 push %1
  3953                              <1>  %elifidni %1, word ds
  3954                              <1>  o16 push %1
  3955                              <1>  %elifidni %1, word es
  3956                              <1>  o16 push %1
  3957                              <1>  %elifidni %1, word fs
  3958                              <1>  o16 push %1
  3959                              <1>  %elifidni %1, word gs
  3960                              <1>  o16 push %1
  3961                              <1>  %else
  3962                              <1>  push %1
  3963                              <1>  %endif
  3964                              <1> 
  3965                              <1>  %rotate -1
  3966                              <1> %endrep
  3967                              <2> 
  3968                              <2> 
  3969                              <2> 
  3970                              <2> 
  3971                              <2> 
  3972                              <2> 
  3973                              <2> 
  3974                              <2>  %ifidni %1, cs
  3975                              <2>  o16 push %1
  3976                              <2>  %elifidni %1, ds
  3977                              <2>  o16 push %1
  3978                              <2>  %elifidni %1, es
  3979                              <2>  o16 push %1
  3980                              <2>  %elifidni %1, fs
  3981                              <2>  o16 push %1
  3982                              <2>  %elifidni %1, gs
  3983                              <2>  o16 push %1
  3984                              <2>  %elifidni %1, word cs
  3985                              <2>  o16 push %1
  3986                              <2>  %elifidni %1, word ds
  3987                              <2>  o16 push %1
  3988                              <2>  %elifidni %1, word es
  3989                              <2>  o16 push %1
  3990                              <2>  %elifidni %1, word fs
  3991                              <2>  o16 push %1
  3992                              <2>  %elifidni %1, word gs
  3993                              <2>  o16 push %1
  3994                              <2>  %else
  3995 00000451 FF7518              <2>  push %1
  3996                              <2>  %endif
  3997                              <2> 
  3998                              <2>  %rotate -1
  3999                              <2> 
  4000                              <2> 
  4001                              <2> 
  4002                              <2> 
  4003                              <2> 
  4004                              <2> 
  4005                              <2> 
  4006                              <2>  %ifidni %1, cs
  4007                              <2>  o16 push %1
  4008                              <2>  %elifidni %1, ds
  4009                              <2>  o16 push %1
  4010                              <2>  %elifidni %1, es
  4011                              <2>  o16 push %1
  4012                              <2>  %elifidni %1, fs
  4013                              <2>  o16 push %1
  4014                              <2>  %elifidni %1, gs
  4015                              <2>  o16 push %1
  4016                              <2>  %elifidni %1, word cs
  4017                              <2>  o16 push %1
  4018                              <2>  %elifidni %1, word ds
  4019                              <2>  o16 push %1
  4020                              <2>  %elifidni %1, word es
  4021                              <2>  o16 push %1
  4022                              <2>  %elifidni %1, word fs
  4023                              <2>  o16 push %1
  4024                              <2>  %elifidni %1, word gs
  4025                              <2>  o16 push %1
  4026                              <2>  %else
  4027 00000454 66FF7516            <2>  push %1
  4028                              <2>  %endif
  4029                              <2> 
  4030                              <2>  %rotate -1
  4031                              <2> 
  4032                              <2> 
  4033                              <2> 
  4034                              <2> 
  4035                              <2> 
  4036                              <2> 
  4037                              <2> 
  4038                              <2>  %ifidni %1, cs
  4039                              <2>  o16 push %1
  4040                              <2>  %elifidni %1, ds
  4041                              <2>  o16 push %1
  4042                              <2>  %elifidni %1, es
  4043                              <2>  o16 push %1
  4044                              <2>  %elifidni %1, fs
  4045                              <2>  o16 push %1
  4046                              <2>  %elifidni %1, gs
  4047                              <2>  o16 push %1
  4048                              <2>  %elifidni %1, word cs
  4049                              <2>  o16 push %1
  4050                              <2>  %elifidni %1, word ds
  4051                              <2>  o16 push %1
  4052                              <2>  %elifidni %1, word es
  4053                              <2>  o16 push %1
  4054                              <2>  %elifidni %1, word fs
  4055                              <2>  o16 push %1
  4056                              <2>  %elifidni %1, word gs
  4057                              <2>  o16 push %1
  4058                              <2>  %else
  4059 00000458 66FF7514            <2>  push %1
  4060                              <2>  %endif
  4061                              <2> 
  4062                              <2>  %rotate -1
  4063                              <2> 
  4064                              <2> 
  4065                              <2> 
  4066                              <2> 
  4067                              <2> 
  4068                              <2> 
  4069                              <2> 
  4070                              <2>  %ifidni %1, cs
  4071                              <2>  o16 push %1
  4072                              <2>  %elifidni %1, ds
  4073                              <2>  o16 push %1
  4074                              <2>  %elifidni %1, es
  4075                              <2>  o16 push %1
  4076                              <2>  %elifidni %1, fs
  4077                              <2>  o16 push %1
  4078                              <2>  %elifidni %1, gs
  4079                              <2>  o16 push %1
  4080                              <2>  %elifidni %1, word cs
  4081                              <2>  o16 push %1
  4082                              <2>  %elifidni %1, word ds
  4083                              <2>  o16 push %1
  4084                              <2>  %elifidni %1, word es
  4085                              <2>  o16 push %1
  4086                              <2>  %elifidni %1, word fs
  4087                              <2>  o16 push %1
  4088                              <2>  %elifidni %1, word gs
  4089                              <2>  o16 push %1
  4090                              <2>  %else
  4091 0000045C 66FF7516            <2>  push %1
  4092                              <2>  %endif
  4093                              <2> 
  4094                              <2>  %rotate -1
  4095                              <2> 
  4096                              <2> 
  4097                              <2> 
  4098                              <2> 
  4099                              <2> 
  4100                              <2> 
  4101                              <2> 
  4102                              <2>  %ifidni %1, cs
  4103                              <2>  o16 push %1
  4104                              <2>  %elifidni %1, ds
  4105                              <2>  o16 push %1
  4106                              <2>  %elifidni %1, es
  4107                              <2>  o16 push %1
  4108                              <2>  %elifidni %1, fs
  4109                              <2>  o16 push %1
  4110                              <2>  %elifidni %1, gs
  4111                              <2>  o16 push %1
  4112                              <2>  %elifidni %1, word cs
  4113                              <2>  o16 push %1
  4114                              <2>  %elifidni %1, word ds
  4115                              <2>  o16 push %1
  4116                              <2>  %elifidni %1, word es
  4117                              <2>  o16 push %1
  4118                              <2>  %elifidni %1, word fs
  4119                              <2>  o16 push %1
  4120                              <2>  %elifidni %1, word gs
  4121                              <2>  o16 push %1
  4122                              <2>  %else
  4123 00000460 66FF7510            <2>  push %1
  4124                              <2>  %endif
  4125                              <2> 
  4126                              <2>  %rotate -1
  4127                              <2> 
  4128                              <2> 
  4129                              <2> 
  4130                              <2> 
  4131                              <2> 
  4132                              <2> 
  4133                              <2> 
  4134                              <2>  %ifidni %1, cs
  4135                              <2>  o16 push %1
  4136                              <2>  %elifidni %1, ds
  4137                              <2>  o16 push %1
  4138                              <2>  %elifidni %1, es
  4139                              <2>  o16 push %1
  4140                              <2>  %elifidni %1, fs
  4141                              <2>  o16 push %1
  4142                              <2>  %elifidni %1, gs
  4143                              <2>  o16 push %1
  4144                              <2>  %elifidni %1, word cs
  4145                              <2>  o16 push %1
  4146                              <2>  %elifidni %1, word ds
  4147                              <2>  o16 push %1
  4148                              <2>  %elifidni %1, word es
  4149                              <2>  o16 push %1
  4150                              <2>  %elifidni %1, word fs
  4151                              <2>  o16 push %1
  4152                              <2>  %elifidni %1, word gs
  4153                              <2>  o16 push %1
  4154                              <2>  %else
  4155 00000464 66FF750E            <2>  push %1
  4156                              <2>  %endif
  4157                              <2> 
  4158                              <2>  %rotate -1
  4159                              <2> 
  4160                              <2> 
  4161                              <2> 
  4162                              <2> 
  4163                              <2> 
  4164                              <2> 
  4165                              <2> 
  4166                              <2>  %ifidni %1, cs
  4167                              <2>  o16 push %1
  4168                              <2>  %elifidni %1, ds
  4169                              <2>  o16 push %1
  4170                              <2>  %elifidni %1, es
  4171                              <2>  o16 push %1
  4172                              <2>  %elifidni %1, fs
  4173                              <2>  o16 push %1
  4174                              <2>  %elifidni %1, gs
  4175                              <2>  o16 push %1
  4176                              <2>  %elifidni %1, word cs
  4177                              <2>  o16 push %1
  4178                              <2>  %elifidni %1, word ds
  4179                              <2>  o16 push %1
  4180                              <2>  %elifidni %1, word es
  4181                              <2>  o16 push %1
  4182                              <2>  %elifidni %1, word fs
  4183                              <2>  o16 push %1
  4184                              <2>  %elifidni %1, word gs
  4185                              <2>  o16 push %1
  4186                              <2>  %else
  4187 00000468 66FF750C            <2>  push %1
  4188                              <2>  %endif
  4189                              <2> 
  4190                              <2>  %rotate -1
  4191                              <2> 
  4192                              <2> 
  4193                              <2> 
  4194                              <2> 
  4195                              <2> 
  4196                              <2> 
  4197                              <2> 
  4198                              <2>  %ifidni %1, cs
  4199                              <2>  o16 push %1
  4200                              <2>  %elifidni %1, ds
  4201                              <2>  o16 push %1
  4202                              <2>  %elifidni %1, es
  4203                              <2>  o16 push %1
  4204                              <2>  %elifidni %1, fs
  4205                              <2>  o16 push %1
  4206                              <2>  %elifidni %1, gs
  4207                              <2>  o16 push %1
  4208                              <2>  %elifidni %1, word cs
  4209                              <2>  o16 push %1
  4210                              <2>  %elifidni %1, word ds
  4211                              <2>  o16 push %1
  4212                              <2>  %elifidni %1, word es
  4213                              <2>  o16 push %1
  4214                              <2>  %elifidni %1, word fs
  4215                              <2>  o16 push %1
  4216                              <2>  %elifidni %1, word gs
  4217                              <2>  o16 push %1
  4218                              <2>  %else
  4219 0000046C FF7508              <2>  push %1
  4220                              <2>  %endif
  4221                              <2> 
  4222                              <2>  %rotate -1
  4223 0000046F E813FEFFFF          <1> call %1
  4224                              <1> %if (%0!=1)
  4225 00000474 83C414              <1>  add esp, byte %1_arglen
  4226                              <1> %endif
  4227                                  	invoke _DrawLine, dword [.DestOff + ebp], word [.DestWidth + ebp], word [.DestHeight + ebp], word [.X1 + ebp], word [.Y1 + ebp], word [.X1 + ebp], word [.Y2 + ebp], dword [.Color + ebp]
  4228                              <1> %rotate -1
  4229                              <1> 
  4230                              <1> %rep (%0-1)
  4231                              <1> 
  4232                              <1> 
  4233                              <1> 
  4234                              <1> 
  4235                              <1> 
  4236                              <1> 
  4237                              <1> 
  4238                              <1>  %ifidni %1, cs
  4239                              <1>  o16 push %1
  4240                              <1>  %elifidni %1, ds
  4241                              <1>  o16 push %1
  4242                              <1>  %elifidni %1, es
  4243                              <1>  o16 push %1
  4244                              <1>  %elifidni %1, fs
  4245                              <1>  o16 push %1
  4246                              <1>  %elifidni %1, gs
  4247                              <1>  o16 push %1
  4248                              <1>  %elifidni %1, word cs
  4249                              <1>  o16 push %1
  4250                              <1>  %elifidni %1, word ds
  4251                              <1>  o16 push %1
  4252                              <1>  %elifidni %1, word es
  4253                              <1>  o16 push %1
  4254                              <1>  %elifidni %1, word fs
  4255                              <1>  o16 push %1
  4256                              <1>  %elifidni %1, word gs
  4257                              <1>  o16 push %1
  4258                              <1>  %else
  4259                              <1>  push %1
  4260                              <1>  %endif
  4261                              <1> 
  4262                              <1>  %rotate -1
  4263                              <1> %endrep
  4264                              <2> 
  4265                              <2> 
  4266                              <2> 
  4267                              <2> 
  4268                              <2> 
  4269                              <2> 
  4270                              <2> 
  4271                              <2>  %ifidni %1, cs
  4272                              <2>  o16 push %1
  4273                              <2>  %elifidni %1, ds
  4274                              <2>  o16 push %1
  4275                              <2>  %elifidni %1, es
  4276                              <2>  o16 push %1
  4277                              <2>  %elifidni %1, fs
  4278                              <2>  o16 push %1
  4279                              <2>  %elifidni %1, gs
  4280                              <2>  o16 push %1
  4281                              <2>  %elifidni %1, word cs
  4282                              <2>  o16 push %1
  4283                              <2>  %elifidni %1, word ds
  4284                              <2>  o16 push %1
  4285                              <2>  %elifidni %1, word es
  4286                              <2>  o16 push %1
  4287                              <2>  %elifidni %1, word fs
  4288                              <2>  o16 push %1
  4289                              <2>  %elifidni %1, word gs
  4290                              <2>  o16 push %1
  4291                              <2>  %else
  4292 00000477 FF7518              <2>  push %1
  4293                              <2>  %endif
  4294                              <2> 
  4295                              <2>  %rotate -1
  4296                              <2> 
  4297                              <2> 
  4298                              <2> 
  4299                              <2> 
  4300                              <2> 
  4301                              <2> 
  4302                              <2> 
  4303                              <2>  %ifidni %1, cs
  4304                              <2>  o16 push %1
  4305                              <2>  %elifidni %1, ds
  4306                              <2>  o16 push %1
  4307                              <2>  %elifidni %1, es
  4308                              <2>  o16 push %1
  4309                              <2>  %elifidni %1, fs
  4310                              <2>  o16 push %1
  4311                              <2>  %elifidni %1, gs
  4312                              <2>  o16 push %1
  4313                              <2>  %elifidni %1, word cs
  4314                              <2>  o16 push %1
  4315                              <2>  %elifidni %1, word ds
  4316                              <2>  o16 push %1
  4317                              <2>  %elifidni %1, word es
  4318                              <2>  o16 push %1
  4319                              <2>  %elifidni %1, word fs
  4320                              <2>  o16 push %1
  4321                              <2>  %elifidni %1, word gs
  4322                              <2>  o16 push %1
  4323                              <2>  %else
  4324 0000047A 66FF7516            <2>  push %1
  4325                              <2>  %endif
  4326                              <2> 
  4327                              <2>  %rotate -1
  4328                              <2> 
  4329                              <2> 
  4330                              <2> 
  4331                              <2> 
  4332                              <2> 
  4333                              <2> 
  4334                              <2> 
  4335                              <2>  %ifidni %1, cs
  4336                              <2>  o16 push %1
  4337                              <2>  %elifidni %1, ds
  4338                              <2>  o16 push %1
  4339                              <2>  %elifidni %1, es
  4340                              <2>  o16 push %1
  4341                              <2>  %elifidni %1, fs
  4342                              <2>  o16 push %1
  4343                              <2>  %elifidni %1, gs
  4344                              <2>  o16 push %1
  4345                              <2>  %elifidni %1, word cs
  4346                              <2>  o16 push %1
  4347                              <2>  %elifidni %1, word ds
  4348                              <2>  o16 push %1
  4349                              <2>  %elifidni %1, word es
  4350                              <2>  o16 push %1
  4351                              <2>  %elifidni %1, word fs
  4352                              <2>  o16 push %1
  4353                              <2>  %elifidni %1, word gs
  4354                              <2>  o16 push %1
  4355                              <2>  %else
  4356 0000047E 66FF7510            <2>  push %1
  4357                              <2>  %endif
  4358                              <2> 
  4359                              <2>  %rotate -1
  4360                              <2> 
  4361                              <2> 
  4362                              <2> 
  4363                              <2> 
  4364                              <2> 
  4365                              <2> 
  4366                              <2> 
  4367                              <2>  %ifidni %1, cs
  4368                              <2>  o16 push %1
  4369                              <2>  %elifidni %1, ds
  4370                              <2>  o16 push %1
  4371                              <2>  %elifidni %1, es
  4372                              <2>  o16 push %1
  4373                              <2>  %elifidni %1, fs
  4374                              <2>  o16 push %1
  4375                              <2>  %elifidni %1, gs
  4376                              <2>  o16 push %1
  4377                              <2>  %elifidni %1, word cs
  4378                              <2>  o16 push %1
  4379                              <2>  %elifidni %1, word ds
  4380                              <2>  o16 push %1
  4381                              <2>  %elifidni %1, word es
  4382                              <2>  o16 push %1
  4383                              <2>  %elifidni %1, word fs
  4384                              <2>  o16 push %1
  4385                              <2>  %elifidni %1, word gs
  4386                              <2>  o16 push %1
  4387                              <2>  %else
  4388 00000482 66FF7512            <2>  push %1
  4389                              <2>  %endif
  4390                              <2> 
  4391                              <2>  %rotate -1
  4392                              <2> 
  4393                              <2> 
  4394                              <2> 
  4395                              <2> 
  4396                              <2> 
  4397                              <2> 
  4398                              <2> 
  4399                              <2>  %ifidni %1, cs
  4400                              <2>  o16 push %1
  4401                              <2>  %elifidni %1, ds
  4402                              <2>  o16 push %1
  4403                              <2>  %elifidni %1, es
  4404                              <2>  o16 push %1
  4405                              <2>  %elifidni %1, fs
  4406                              <2>  o16 push %1
  4407                              <2>  %elifidni %1, gs
  4408                              <2>  o16 push %1
  4409                              <2>  %elifidni %1, word cs
  4410                              <2>  o16 push %1
  4411                              <2>  %elifidni %1, word ds
  4412                              <2>  o16 push %1
  4413                              <2>  %elifidni %1, word es
  4414                              <2>  o16 push %1
  4415                              <2>  %elifidni %1, word fs
  4416                              <2>  o16 push %1
  4417                              <2>  %elifidni %1, word gs
  4418                              <2>  o16 push %1
  4419                              <2>  %else
  4420 00000486 66FF7510            <2>  push %1
  4421                              <2>  %endif
  4422                              <2> 
  4423                              <2>  %rotate -1
  4424                              <2> 
  4425                              <2> 
  4426                              <2> 
  4427                              <2> 
  4428                              <2> 
  4429                              <2> 
  4430                              <2> 
  4431                              <2>  %ifidni %1, cs
  4432                              <2>  o16 push %1
  4433                              <2>  %elifidni %1, ds
  4434                              <2>  o16 push %1
  4435                              <2>  %elifidni %1, es
  4436                              <2>  o16 push %1
  4437                              <2>  %elifidni %1, fs
  4438                              <2>  o16 push %1
  4439                              <2>  %elifidni %1, gs
  4440                              <2>  o16 push %1
  4441                              <2>  %elifidni %1, word cs
  4442                              <2>  o16 push %1
  4443                              <2>  %elifidni %1, word ds
  4444                              <2>  o16 push %1
  4445                              <2>  %elifidni %1, word es
  4446                              <2>  o16 push %1
  4447                              <2>  %elifidni %1, word fs
  4448                              <2>  o16 push %1
  4449                              <2>  %elifidni %1, word gs
  4450                              <2>  o16 push %1
  4451                              <2>  %else
  4452 0000048A 66FF750E            <2>  push %1
  4453                              <2>  %endif
  4454                              <2> 
  4455                              <2>  %rotate -1
  4456                              <2> 
  4457                              <2> 
  4458                              <2> 
  4459                              <2> 
  4460                              <2> 
  4461                              <2> 
  4462                              <2> 
  4463                              <2>  %ifidni %1, cs
  4464                              <2>  o16 push %1
  4465                              <2>  %elifidni %1, ds
  4466                              <2>  o16 push %1
  4467                              <2>  %elifidni %1, es
  4468                              <2>  o16 push %1
  4469                              <2>  %elifidni %1, fs
  4470                              <2>  o16 push %1
  4471                              <2>  %elifidni %1, gs
  4472                              <2>  o16 push %1
  4473                              <2>  %elifidni %1, word cs
  4474                              <2>  o16 push %1
  4475                              <2>  %elifidni %1, word ds
  4476                              <2>  o16 push %1
  4477                              <2>  %elifidni %1, word es
  4478                              <2>  o16 push %1
  4479                              <2>  %elifidni %1, word fs
  4480                              <2>  o16 push %1
  4481                              <2>  %elifidni %1, word gs
  4482                              <2>  o16 push %1
  4483                              <2>  %else
  4484 0000048E 66FF750C            <2>  push %1
  4485                              <2>  %endif
  4486                              <2> 
  4487                              <2>  %rotate -1
  4488                              <2> 
  4489                              <2> 
  4490                              <2> 
  4491                              <2> 
  4492                              <2> 
  4493                              <2> 
  4494                              <2> 
  4495                              <2>  %ifidni %1, cs
  4496                              <2>  o16 push %1
  4497                              <2>  %elifidni %1, ds
  4498                              <2>  o16 push %1
  4499                              <2>  %elifidni %1, es
  4500                              <2>  o16 push %1
  4501                              <2>  %elifidni %1, fs
  4502                              <2>  o16 push %1
  4503                              <2>  %elifidni %1, gs
  4504                              <2>  o16 push %1
  4505                              <2>  %elifidni %1, word cs
  4506                              <2>  o16 push %1
  4507                              <2>  %elifidni %1, word ds
  4508                              <2>  o16 push %1
  4509                              <2>  %elifidni %1, word es
  4510                              <2>  o16 push %1
  4511                              <2>  %elifidni %1, word fs
  4512                              <2>  o16 push %1
  4513                              <2>  %elifidni %1, word gs
  4514                              <2>  o16 push %1
  4515                              <2>  %else
  4516 00000492 FF7508              <2>  push %1
  4517                              <2>  %endif
  4518                              <2> 
  4519                              <2>  %rotate -1
  4520 00000495 E8EDFDFFFF          <1> call %1
  4521                              <1> %if (%0!=1)
  4522 0000049A 83C414              <1>  add esp, byte %1_arglen
  4523                              <1> %endif
  4524                                  	invoke _DrawLine, dword [.DestOff + ebp], word [.DestWidth + ebp], word [.DestHeight + ebp], word [.X2 + ebp], word [.Y1 + ebp], word [.X2 + ebp], word [.Y2 + ebp], dword [.Color + ebp]
  4525                              <1> %rotate -1
  4526                              <1> 
  4527                              <1> %rep (%0-1)
  4528                              <1> 
  4529                              <1> 
  4530                              <1> 
  4531                              <1> 
  4532                              <1> 
  4533                              <1> 
  4534                              <1> 
  4535                              <1>  %ifidni %1, cs
  4536                              <1>  o16 push %1
  4537                              <1>  %elifidni %1, ds
  4538                              <1>  o16 push %1
  4539                              <1>  %elifidni %1, es
  4540                              <1>  o16 push %1
  4541                              <1>  %elifidni %1, fs
  4542                              <1>  o16 push %1
  4543                              <1>  %elifidni %1, gs
  4544                              <1>  o16 push %1
  4545                              <1>  %elifidni %1, word cs
  4546                              <1>  o16 push %1
  4547                              <1>  %elifidni %1, word ds
  4548                              <1>  o16 push %1
  4549                              <1>  %elifidni %1, word es
  4550                              <1>  o16 push %1
  4551                              <1>  %elifidni %1, word fs
  4552                              <1>  o16 push %1
  4553                              <1>  %elifidni %1, word gs
  4554                              <1>  o16 push %1
  4555                              <1>  %else
  4556                              <1>  push %1
  4557                              <1>  %endif
  4558                              <1> 
  4559                              <1>  %rotate -1
  4560                              <1> %endrep
  4561                              <2> 
  4562                              <2> 
  4563                              <2> 
  4564                              <2> 
  4565                              <2> 
  4566                              <2> 
  4567                              <2> 
  4568                              <2>  %ifidni %1, cs
  4569                              <2>  o16 push %1
  4570                              <2>  %elifidni %1, ds
  4571                              <2>  o16 push %1
  4572                              <2>  %elifidni %1, es
  4573                              <2>  o16 push %1
  4574                              <2>  %elifidni %1, fs
  4575                              <2>  o16 push %1
  4576                              <2>  %elifidni %1, gs
  4577                              <2>  o16 push %1
  4578                              <2>  %elifidni %1, word cs
  4579                              <2>  o16 push %1
  4580                              <2>  %elifidni %1, word ds
  4581                              <2>  o16 push %1
  4582                              <2>  %elifidni %1, word es
  4583                              <2>  o16 push %1
  4584                              <2>  %elifidni %1, word fs
  4585                              <2>  o16 push %1
  4586                              <2>  %elifidni %1, word gs
  4587                              <2>  o16 push %1
  4588                              <2>  %else
  4589 0000049D FF7518              <2>  push %1
  4590                              <2>  %endif
  4591                              <2> 
  4592                              <2>  %rotate -1
  4593                              <2> 
  4594                              <2> 
  4595                              <2> 
  4596                              <2> 
  4597                              <2> 
  4598                              <2> 
  4599                              <2> 
  4600                              <2>  %ifidni %1, cs
  4601                              <2>  o16 push %1
  4602                              <2>  %elifidni %1, ds
  4603                              <2>  o16 push %1
  4604                              <2>  %elifidni %1, es
  4605                              <2>  o16 push %1
  4606                              <2>  %elifidni %1, fs
  4607                              <2>  o16 push %1
  4608                              <2>  %elifidni %1, gs
  4609                              <2>  o16 push %1
  4610                              <2>  %elifidni %1, word cs
  4611                              <2>  o16 push %1
  4612                              <2>  %elifidni %1, word ds
  4613                              <2>  o16 push %1
  4614                              <2>  %elifidni %1, word es
  4615                              <2>  o16 push %1
  4616                              <2>  %elifidni %1, word fs
  4617                              <2>  o16 push %1
  4618                              <2>  %elifidni %1, word gs
  4619                              <2>  o16 push %1
  4620                              <2>  %else
  4621 000004A0 66FF7516            <2>  push %1
  4622                              <2>  %endif
  4623                              <2> 
  4624                              <2>  %rotate -1
  4625                              <2> 
  4626                              <2> 
  4627                              <2> 
  4628                              <2> 
  4629                              <2> 
  4630                              <2> 
  4631                              <2> 
  4632                              <2>  %ifidni %1, cs
  4633                              <2>  o16 push %1
  4634                              <2>  %elifidni %1, ds
  4635                              <2>  o16 push %1
  4636                              <2>  %elifidni %1, es
  4637                              <2>  o16 push %1
  4638                              <2>  %elifidni %1, fs
  4639                              <2>  o16 push %1
  4640                              <2>  %elifidni %1, gs
  4641                              <2>  o16 push %1
  4642                              <2>  %elifidni %1, word cs
  4643                              <2>  o16 push %1
  4644                              <2>  %elifidni %1, word ds
  4645                              <2>  o16 push %1
  4646                              <2>  %elifidni %1, word es
  4647                              <2>  o16 push %1
  4648                              <2>  %elifidni %1, word fs
  4649                              <2>  o16 push %1
  4650                              <2>  %elifidni %1, word gs
  4651                              <2>  o16 push %1
  4652                              <2>  %else
  4653 000004A4 66FF7514            <2>  push %1
  4654                              <2>  %endif
  4655                              <2> 
  4656                              <2>  %rotate -1
  4657                              <2> 
  4658                              <2> 
  4659                              <2> 
  4660                              <2> 
  4661                              <2> 
  4662                              <2> 
  4663                              <2> 
  4664                              <2>  %ifidni %1, cs
  4665                              <2>  o16 push %1
  4666                              <2>  %elifidni %1, ds
  4667                              <2>  o16 push %1
  4668                              <2>  %elifidni %1, es
  4669                              <2>  o16 push %1
  4670                              <2>  %elifidni %1, fs
  4671                              <2>  o16 push %1
  4672                              <2>  %elifidni %1, gs
  4673                              <2>  o16 push %1
  4674                              <2>  %elifidni %1, word cs
  4675                              <2>  o16 push %1
  4676                              <2>  %elifidni %1, word ds
  4677                              <2>  o16 push %1
  4678                              <2>  %elifidni %1, word es
  4679                              <2>  o16 push %1
  4680                              <2>  %elifidni %1, word fs
  4681                              <2>  o16 push %1
  4682                              <2>  %elifidni %1, word gs
  4683                              <2>  o16 push %1
  4684                              <2>  %else
  4685 000004A8 66FF7512            <2>  push %1
  4686                              <2>  %endif
  4687                              <2> 
  4688                              <2>  %rotate -1
  4689                              <2> 
  4690                              <2> 
  4691                              <2> 
  4692                              <2> 
  4693                              <2> 
  4694                              <2> 
  4695                              <2> 
  4696                              <2>  %ifidni %1, cs
  4697                              <2>  o16 push %1
  4698                              <2>  %elifidni %1, ds
  4699                              <2>  o16 push %1
  4700                              <2>  %elifidni %1, es
  4701                              <2>  o16 push %1
  4702                              <2>  %elifidni %1, fs
  4703                              <2>  o16 push %1
  4704                              <2>  %elifidni %1, gs
  4705                              <2>  o16 push %1
  4706                              <2>  %elifidni %1, word cs
  4707                              <2>  o16 push %1
  4708                              <2>  %elifidni %1, word ds
  4709                              <2>  o16 push %1
  4710                              <2>  %elifidni %1, word es
  4711                              <2>  o16 push %1
  4712                              <2>  %elifidni %1, word fs
  4713                              <2>  o16 push %1
  4714                              <2>  %elifidni %1, word gs
  4715                              <2>  o16 push %1
  4716                              <2>  %else
  4717 000004AC 66FF7514            <2>  push %1
  4718                              <2>  %endif
  4719                              <2> 
  4720                              <2>  %rotate -1
  4721                              <2> 
  4722                              <2> 
  4723                              <2> 
  4724                              <2> 
  4725                              <2> 
  4726                              <2> 
  4727                              <2> 
  4728                              <2>  %ifidni %1, cs
  4729                              <2>  o16 push %1
  4730                              <2>  %elifidni %1, ds
  4731                              <2>  o16 push %1
  4732                              <2>  %elifidni %1, es
  4733                              <2>  o16 push %1
  4734                              <2>  %elifidni %1, fs
  4735                              <2>  o16 push %1
  4736                              <2>  %elifidni %1, gs
  4737                              <2>  o16 push %1
  4738                              <2>  %elifidni %1, word cs
  4739                              <2>  o16 push %1
  4740                              <2>  %elifidni %1, word ds
  4741                              <2>  o16 push %1
  4742                              <2>  %elifidni %1, word es
  4743                              <2>  o16 push %1
  4744                              <2>  %elifidni %1, word fs
  4745                              <2>  o16 push %1
  4746                              <2>  %elifidni %1, word gs
  4747                              <2>  o16 push %1
  4748                              <2>  %else
  4749 000004B0 66FF750E            <2>  push %1
  4750                              <2>  %endif
  4751                              <2> 
  4752                              <2>  %rotate -1
  4753                              <2> 
  4754                              <2> 
  4755                              <2> 
  4756                              <2> 
  4757                              <2> 
  4758                              <2> 
  4759                              <2> 
  4760                              <2>  %ifidni %1, cs
  4761                              <2>  o16 push %1
  4762                              <2>  %elifidni %1, ds
  4763                              <2>  o16 push %1
  4764                              <2>  %elifidni %1, es
  4765                              <2>  o16 push %1
  4766                              <2>  %elifidni %1, fs
  4767                              <2>  o16 push %1
  4768                              <2>  %elifidni %1, gs
  4769                              <2>  o16 push %1
  4770                              <2>  %elifidni %1, word cs
  4771                              <2>  o16 push %1
  4772                              <2>  %elifidni %1, word ds
  4773                              <2>  o16 push %1
  4774                              <2>  %elifidni %1, word es
  4775                              <2>  o16 push %1
  4776                              <2>  %elifidni %1, word fs
  4777                              <2>  o16 push %1
  4778                              <2>  %elifidni %1, word gs
  4779                              <2>  o16 push %1
  4780                              <2>  %else
  4781 000004B4 66FF750C            <2>  push %1
  4782                              <2>  %endif
  4783                              <2> 
  4784                              <2>  %rotate -1
  4785                              <2> 
  4786                              <2> 
  4787                              <2> 
  4788                              <2> 
  4789                              <2> 
  4790                              <2> 
  4791                              <2> 
  4792                              <2>  %ifidni %1, cs
  4793                              <2>  o16 push %1
  4794                              <2>  %elifidni %1, ds
  4795                              <2>  o16 push %1
  4796                              <2>  %elifidni %1, es
  4797                              <2>  o16 push %1
  4798                              <2>  %elifidni %1, fs
  4799                              <2>  o16 push %1
  4800                              <2>  %elifidni %1, gs
  4801                              <2>  o16 push %1
  4802                              <2>  %elifidni %1, word cs
  4803                              <2>  o16 push %1
  4804                              <2>  %elifidni %1, word ds
  4805                              <2>  o16 push %1
  4806                              <2>  %elifidni %1, word es
  4807                              <2>  o16 push %1
  4808                              <2>  %elifidni %1, word fs
  4809                              <2>  o16 push %1
  4810                              <2>  %elifidni %1, word gs
  4811                              <2>  o16 push %1
  4812                              <2>  %else
  4813 000004B8 FF7508              <2>  push %1
  4814                              <2>  %endif
  4815                              <2> 
  4816                              <2>  %rotate -1
  4817 000004BB E8C7FDFFFF          <1> call %1
  4818                              <1> %if (%0!=1)
  4819 000004C0 83C414              <1>  add esp, byte %1_arglen
  4820                              <1> %endif
  4821 000004C3 817D1C00000000          	cmp	dword [.FillRectFlag + ebp], 0
  4822 000004CA 7435                    	je	.done
  4823 000004CC 668B4510                	mov	ax, [.X1 + ebp]
  4824 000004D0 66034514                	add	ax, [.X2 + ebp]
  4825 000004D4 66D1E8                  	shr	ax, 1
  4826 000004D7 668B5D12                	mov	bx, [.Y1 + ebp]
  4827 000004DB 66035D16                	add	bx, [.Y2 + ebp]
  4828 000004DF 66D1EB                  	shr	bx, 1
  4829                                  	invoke _FloodFill, dword [.DestOff + ebp], word [.DestWidth + ebp], word [.DestHeight + ebp], ax, bx, dword [.Color + ebp], dword 0
  4830                              <1> %rotate -1
  4831                              <1> 
  4832                              <1> %rep (%0-1)
  4833                              <1> 
  4834                              <1> 
  4835                              <1> 
  4836                              <1> 
  4837                              <1> 
  4838                              <1> 
  4839                              <1> 
  4840                              <1>  %ifidni %1, cs
  4841                              <1>  o16 push %1
  4842                              <1>  %elifidni %1, ds
  4843                              <1>  o16 push %1
  4844                              <1>  %elifidni %1, es
  4845                              <1>  o16 push %1
  4846                              <1>  %elifidni %1, fs
  4847                              <1>  o16 push %1
  4848                              <1>  %elifidni %1, gs
  4849                              <1>  o16 push %1
  4850                              <1>  %elifidni %1, word cs
  4851                              <1>  o16 push %1
  4852                              <1>  %elifidni %1, word ds
  4853                              <1>  o16 push %1
  4854                              <1>  %elifidni %1, word es
  4855                              <1>  o16 push %1
  4856                              <1>  %elifidni %1, word fs
  4857                              <1>  o16 push %1
  4858                              <1>  %elifidni %1, word gs
  4859                              <1>  o16 push %1
  4860                              <1>  %else
  4861                              <1>  push %1
  4862                              <1>  %endif
  4863                              <1> 
  4864                              <1>  %rotate -1
  4865                              <1> %endrep
  4866                              <2> 
  4867                              <2> 
  4868                              <2> 
  4869                              <2> 
  4870                              <2> 
  4871                              <2> 
  4872                              <2> 
  4873                              <2>  %ifidni %1, cs
  4874                              <2>  o16 push %1
  4875                              <2>  %elifidni %1, ds
  4876                              <2>  o16 push %1
  4877                              <2>  %elifidni %1, es
  4878                              <2>  o16 push %1
  4879                              <2>  %elifidni %1, fs
  4880                              <2>  o16 push %1
  4881                              <2>  %elifidni %1, gs
  4882                              <2>  o16 push %1
  4883                              <2>  %elifidni %1, word cs
  4884                              <2>  o16 push %1
  4885                              <2>  %elifidni %1, word ds
  4886                              <2>  o16 push %1
  4887                              <2>  %elifidni %1, word es
  4888                              <2>  o16 push %1
  4889                              <2>  %elifidni %1, word fs
  4890                              <2>  o16 push %1
  4891                              <2>  %elifidni %1, word gs
  4892                              <2>  o16 push %1
  4893                              <2>  %else
  4894 000004E2 6800000000          <2>  push %1
  4895                              <2>  %endif
  4896                              <2> 
  4897                              <2>  %rotate -1
  4898                              <2> 
  4899                              <2> 
  4900                              <2> 
  4901                              <2> 
  4902                              <2> 
  4903                              <2> 
  4904                              <2> 
  4905                              <2>  %ifidni %1, cs
  4906                              <2>  o16 push %1
  4907                              <2>  %elifidni %1, ds
  4908                              <2>  o16 push %1
  4909                              <2>  %elifidni %1, es
  4910                              <2>  o16 push %1
  4911                              <2>  %elifidni %1, fs
  4912                              <2>  o16 push %1
  4913                              <2>  %elifidni %1, gs
  4914                              <2>  o16 push %1
  4915                              <2>  %elifidni %1, word cs
  4916                              <2>  o16 push %1
  4917                              <2>  %elifidni %1, word ds
  4918                              <2>  o16 push %1
  4919                              <2>  %elifidni %1, word es
  4920                              <2>  o16 push %1
  4921                              <2>  %elifidni %1, word fs
  4922                              <2>  o16 push %1
  4923                              <2>  %elifidni %1, word gs
  4924                              <2>  o16 push %1
  4925                              <2>  %else
  4926 000004E7 FF7518              <2>  push %1
  4927                              <2>  %endif
  4928                              <2> 
  4929                              <2>  %rotate -1
  4930                              <2> 
  4931                              <2> 
  4932                              <2> 
  4933                              <2> 
  4934                              <2> 
  4935                              <2> 
  4936                              <2> 
  4937                              <2>  %ifidni %1, cs
  4938                              <2>  o16 push %1
  4939                              <2>  %elifidni %1, ds
  4940                              <2>  o16 push %1
  4941                              <2>  %elifidni %1, es
  4942                              <2>  o16 push %1
  4943                              <2>  %elifidni %1, fs
  4944                              <2>  o16 push %1
  4945                              <2>  %elifidni %1, gs
  4946                              <2>  o16 push %1
  4947                              <2>  %elifidni %1, word cs
  4948                              <2>  o16 push %1
  4949                              <2>  %elifidni %1, word ds
  4950                              <2>  o16 push %1
  4951                              <2>  %elifidni %1, word es
  4952                              <2>  o16 push %1
  4953                              <2>  %elifidni %1, word fs
  4954                              <2>  o16 push %1
  4955                              <2>  %elifidni %1, word gs
  4956                              <2>  o16 push %1
  4957                              <2>  %else
  4958 000004EA 6653                <2>  push %1
  4959                              <2>  %endif
  4960                              <2> 
  4961                              <2>  %rotate -1
  4962                              <2> 
  4963                              <2> 
  4964                              <2> 
  4965                              <2> 
  4966                              <2> 
  4967                              <2> 
  4968                              <2> 
  4969                              <2>  %ifidni %1, cs
  4970                              <2>  o16 push %1
  4971                              <2>  %elifidni %1, ds
  4972                              <2>  o16 push %1
  4973                              <2>  %elifidni %1, es
  4974                              <2>  o16 push %1
  4975                              <2>  %elifidni %1, fs
  4976                              <2>  o16 push %1
  4977                              <2>  %elifidni %1, gs
  4978                              <2>  o16 push %1
  4979                              <2>  %elifidni %1, word cs
  4980                              <2>  o16 push %1
  4981                              <2>  %elifidni %1, word ds
  4982                              <2>  o16 push %1
  4983                              <2>  %elifidni %1, word es
  4984                              <2>  o16 push %1
  4985                              <2>  %elifidni %1, word fs
  4986                              <2>  o16 push %1
  4987                              <2>  %elifidni %1, word gs
  4988                              <2>  o16 push %1
  4989                              <2>  %else
  4990 000004EC 6650                <2>  push %1
  4991                              <2>  %endif
  4992                              <2> 
  4993                              <2>  %rotate -1
  4994                              <2> 
  4995                              <2> 
  4996                              <2> 
  4997                              <2> 
  4998                              <2> 
  4999                              <2> 
  5000                              <2> 
  5001                              <2>  %ifidni %1, cs
  5002                              <2>  o16 push %1
  5003                              <2>  %elifidni %1, ds
  5004                              <2>  o16 push %1
  5005                              <2>  %elifidni %1, es
  5006                              <2>  o16 push %1
  5007                              <2>  %elifidni %1, fs
  5008                              <2>  o16 push %1
  5009                              <2>  %elifidni %1, gs
  5010                              <2>  o16 push %1
  5011                              <2>  %elifidni %1, word cs
  5012                              <2>  o16 push %1
  5013                              <2>  %elifidni %1, word ds
  5014                              <2>  o16 push %1
  5015                              <2>  %elifidni %1, word es
  5016                              <2>  o16 push %1
  5017                              <2>  %elifidni %1, word fs
  5018                              <2>  o16 push %1
  5019                              <2>  %elifidni %1, word gs
  5020                              <2>  o16 push %1
  5021                              <2>  %else
  5022 000004EE 66FF750E            <2>  push %1
  5023                              <2>  %endif
  5024                              <2> 
  5025                              <2>  %rotate -1
  5026                              <2> 
  5027                              <2> 
  5028                              <2> 
  5029                              <2> 
  5030                              <2> 
  5031                              <2> 
  5032                              <2> 
  5033                              <2>  %ifidni %1, cs
  5034                              <2>  o16 push %1
  5035                              <2>  %elifidni %1, ds
  5036                              <2>  o16 push %1
  5037                              <2>  %elifidni %1, es
  5038                              <2>  o16 push %1
  5039                              <2>  %elifidni %1, fs
  5040                              <2>  o16 push %1
  5041                              <2>  %elifidni %1, gs
  5042                              <2>  o16 push %1
  5043                              <2>  %elifidni %1, word cs
  5044                              <2>  o16 push %1
  5045                              <2>  %elifidni %1, word ds
  5046                              <2>  o16 push %1
  5047                              <2>  %elifidni %1, word es
  5048                              <2>  o16 push %1
  5049                              <2>  %elifidni %1, word fs
  5050                              <2>  o16 push %1
  5051                              <2>  %elifidni %1, word gs
  5052                              <2>  o16 push %1
  5053                              <2>  %else
  5054 000004F2 66FF750C            <2>  push %1
  5055                              <2>  %endif
  5056                              <2> 
  5057                              <2>  %rotate -1
  5058                              <2> 
  5059                              <2> 
  5060                              <2> 
  5061                              <2> 
  5062                              <2> 
  5063                              <2> 
  5064                              <2> 
  5065                              <2>  %ifidni %1, cs
  5066                              <2>  o16 push %1
  5067                              <2>  %elifidni %1, ds
  5068                              <2>  o16 push %1
  5069                              <2>  %elifidni %1, es
  5070                              <2>  o16 push %1
  5071                              <2>  %elifidni %1, fs
  5072                              <2>  o16 push %1
  5073                              <2>  %elifidni %1, gs
  5074                              <2>  o16 push %1
  5075                              <2>  %elifidni %1, word cs
  5076                              <2>  o16 push %1
  5077                              <2>  %elifidni %1, word ds
  5078                              <2>  o16 push %1
  5079                              <2>  %elifidni %1, word es
  5080                              <2>  o16 push %1
  5081                              <2>  %elifidni %1, word fs
  5082                              <2>  o16 push %1
  5083                              <2>  %elifidni %1, word gs
  5084                              <2>  o16 push %1
  5085                              <2>  %else
  5086 000004F6 FF7508              <2>  push %1
  5087                              <2>  %endif
  5088                              <2> 
  5089                              <2>  %rotate -1
  5090 000004F9 E83E060000          <1> call %1
  5091                              <1> %if (%0!=1)
  5092 000004FE 83C414              <1>  add esp, byte %1_arglen
  5093                              <1> %endif
  5094                                  
  5095                                  .done
  5096                                  	ret
  5097                              <1> %ifnctx proc
  5098                              <1>  ret %1
  5099                              <1> %else
  5100 00000501 89EC                <1>  mov esp, ebp
  5101 00000503 5D                  <1>  pop ebp
  5102 00000504 C3                  <1>  ret %1
  5103                              <1> %endif
  5104                                  
  5105                                  endproc
  5106                              <1> %ifnctx proc
  5107                              <1> %error Mismatched `endproc'/`proc'
  5108                              <1> %else
  5109                              <1> .STACK_FRAME_SIZE equ %$local
  5110                              <1> 
  5111                              <1> 
  5112                              <1> %ifdef LEGACY_ENDPROC
  5113                              <1>  ret
  5114                              <1> %endif
  5115                              <1> 
  5116                              <1> 
  5117                              <1> 
  5118                              <1> 
  5119                              <1> 
  5120                              <1> 
  5121                              <1> 
  5122                              <1> 
  5123                              <1> 
  5124                              <1> %pop
  5125                              <1> %endif
  5126                                  _DrawRect_arglen	EQU	24
  5127                                  
  5128                                  ;--------------------------------------------------------------------------------------------------------------------------------------
  5129                                  ;-- void DrawCircle(dword *DestOff, word DestWidth, word DestHeight, word X, word Y, word Radius, dword Color, dword FillCircleFlag) --
  5130                                  ;--------------------------------------------------------------------------------------------------------------------------------------
  5131                                  ; Inputs : DestOff - offset of an image buffer in memory
  5132                                  ;          DestWidth - width of the buffer
  5133                                  ;          DestHeight - height of the buffer
  5134                                  ;          X - x coordinate of center
  5135                                  ;          Y - y coordinate of center
  5136                                  ;          Radius - radius of circle
  5137                                  ;          Color - color of line to draw
  5138                                  ;          FillCircleFlag - flag to determine whether or not to fill the circle
  5139                                  ; Outputs : circle drawn to buffer, filled if necessary
  5140                                  ; Returns : -
  5141                                  ; Calls : _DrawPixel, _FloodFill
  5142                                  ; - draws a circle with center (X, Y), color Color, and radius Radius in the buffer pointed to by DestOff
  5143                                  proc _DrawCircle
  5144                              <1> %ifctx proc
  5145                              <1> %error Mismatched `endproc'/`proc'
  5146                              <1> %else
  5147                              <1> %push proc
  5148                              <1>  global %1
  5149 00000505 55                  <1> %1: push ebp
  5150 00000506 89E5                <1>  mov ebp, esp
  5151                              <1> %assign %$arg 8
  5152                              <1> %assign %$local 0
  5153                              <1> 
  5154                              <1> %define %$procname %1
  5155                              <1> %endif
  5156                                  .DestOff	arg	4
  5157                              <1> .DestOff equ %$arg
  5158                              <1> 
  5159                              <1> 
  5160                              <1> %assign %$arg %1+%$arg
  5161                                  .DestWidth	arg	2
  5162                              <1> .DestWidth equ %$arg
  5163                              <1> 
  5164                              <1> 
  5165                              <1> %assign %$arg %1+%$arg
  5166                                  .DestHeight	arg	2
  5167                              <1> .DestHeight equ %$arg
  5168                              <1> 
  5169                              <1> 
  5170                              <1> %assign %$arg %1+%$arg
  5171                                  .X		arg	2
  5172                              <1> .X equ %$arg
  5173                              <1> 
  5174                              <1> 
  5175                              <1> %assign %$arg %1+%$arg
  5176                                  .Y		arg	2
  5177                              <1> .Y equ %$arg
  5178                              <1> 
  5179                              <1> 
  5180                              <1> %assign %$arg %1+%$arg
  5181                                  .Radius		arg	2
  5182                              <1> .Radius equ %$arg
  5183                              <1> 
  5184                              <1> 
  5185                              <1> %assign %$arg %1+%$arg
  5186                                  .Color		arg	4
  5187                              <1> .Color equ %$arg
  5188                              <1> 
  5189                              <1> 
  5190                              <1> %assign %$arg %1+%$arg
  5191                                  .FillCircleFlag	arg	4
  5192                              <1> .FillCircleFlag equ %$arg
  5193                              <1> 
  5194                              <1> 
  5195                              <1> %assign %$arg %1+%$arg
  5196                                  
  5197                                  ;	invoke	_libDrawCircle, dword [ebp+.DestOff], word [ebp+.DestWidth], word [ebp+.DestHeight], word [ebp+.X], word [ebp+.Y], word [ebp+.Radius], dword [ebp+.Color], dword [ebp+.FillCircleFlag]
  5198                                  
  5199 00000508 66C705[42000000]00-     	mov	word [_xdist], 0
  5200 00000510 00                 
  5201 00000511 668B4514                	mov	ax, [.Radius + ebp]
  5202 00000515 66A3[44000000]          	mov	word [_ydist], ax
  5203 0000051B 66C705[40000000]01-     	mov	word [_circleerror], 1
  5204 00000523 00                 
  5205 00000524 662905[40000000]        	sub	[_circleerror], ax
  5206                                  
  5207                                  .loopDrawCircle
  5208 0000052B 66A1[42000000]          	mov	ax, [_xdist]
  5209 00000531 663B05[44000000]        	cmp	ax, [_ydist]
  5210 00000538 0F8FCE010000            	jg	near .fillCircle
  5211 0000053E 668B4510                	mov	ax, [.X + ebp]
  5212 00000542 660305[42000000]        	add	ax, [_xdist]		; x + xdist
  5213 00000549 668B5D12                	mov	bx, [.Y + ebp]
  5214 0000054D 66031D[44000000]        	add	bx, [_ydist]		; y + ydist
  5215                                  	invoke _DrawPixel, dword [.DestOff + ebp], word [.DestWidth + ebp], word [.DestHeight + ebp], ax, bx, dword [.Color + ebp]
  5216                              <1> %rotate -1
  5217                              <1> 
  5218                              <1> %rep (%0-1)
  5219                              <1> 
  5220                              <1> 
  5221                              <1> 
  5222                              <1> 
  5223                              <1> 
  5224                              <1> 
  5225                              <1> 
  5226                              <1>  %ifidni %1, cs
  5227                              <1>  o16 push %1
  5228                              <1>  %elifidni %1, ds
  5229                              <1>  o16 push %1
  5230                              <1>  %elifidni %1, es
  5231                              <1>  o16 push %1
  5232                              <1>  %elifidni %1, fs
  5233                              <1>  o16 push %1
  5234                              <1>  %elifidni %1, gs
  5235                              <1>  o16 push %1
  5236                              <1>  %elifidni %1, word cs
  5237                              <1>  o16 push %1
  5238                              <1>  %elifidni %1, word ds
  5239                              <1>  o16 push %1
  5240                              <1>  %elifidni %1, word es
  5241                              <1>  o16 push %1
  5242                              <1>  %elifidni %1, word fs
  5243                              <1>  o16 push %1
  5244                              <1>  %elifidni %1, word gs
  5245                              <1>  o16 push %1
  5246                              <1>  %else
  5247                              <1>  push %1
  5248                              <1>  %endif
  5249                              <1> 
  5250                              <1>  %rotate -1
  5251                              <1> %endrep
  5252                              <2> 
  5253                              <2> 
  5254                              <2> 
  5255                              <2> 
  5256                              <2> 
  5257                              <2> 
  5258                              <2> 
  5259                              <2>  %ifidni %1, cs
  5260                              <2>  o16 push %1
  5261                              <2>  %elifidni %1, ds
  5262                              <2>  o16 push %1
  5263                              <2>  %elifidni %1, es
  5264                              <2>  o16 push %1
  5265                              <2>  %elifidni %1, fs
  5266                              <2>  o16 push %1
  5267                              <2>  %elifidni %1, gs
  5268                              <2>  o16 push %1
  5269                              <2>  %elifidni %1, word cs
  5270                              <2>  o16 push %1
  5271                              <2>  %elifidni %1, word ds
  5272                              <2>  o16 push %1
  5273                              <2>  %elifidni %1, word es
  5274                              <2>  o16 push %1
  5275                              <2>  %elifidni %1, word fs
  5276                              <2>  o16 push %1
  5277                              <2>  %elifidni %1, word gs
  5278                              <2>  o16 push %1
  5279                              <2>  %else
  5280 00000554 FF7516              <2>  push %1
  5281                              <2>  %endif
  5282                              <2> 
  5283                              <2>  %rotate -1
  5284                              <2> 
  5285                              <2> 
  5286                              <2> 
  5287                              <2> 
  5288                              <2> 
  5289                              <2> 
  5290                              <2> 
  5291                              <2>  %ifidni %1, cs
  5292                              <2>  o16 push %1
  5293                              <2>  %elifidni %1, ds
  5294                              <2>  o16 push %1
  5295                              <2>  %elifidni %1, es
  5296                              <2>  o16 push %1
  5297                              <2>  %elifidni %1, fs
  5298                              <2>  o16 push %1
  5299                              <2>  %elifidni %1, gs
  5300                              <2>  o16 push %1
  5301                              <2>  %elifidni %1, word cs
  5302                              <2>  o16 push %1
  5303                              <2>  %elifidni %1, word ds
  5304                              <2>  o16 push %1
  5305                              <2>  %elifidni %1, word es
  5306                              <2>  o16 push %1
  5307                              <2>  %elifidni %1, word fs
  5308                              <2>  o16 push %1
  5309                              <2>  %elifidni %1, word gs
  5310                              <2>  o16 push %1
  5311                              <2>  %else
  5312 00000557 6653                <2>  push %1
  5313                              <2>  %endif
  5314                              <2> 
  5315                              <2>  %rotate -1
  5316                              <2> 
  5317                              <2> 
  5318                              <2> 
  5319                              <2> 
  5320                              <2> 
  5321                              <2> 
  5322                              <2> 
  5323                              <2>  %ifidni %1, cs
  5324                              <2>  o16 push %1
  5325                              <2>  %elifidni %1, ds
  5326                              <2>  o16 push %1
  5327                              <2>  %elifidni %1, es
  5328                              <2>  o16 push %1
  5329                              <2>  %elifidni %1, fs
  5330                              <2>  o16 push %1
  5331                              <2>  %elifidni %1, gs
  5332                              <2>  o16 push %1
  5333                              <2>  %elifidni %1, word cs
  5334                              <2>  o16 push %1
  5335                              <2>  %elifidni %1, word ds
  5336                              <2>  o16 push %1
  5337                              <2>  %elifidni %1, word es
  5338                              <2>  o16 push %1
  5339                              <2>  %elifidni %1, word fs
  5340                              <2>  o16 push %1
  5341                              <2>  %elifidni %1, word gs
  5342                              <2>  o16 push %1
  5343                              <2>  %else
  5344 00000559 6650                <2>  push %1
  5345                              <2>  %endif
  5346                              <2> 
  5347                              <2>  %rotate -1
  5348                              <2> 
  5349                              <2> 
  5350                              <2> 
  5351                              <2> 
  5352                              <2> 
  5353                              <2> 
  5354                              <2> 
  5355                              <2>  %ifidni %1, cs
  5356                              <2>  o16 push %1
  5357                              <2>  %elifidni %1, ds
  5358                              <2>  o16 push %1
  5359                              <2>  %elifidni %1, es
  5360                              <2>  o16 push %1
  5361                              <2>  %elifidni %1, fs
  5362                              <2>  o16 push %1
  5363                              <2>  %elifidni %1, gs
  5364                              <2>  o16 push %1
  5365                              <2>  %elifidni %1, word cs
  5366                              <2>  o16 push %1
  5367                              <2>  %elifidni %1, word ds
  5368                              <2>  o16 push %1
  5369                              <2>  %elifidni %1, word es
  5370                              <2>  o16 push %1
  5371                              <2>  %elifidni %1, word fs
  5372                              <2>  o16 push %1
  5373                              <2>  %elifidni %1, word gs
  5374                              <2>  o16 push %1
  5375                              <2>  %else
  5376 0000055B 66FF750E            <2>  push %1
  5377                              <2>  %endif
  5378                              <2> 
  5379                              <2>  %rotate -1
  5380                              <2> 
  5381                              <2> 
  5382                              <2> 
  5383                              <2> 
  5384                              <2> 
  5385                              <2> 
  5386                              <2> 
  5387                              <2>  %ifidni %1, cs
  5388                              <2>  o16 push %1
  5389                              <2>  %elifidni %1, ds
  5390                              <2>  o16 push %1
  5391                              <2>  %elifidni %1, es
  5392                              <2>  o16 push %1
  5393                              <2>  %elifidni %1, fs
  5394                              <2>  o16 push %1
  5395                              <2>  %elifidni %1, gs
  5396                              <2>  o16 push %1
  5397                              <2>  %elifidni %1, word cs
  5398                              <2>  o16 push %1
  5399                              <2>  %elifidni %1, word ds
  5400                              <2>  o16 push %1
  5401                              <2>  %elifidni %1, word es
  5402                              <2>  o16 push %1
  5403                              <2>  %elifidni %1, word fs
  5404                              <2>  o16 push %1
  5405                              <2>  %elifidni %1, word gs
  5406                              <2>  o16 push %1
  5407                              <2>  %else
  5408 0000055F 66FF750C            <2>  push %1
  5409                              <2>  %endif
  5410                              <2> 
  5411                              <2>  %rotate -1
  5412                              <2> 
  5413                              <2> 
  5414                              <2> 
  5415                              <2> 
  5416                              <2> 
  5417                              <2> 
  5418                              <2> 
  5419                              <2>  %ifidni %1, cs
  5420                              <2>  o16 push %1
  5421                              <2>  %elifidni %1, ds
  5422                              <2>  o16 push %1
  5423                              <2>  %elifidni %1, es
  5424                              <2>  o16 push %1
  5425                              <2>  %elifidni %1, fs
  5426                              <2>  o16 push %1
  5427                              <2>  %elifidni %1, gs
  5428                              <2>  o16 push %1
  5429                              <2>  %elifidni %1, word cs
  5430                              <2>  o16 push %1
  5431                              <2>  %elifidni %1, word ds
  5432                              <2>  o16 push %1
  5433                              <2>  %elifidni %1, word es
  5434                              <2>  o16 push %1
  5435                              <2>  %elifidni %1, word fs
  5436                              <2>  o16 push %1
  5437                              <2>  %elifidni %1, word gs
  5438                              <2>  o16 push %1
  5439                              <2>  %else
  5440 00000563 FF7508              <2>  push %1
  5441                              <2>  %endif
  5442                              <2> 
  5443                              <2>  %rotate -1
  5444 00000566 E8D6FCFFFF          <1> call %1
  5445                              <1> %if (%0!=1)
  5446 0000056B 83C410              <1>  add esp, byte %1_arglen
  5447                              <1> %endif
  5448 0000056E 668B4510                	mov	ax, [.X + ebp]
  5449 00000572 662B05[42000000]        	sub	ax, [_xdist]		; x - xdist
  5450 00000579 668B5D12                	mov	bx, [.Y + ebp]
  5451 0000057D 66031D[44000000]        	add	bx, [_ydist]		; y + ydist
  5452                                  	invoke _DrawPixel, dword [.DestOff + ebp], word [.DestWidth + ebp], word [.DestHeight + ebp], ax, bx, dword [.Color + ebp]
  5453                              <1> %rotate -1
  5454                              <1> 
  5455                              <1> %rep (%0-1)
  5456                              <1> 
  5457                              <1> 
  5458                              <1> 
  5459                              <1> 
  5460                              <1> 
  5461                              <1> 
  5462                              <1> 
  5463                              <1>  %ifidni %1, cs
  5464                              <1>  o16 push %1
  5465                              <1>  %elifidni %1, ds
  5466                              <1>  o16 push %1
  5467                              <1>  %elifidni %1, es
  5468                              <1>  o16 push %1
  5469                              <1>  %elifidni %1, fs
  5470                              <1>  o16 push %1
  5471                              <1>  %elifidni %1, gs
  5472                              <1>  o16 push %1
  5473                              <1>  %elifidni %1, word cs
  5474                              <1>  o16 push %1
  5475                              <1>  %elifidni %1, word ds
  5476                              <1>  o16 push %1
  5477                              <1>  %elifidni %1, word es
  5478                              <1>  o16 push %1
  5479                              <1>  %elifidni %1, word fs
  5480                              <1>  o16 push %1
  5481                              <1>  %elifidni %1, word gs
  5482                              <1>  o16 push %1
  5483                              <1>  %else
  5484                              <1>  push %1
  5485                              <1>  %endif
  5486                              <1> 
  5487                              <1>  %rotate -1
  5488                              <1> %endrep
  5489                              <2> 
  5490                              <2> 
  5491                              <2> 
  5492                              <2> 
  5493                              <2> 
  5494                              <2> 
  5495                              <2> 
  5496                              <2>  %ifidni %1, cs
  5497                              <2>  o16 push %1
  5498                              <2>  %elifidni %1, ds
  5499                              <2>  o16 push %1
  5500                              <2>  %elifidni %1, es
  5501                              <2>  o16 push %1
  5502                              <2>  %elifidni %1, fs
  5503                              <2>  o16 push %1
  5504                              <2>  %elifidni %1, gs
  5505                              <2>  o16 push %1
  5506                              <2>  %elifidni %1, word cs
  5507                              <2>  o16 push %1
  5508                              <2>  %elifidni %1, word ds
  5509                              <2>  o16 push %1
  5510                              <2>  %elifidni %1, word es
  5511                              <2>  o16 push %1
  5512                              <2>  %elifidni %1, word fs
  5513                              <2>  o16 push %1
  5514                              <2>  %elifidni %1, word gs
  5515                              <2>  o16 push %1
  5516                              <2>  %else
  5517 00000584 FF7516              <2>  push %1
  5518                              <2>  %endif
  5519                              <2> 
  5520                              <2>  %rotate -1
  5521                              <2> 
  5522                              <2> 
  5523                              <2> 
  5524                              <2> 
  5525                              <2> 
  5526                              <2> 
  5527                              <2> 
  5528                              <2>  %ifidni %1, cs
  5529                              <2>  o16 push %1
  5530                              <2>  %elifidni %1, ds
  5531                              <2>  o16 push %1
  5532                              <2>  %elifidni %1, es
  5533                              <2>  o16 push %1
  5534                              <2>  %elifidni %1, fs
  5535                              <2>  o16 push %1
  5536                              <2>  %elifidni %1, gs
  5537                              <2>  o16 push %1
  5538                              <2>  %elifidni %1, word cs
  5539                              <2>  o16 push %1
  5540                              <2>  %elifidni %1, word ds
  5541                              <2>  o16 push %1
  5542                              <2>  %elifidni %1, word es
  5543                              <2>  o16 push %1
  5544                              <2>  %elifidni %1, word fs
  5545                              <2>  o16 push %1
  5546                              <2>  %elifidni %1, word gs
  5547                              <2>  o16 push %1
  5548                              <2>  %else
  5549 00000587 6653                <2>  push %1
  5550                              <2>  %endif
  5551                              <2> 
  5552                              <2>  %rotate -1
  5553                              <2> 
  5554                              <2> 
  5555                              <2> 
  5556                              <2> 
  5557                              <2> 
  5558                              <2> 
  5559                              <2> 
  5560                              <2>  %ifidni %1, cs
  5561                              <2>  o16 push %1
  5562                              <2>  %elifidni %1, ds
  5563                              <2>  o16 push %1
  5564                              <2>  %elifidni %1, es
  5565                              <2>  o16 push %1
  5566                              <2>  %elifidni %1, fs
  5567                              <2>  o16 push %1
  5568                              <2>  %elifidni %1, gs
  5569                              <2>  o16 push %1
  5570                              <2>  %elifidni %1, word cs
  5571                              <2>  o16 push %1
  5572                              <2>  %elifidni %1, word ds
  5573                              <2>  o16 push %1
  5574                              <2>  %elifidni %1, word es
  5575                              <2>  o16 push %1
  5576                              <2>  %elifidni %1, word fs
  5577                              <2>  o16 push %1
  5578                              <2>  %elifidni %1, word gs
  5579                              <2>  o16 push %1
  5580                              <2>  %else
  5581 00000589 6650                <2>  push %1
  5582                              <2>  %endif
  5583                              <2> 
  5584                              <2>  %rotate -1
  5585                              <2> 
  5586                              <2> 
  5587                              <2> 
  5588                              <2> 
  5589                              <2> 
  5590                              <2> 
  5591                              <2> 
  5592                              <2>  %ifidni %1, cs
  5593                              <2>  o16 push %1
  5594                              <2>  %elifidni %1, ds
  5595                              <2>  o16 push %1
  5596                              <2>  %elifidni %1, es
  5597                              <2>  o16 push %1
  5598                              <2>  %elifidni %1, fs
  5599                              <2>  o16 push %1
  5600                              <2>  %elifidni %1, gs
  5601                              <2>  o16 push %1
  5602                              <2>  %elifidni %1, word cs
  5603                              <2>  o16 push %1
  5604                              <2>  %elifidni %1, word ds
  5605                              <2>  o16 push %1
  5606                              <2>  %elifidni %1, word es
  5607                              <2>  o16 push %1
  5608                              <2>  %elifidni %1, word fs
  5609                              <2>  o16 push %1
  5610                              <2>  %elifidni %1, word gs
  5611                              <2>  o16 push %1
  5612                              <2>  %else
  5613 0000058B 66FF750E            <2>  push %1
  5614                              <2>  %endif
  5615                              <2> 
  5616                              <2>  %rotate -1
  5617                              <2> 
  5618                              <2> 
  5619                              <2> 
  5620                              <2> 
  5621                              <2> 
  5622                              <2> 
  5623                              <2> 
  5624                              <2>  %ifidni %1, cs
  5625                              <2>  o16 push %1
  5626                              <2>  %elifidni %1, ds
  5627                              <2>  o16 push %1
  5628                              <2>  %elifidni %1, es
  5629                              <2>  o16 push %1
  5630                              <2>  %elifidni %1, fs
  5631                              <2>  o16 push %1
  5632                              <2>  %elifidni %1, gs
  5633                              <2>  o16 push %1
  5634                              <2>  %elifidni %1, word cs
  5635                              <2>  o16 push %1
  5636                              <2>  %elifidni %1, word ds
  5637                              <2>  o16 push %1
  5638                              <2>  %elifidni %1, word es
  5639                              <2>  o16 push %1
  5640                              <2>  %elifidni %1, word fs
  5641                              <2>  o16 push %1
  5642                              <2>  %elifidni %1, word gs
  5643                              <2>  o16 push %1
  5644                              <2>  %else
  5645 0000058F 66FF750C            <2>  push %1
  5646                              <2>  %endif
  5647                              <2> 
  5648                              <2>  %rotate -1
  5649                              <2> 
  5650                              <2> 
  5651                              <2> 
  5652                              <2> 
  5653                              <2> 
  5654                              <2> 
  5655                              <2> 
  5656                              <2>  %ifidni %1, cs
  5657                              <2>  o16 push %1
  5658                              <2>  %elifidni %1, ds
  5659                              <2>  o16 push %1
  5660                              <2>  %elifidni %1, es
  5661                              <2>  o16 push %1
  5662                              <2>  %elifidni %1, fs
  5663                              <2>  o16 push %1
  5664                              <2>  %elifidni %1, gs
  5665                              <2>  o16 push %1
  5666                              <2>  %elifidni %1, word cs
  5667                              <2>  o16 push %1
  5668                              <2>  %elifidni %1, word ds
  5669                              <2>  o16 push %1
  5670                              <2>  %elifidni %1, word es
  5671                              <2>  o16 push %1
  5672                              <2>  %elifidni %1, word fs
  5673                              <2>  o16 push %1
  5674                              <2>  %elifidni %1, word gs
  5675                              <2>  o16 push %1
  5676                              <2>  %else
  5677 00000593 FF7508              <2>  push %1
  5678                              <2>  %endif
  5679                              <2> 
  5680                              <2>  %rotate -1
  5681 00000596 E8A6FCFFFF          <1> call %1
  5682                              <1> %if (%0!=1)
  5683 0000059B 83C410              <1>  add esp, byte %1_arglen
  5684                              <1> %endif
  5685 0000059E 668B4510                	mov	ax, [.X + ebp]
  5686 000005A2 660305[42000000]        	add	ax, [_xdist]		; x + xdist
  5687 000005A9 668B5D12                	mov	bx, [.Y + ebp]
  5688 000005AD 662B1D[44000000]        	sub	bx, [_ydist]		; y + ydist
  5689                                  	invoke _DrawPixel, dword [.DestOff + ebp], word [.DestWidth + ebp], word [.DestHeight + ebp], ax, bx, dword [.Color + ebp]
  5690                              <1> %rotate -1
  5691                              <1> 
  5692                              <1> %rep (%0-1)
  5693                              <1> 
  5694                              <1> 
  5695                              <1> 
  5696                              <1> 
  5697                              <1> 
  5698                              <1> 
  5699                              <1> 
  5700                              <1>  %ifidni %1, cs
  5701                              <1>  o16 push %1
  5702                              <1>  %elifidni %1, ds
  5703                              <1>  o16 push %1
  5704                              <1>  %elifidni %1, es
  5705                              <1>  o16 push %1
  5706                              <1>  %elifidni %1, fs
  5707                              <1>  o16 push %1
  5708                              <1>  %elifidni %1, gs
  5709                              <1>  o16 push %1
  5710                              <1>  %elifidni %1, word cs
  5711                              <1>  o16 push %1
  5712                              <1>  %elifidni %1, word ds
  5713                              <1>  o16 push %1
  5714                              <1>  %elifidni %1, word es
  5715                              <1>  o16 push %1
  5716                              <1>  %elifidni %1, word fs
  5717                              <1>  o16 push %1
  5718                              <1>  %elifidni %1, word gs
  5719                              <1>  o16 push %1
  5720                              <1>  %else
  5721                              <1>  push %1
  5722                              <1>  %endif
  5723                              <1> 
  5724                              <1>  %rotate -1
  5725                              <1> %endrep
  5726                              <2> 
  5727                              <2> 
  5728                              <2> 
  5729                              <2> 
  5730                              <2> 
  5731                              <2> 
  5732                              <2> 
  5733                              <2>  %ifidni %1, cs
  5734                              <2>  o16 push %1
  5735                              <2>  %elifidni %1, ds
  5736                              <2>  o16 push %1
  5737                              <2>  %elifidni %1, es
  5738                              <2>  o16 push %1
  5739                              <2>  %elifidni %1, fs
  5740                              <2>  o16 push %1
  5741                              <2>  %elifidni %1, gs
  5742                              <2>  o16 push %1
  5743                              <2>  %elifidni %1, word cs
  5744                              <2>  o16 push %1
  5745                              <2>  %elifidni %1, word ds
  5746                              <2>  o16 push %1
  5747                              <2>  %elifidni %1, word es
  5748                              <2>  o16 push %1
  5749                              <2>  %elifidni %1, word fs
  5750                              <2>  o16 push %1
  5751                              <2>  %elifidni %1, word gs
  5752                              <2>  o16 push %1
  5753                              <2>  %else
  5754 000005B4 FF7516              <2>  push %1
  5755                              <2>  %endif
  5756                              <2> 
  5757                              <2>  %rotate -1
  5758                              <2> 
  5759                              <2> 
  5760                              <2> 
  5761                              <2> 
  5762                              <2> 
  5763                              <2> 
  5764                              <2> 
  5765                              <2>  %ifidni %1, cs
  5766                              <2>  o16 push %1
  5767                              <2>  %elifidni %1, ds
  5768                              <2>  o16 push %1
  5769                              <2>  %elifidni %1, es
  5770                              <2>  o16 push %1
  5771                              <2>  %elifidni %1, fs
  5772                              <2>  o16 push %1
  5773                              <2>  %elifidni %1, gs
  5774                              <2>  o16 push %1
  5775                              <2>  %elifidni %1, word cs
  5776                              <2>  o16 push %1
  5777                              <2>  %elifidni %1, word ds
  5778                              <2>  o16 push %1
  5779                              <2>  %elifidni %1, word es
  5780                              <2>  o16 push %1
  5781                              <2>  %elifidni %1, word fs
  5782                              <2>  o16 push %1
  5783                              <2>  %elifidni %1, word gs
  5784                              <2>  o16 push %1
  5785                              <2>  %else
  5786 000005B7 6653                <2>  push %1
  5787                              <2>  %endif
  5788                              <2> 
  5789                              <2>  %rotate -1
  5790                              <2> 
  5791                              <2> 
  5792                              <2> 
  5793                              <2> 
  5794                              <2> 
  5795                              <2> 
  5796                              <2> 
  5797                              <2>  %ifidni %1, cs
  5798                              <2>  o16 push %1
  5799                              <2>  %elifidni %1, ds
  5800                              <2>  o16 push %1
  5801                              <2>  %elifidni %1, es
  5802                              <2>  o16 push %1
  5803                              <2>  %elifidni %1, fs
  5804                              <2>  o16 push %1
  5805                              <2>  %elifidni %1, gs
  5806                              <2>  o16 push %1
  5807                              <2>  %elifidni %1, word cs
  5808                              <2>  o16 push %1
  5809                              <2>  %elifidni %1, word ds
  5810                              <2>  o16 push %1
  5811                              <2>  %elifidni %1, word es
  5812                              <2>  o16 push %1
  5813                              <2>  %elifidni %1, word fs
  5814                              <2>  o16 push %1
  5815                              <2>  %elifidni %1, word gs
  5816                              <2>  o16 push %1
  5817                              <2>  %else
  5818 000005B9 6650                <2>  push %1
  5819                              <2>  %endif
  5820                              <2> 
  5821                              <2>  %rotate -1
  5822                              <2> 
  5823                              <2> 
  5824                              <2> 
  5825                              <2> 
  5826                              <2> 
  5827                              <2> 
  5828                              <2> 
  5829                              <2>  %ifidni %1, cs
  5830                              <2>  o16 push %1
  5831                              <2>  %elifidni %1, ds
  5832                              <2>  o16 push %1
  5833                              <2>  %elifidni %1, es
  5834                              <2>  o16 push %1
  5835                              <2>  %elifidni %1, fs
  5836                              <2>  o16 push %1
  5837                              <2>  %elifidni %1, gs
  5838                              <2>  o16 push %1
  5839                              <2>  %elifidni %1, word cs
  5840                              <2>  o16 push %1
  5841                              <2>  %elifidni %1, word ds
  5842                              <2>  o16 push %1
  5843                              <2>  %elifidni %1, word es
  5844                              <2>  o16 push %1
  5845                              <2>  %elifidni %1, word fs
  5846                              <2>  o16 push %1
  5847                              <2>  %elifidni %1, word gs
  5848                              <2>  o16 push %1
  5849                              <2>  %else
  5850 000005BB 66FF750E            <2>  push %1
  5851                              <2>  %endif
  5852                              <2> 
  5853                              <2>  %rotate -1
  5854                              <2> 
  5855                              <2> 
  5856                              <2> 
  5857                              <2> 
  5858                              <2> 
  5859                              <2> 
  5860                              <2> 
  5861                              <2>  %ifidni %1, cs
  5862                              <2>  o16 push %1
  5863                              <2>  %elifidni %1, ds
  5864                              <2>  o16 push %1
  5865                              <2>  %elifidni %1, es
  5866                              <2>  o16 push %1
  5867                              <2>  %elifidni %1, fs
  5868                              <2>  o16 push %1
  5869                              <2>  %elifidni %1, gs
  5870                              <2>  o16 push %1
  5871                              <2>  %elifidni %1, word cs
  5872                              <2>  o16 push %1
  5873                              <2>  %elifidni %1, word ds
  5874                              <2>  o16 push %1
  5875                              <2>  %elifidni %1, word es
  5876                              <2>  o16 push %1
  5877                              <2>  %elifidni %1, word fs
  5878                              <2>  o16 push %1
  5879                              <2>  %elifidni %1, word gs
  5880                              <2>  o16 push %1
  5881                              <2>  %else
  5882 000005BF 66FF750C            <2>  push %1
  5883                              <2>  %endif
  5884                              <2> 
  5885                              <2>  %rotate -1
  5886                              <2> 
  5887                              <2> 
  5888                              <2> 
  5889                              <2> 
  5890                              <2> 
  5891                              <2> 
  5892                              <2> 
  5893                              <2>  %ifidni %1, cs
  5894                              <2>  o16 push %1
  5895                              <2>  %elifidni %1, ds
  5896                              <2>  o16 push %1
  5897                              <2>  %elifidni %1, es
  5898                              <2>  o16 push %1
  5899                              <2>  %elifidni %1, fs
  5900                              <2>  o16 push %1
  5901                              <2>  %elifidni %1, gs
  5902                              <2>  o16 push %1
  5903                              <2>  %elifidni %1, word cs
  5904                              <2>  o16 push %1
  5905                              <2>  %elifidni %1, word ds
  5906                              <2>  o16 push %1
  5907                              <2>  %elifidni %1, word es
  5908                              <2>  o16 push %1
  5909                              <2>  %elifidni %1, word fs
  5910                              <2>  o16 push %1
  5911                              <2>  %elifidni %1, word gs
  5912                              <2>  o16 push %1
  5913                              <2>  %else
  5914 000005C3 FF7508              <2>  push %1
  5915                              <2>  %endif
  5916                              <2> 
  5917                              <2>  %rotate -1
  5918 000005C6 E876FCFFFF          <1> call %1
  5919                              <1> %if (%0!=1)
  5920 000005CB 83C410              <1>  add esp, byte %1_arglen
  5921                              <1> %endif
  5922 000005CE 668B4510                	mov	ax, [.X + ebp]
  5923 000005D2 662B05[42000000]        	sub	ax, [_xdist]		; x - xdist
  5924 000005D9 668B5D12                	mov	bx, [.Y + ebp]
  5925 000005DD 662B1D[44000000]        	sub	bx, [_ydist]		; y - ydist
  5926                                  	invoke _DrawPixel, dword [.DestOff + ebp], word [.DestWidth + ebp], word [.DestHeight + ebp], ax, bx, dword [.Color + ebp]
  5927                              <1> %rotate -1
  5928                              <1> 
  5929                              <1> %rep (%0-1)
  5930                              <1> 
  5931                              <1> 
  5932                              <1> 
  5933                              <1> 
  5934                              <1> 
  5935                              <1> 
  5936                              <1> 
  5937                              <1>  %ifidni %1, cs
  5938                              <1>  o16 push %1
  5939                              <1>  %elifidni %1, ds
  5940                              <1>  o16 push %1
  5941                              <1>  %elifidni %1, es
  5942                              <1>  o16 push %1
  5943                              <1>  %elifidni %1, fs
  5944                              <1>  o16 push %1
  5945                              <1>  %elifidni %1, gs
  5946                              <1>  o16 push %1
  5947                              <1>  %elifidni %1, word cs
  5948                              <1>  o16 push %1
  5949                              <1>  %elifidni %1, word ds
  5950                              <1>  o16 push %1
  5951                              <1>  %elifidni %1, word es
  5952                              <1>  o16 push %1
  5953                              <1>  %elifidni %1, word fs
  5954                              <1>  o16 push %1
  5955                              <1>  %elifidni %1, word gs
  5956                              <1>  o16 push %1
  5957                              <1>  %else
  5958                              <1>  push %1
  5959                              <1>  %endif
  5960                              <1> 
  5961                              <1>  %rotate -1
  5962                              <1> %endrep
  5963                              <2> 
  5964                              <2> 
  5965                              <2> 
  5966                              <2> 
  5967                              <2> 
  5968                              <2> 
  5969                              <2> 
  5970                              <2>  %ifidni %1, cs
  5971                              <2>  o16 push %1
  5972                              <2>  %elifidni %1, ds
  5973                              <2>  o16 push %1
  5974                              <2>  %elifidni %1, es
  5975                              <2>  o16 push %1
  5976                              <2>  %elifidni %1, fs
  5977                              <2>  o16 push %1
  5978                              <2>  %elifidni %1, gs
  5979                              <2>  o16 push %1
  5980                              <2>  %elifidni %1, word cs
  5981                              <2>  o16 push %1
  5982                              <2>  %elifidni %1, word ds
  5983                              <2>  o16 push %1
  5984                              <2>  %elifidni %1, word es
  5985                              <2>  o16 push %1
  5986                              <2>  %elifidni %1, word fs
  5987                              <2>  o16 push %1
  5988                              <2>  %elifidni %1, word gs
  5989                              <2>  o16 push %1
  5990                              <2>  %else
  5991 000005E4 FF7516              <2>  push %1
  5992                              <2>  %endif
  5993                              <2> 
  5994                              <2>  %rotate -1
  5995                              <2> 
  5996                              <2> 
  5997                              <2> 
  5998                              <2> 
  5999                              <2> 
  6000                              <2> 
  6001                              <2> 
  6002                              <2>  %ifidni %1, cs
  6003                              <2>  o16 push %1
  6004                              <2>  %elifidni %1, ds
  6005                              <2>  o16 push %1
  6006                              <2>  %elifidni %1, es
  6007                              <2>  o16 push %1
  6008                              <2>  %elifidni %1, fs
  6009                              <2>  o16 push %1
  6010                              <2>  %elifidni %1, gs
  6011                              <2>  o16 push %1
  6012                              <2>  %elifidni %1, word cs
  6013                              <2>  o16 push %1
  6014                              <2>  %elifidni %1, word ds
  6015                              <2>  o16 push %1
  6016                              <2>  %elifidni %1, word es
  6017                              <2>  o16 push %1
  6018                              <2>  %elifidni %1, word fs
  6019                              <2>  o16 push %1
  6020                              <2>  %elifidni %1, word gs
  6021                              <2>  o16 push %1
  6022                              <2>  %else
  6023 000005E7 6653                <2>  push %1
  6024                              <2>  %endif
  6025                              <2> 
  6026                              <2>  %rotate -1
  6027                              <2> 
  6028                              <2> 
  6029                              <2> 
  6030                              <2> 
  6031                              <2> 
  6032                              <2> 
  6033                              <2> 
  6034                              <2>  %ifidni %1, cs
  6035                              <2>  o16 push %1
  6036                              <2>  %elifidni %1, ds
  6037                              <2>  o16 push %1
  6038                              <2>  %elifidni %1, es
  6039                              <2>  o16 push %1
  6040                              <2>  %elifidni %1, fs
  6041                              <2>  o16 push %1
  6042                              <2>  %elifidni %1, gs
  6043                              <2>  o16 push %1
  6044                              <2>  %elifidni %1, word cs
  6045                              <2>  o16 push %1
  6046                              <2>  %elifidni %1, word ds
  6047                              <2>  o16 push %1
  6048                              <2>  %elifidni %1, word es
  6049                              <2>  o16 push %1
  6050                              <2>  %elifidni %1, word fs
  6051                              <2>  o16 push %1
  6052                              <2>  %elifidni %1, word gs
  6053                              <2>  o16 push %1
  6054                              <2>  %else
  6055 000005E9 6650                <2>  push %1
  6056                              <2>  %endif
  6057                              <2> 
  6058                              <2>  %rotate -1
  6059                              <2> 
  6060                              <2> 
  6061                              <2> 
  6062                              <2> 
  6063                              <2> 
  6064                              <2> 
  6065                              <2> 
  6066                              <2>  %ifidni %1, cs
  6067                              <2>  o16 push %1
  6068                              <2>  %elifidni %1, ds
  6069                              <2>  o16 push %1
  6070                              <2>  %elifidni %1, es
  6071                              <2>  o16 push %1
  6072                              <2>  %elifidni %1, fs
  6073                              <2>  o16 push %1
  6074                              <2>  %elifidni %1, gs
  6075                              <2>  o16 push %1
  6076                              <2>  %elifidni %1, word cs
  6077                              <2>  o16 push %1
  6078                              <2>  %elifidni %1, word ds
  6079                              <2>  o16 push %1
  6080                              <2>  %elifidni %1, word es
  6081                              <2>  o16 push %1
  6082                              <2>  %elifidni %1, word fs
  6083                              <2>  o16 push %1
  6084                              <2>  %elifidni %1, word gs
  6085                              <2>  o16 push %1
  6086                              <2>  %else
  6087 000005EB 66FF750E            <2>  push %1
  6088                              <2>  %endif
  6089                              <2> 
  6090                              <2>  %rotate -1
  6091                              <2> 
  6092                              <2> 
  6093                              <2> 
  6094                              <2> 
  6095                              <2> 
  6096                              <2> 
  6097                              <2> 
  6098                              <2>  %ifidni %1, cs
  6099                              <2>  o16 push %1
  6100                              <2>  %elifidni %1, ds
  6101                              <2>  o16 push %1
  6102                              <2>  %elifidni %1, es
  6103                              <2>  o16 push %1
  6104                              <2>  %elifidni %1, fs
  6105                              <2>  o16 push %1
  6106                              <2>  %elifidni %1, gs
  6107                              <2>  o16 push %1
  6108                              <2>  %elifidni %1, word cs
  6109                              <2>  o16 push %1
  6110                              <2>  %elifidni %1, word ds
  6111                              <2>  o16 push %1
  6112                              <2>  %elifidni %1, word es
  6113                              <2>  o16 push %1
  6114                              <2>  %elifidni %1, word fs
  6115                              <2>  o16 push %1
  6116                              <2>  %elifidni %1, word gs
  6117                              <2>  o16 push %1
  6118                              <2>  %else
  6119 000005EF 66FF750C            <2>  push %1
  6120                              <2>  %endif
  6121                              <2> 
  6122                              <2>  %rotate -1
  6123                              <2> 
  6124                              <2> 
  6125                              <2> 
  6126                              <2> 
  6127                              <2> 
  6128                              <2> 
  6129                              <2> 
  6130                              <2>  %ifidni %1, cs
  6131                              <2>  o16 push %1
  6132                              <2>  %elifidni %1, ds
  6133                              <2>  o16 push %1
  6134                              <2>  %elifidni %1, es
  6135                              <2>  o16 push %1
  6136                              <2>  %elifidni %1, fs
  6137                              <2>  o16 push %1
  6138                              <2>  %elifidni %1, gs
  6139                              <2>  o16 push %1
  6140                              <2>  %elifidni %1, word cs
  6141                              <2>  o16 push %1
  6142                              <2>  %elifidni %1, word ds
  6143                              <2>  o16 push %1
  6144                              <2>  %elifidni %1, word es
  6145                              <2>  o16 push %1
  6146                              <2>  %elifidni %1, word fs
  6147                              <2>  o16 push %1
  6148                              <2>  %elifidni %1, word gs
  6149                              <2>  o16 push %1
  6150                              <2>  %else
  6151 000005F3 FF7508              <2>  push %1
  6152                              <2>  %endif
  6153                              <2> 
  6154                              <2>  %rotate -1
  6155 000005F6 E846FCFFFF          <1> call %1
  6156                              <1> %if (%0!=1)
  6157 000005FB 83C410              <1>  add esp, byte %1_arglen
  6158                              <1> %endif
  6159 000005FE 668B4510                	mov	ax, [.X + ebp]
  6160 00000602 660305[44000000]        	add	ax, [_ydist]		; x + ydist
  6161 00000609 668B5D12                	mov	bx, [.Y + ebp]
  6162 0000060D 66031D[42000000]        	add	bx, [_xdist]		; y + xdist
  6163                                  	invoke _DrawPixel, dword [.DestOff + ebp], word [.DestWidth + ebp], word [.DestHeight + ebp], ax, bx, dword [.Color + ebp]
  6164                              <1> %rotate -1
  6165                              <1> 
  6166                              <1> %rep (%0-1)
  6167                              <1> 
  6168                              <1> 
  6169                              <1> 
  6170                              <1> 
  6171                              <1> 
  6172                              <1> 
  6173                              <1> 
  6174                              <1>  %ifidni %1, cs
  6175                              <1>  o16 push %1
  6176                              <1>  %elifidni %1, ds
  6177                              <1>  o16 push %1
  6178                              <1>  %elifidni %1, es
  6179                              <1>  o16 push %1
  6180                              <1>  %elifidni %1, fs
  6181                              <1>  o16 push %1
  6182                              <1>  %elifidni %1, gs
  6183                              <1>  o16 push %1
  6184                              <1>  %elifidni %1, word cs
  6185                              <1>  o16 push %1
  6186                              <1>  %elifidni %1, word ds
  6187                              <1>  o16 push %1
  6188                              <1>  %elifidni %1, word es
  6189                              <1>  o16 push %1
  6190                              <1>  %elifidni %1, word fs
  6191                              <1>  o16 push %1
  6192                              <1>  %elifidni %1, word gs
  6193                              <1>  o16 push %1
  6194                              <1>  %else
  6195                              <1>  push %1
  6196                              <1>  %endif
  6197                              <1> 
  6198                              <1>  %rotate -1
  6199                              <1> %endrep
  6200                              <2> 
  6201                              <2> 
  6202                              <2> 
  6203                              <2> 
  6204                              <2> 
  6205                              <2> 
  6206                              <2> 
  6207                              <2>  %ifidni %1, cs
  6208                              <2>  o16 push %1
  6209                              <2>  %elifidni %1, ds
  6210                              <2>  o16 push %1
  6211                              <2>  %elifidni %1, es
  6212                              <2>  o16 push %1
  6213                              <2>  %elifidni %1, fs
  6214                              <2>  o16 push %1
  6215                              <2>  %elifidni %1, gs
  6216                              <2>  o16 push %1
  6217                              <2>  %elifidni %1, word cs
  6218                              <2>  o16 push %1
  6219                              <2>  %elifidni %1, word ds
  6220                              <2>  o16 push %1
  6221                              <2>  %elifidni %1, word es
  6222                              <2>  o16 push %1
  6223                              <2>  %elifidni %1, word fs
  6224                              <2>  o16 push %1
  6225                              <2>  %elifidni %1, word gs
  6226                              <2>  o16 push %1
  6227                              <2>  %else
  6228 00000614 FF7516              <2>  push %1
  6229                              <2>  %endif
  6230                              <2> 
  6231                              <2>  %rotate -1
  6232                              <2> 
  6233                              <2> 
  6234                              <2> 
  6235                              <2> 
  6236                              <2> 
  6237                              <2> 
  6238                              <2> 
  6239                              <2>  %ifidni %1, cs
  6240                              <2>  o16 push %1
  6241                              <2>  %elifidni %1, ds
  6242                              <2>  o16 push %1
  6243                              <2>  %elifidni %1, es
  6244                              <2>  o16 push %1
  6245                              <2>  %elifidni %1, fs
  6246                              <2>  o16 push %1
  6247                              <2>  %elifidni %1, gs
  6248                              <2>  o16 push %1
  6249                              <2>  %elifidni %1, word cs
  6250                              <2>  o16 push %1
  6251                              <2>  %elifidni %1, word ds
  6252                              <2>  o16 push %1
  6253                              <2>  %elifidni %1, word es
  6254                              <2>  o16 push %1
  6255                              <2>  %elifidni %1, word fs
  6256                              <2>  o16 push %1
  6257                              <2>  %elifidni %1, word gs
  6258                              <2>  o16 push %1
  6259                              <2>  %else
  6260 00000617 6653                <2>  push %1
  6261                              <2>  %endif
  6262                              <2> 
  6263                              <2>  %rotate -1
  6264                              <2> 
  6265                              <2> 
  6266                              <2> 
  6267                              <2> 
  6268                              <2> 
  6269                              <2> 
  6270                              <2> 
  6271                              <2>  %ifidni %1, cs
  6272                              <2>  o16 push %1
  6273                              <2>  %elifidni %1, ds
  6274                              <2>  o16 push %1
  6275                              <2>  %elifidni %1, es
  6276                              <2>  o16 push %1
  6277                              <2>  %elifidni %1, fs
  6278                              <2>  o16 push %1
  6279                              <2>  %elifidni %1, gs
  6280                              <2>  o16 push %1
  6281                              <2>  %elifidni %1, word cs
  6282                              <2>  o16 push %1
  6283                              <2>  %elifidni %1, word ds
  6284                              <2>  o16 push %1
  6285                              <2>  %elifidni %1, word es
  6286                              <2>  o16 push %1
  6287                              <2>  %elifidni %1, word fs
  6288                              <2>  o16 push %1
  6289                              <2>  %elifidni %1, word gs
  6290                              <2>  o16 push %1
  6291                              <2>  %else
  6292 00000619 6650                <2>  push %1
  6293                              <2>  %endif
  6294                              <2> 
  6295                              <2>  %rotate -1
  6296                              <2> 
  6297                              <2> 
  6298                              <2> 
  6299                              <2> 
  6300                              <2> 
  6301                              <2> 
  6302                              <2> 
  6303                              <2>  %ifidni %1, cs
  6304                              <2>  o16 push %1
  6305                              <2>  %elifidni %1, ds
  6306                              <2>  o16 push %1
  6307                              <2>  %elifidni %1, es
  6308                              <2>  o16 push %1
  6309                              <2>  %elifidni %1, fs
  6310                              <2>  o16 push %1
  6311                              <2>  %elifidni %1, gs
  6312                              <2>  o16 push %1
  6313                              <2>  %elifidni %1, word cs
  6314                              <2>  o16 push %1
  6315                              <2>  %elifidni %1, word ds
  6316                              <2>  o16 push %1
  6317                              <2>  %elifidni %1, word es
  6318                              <2>  o16 push %1
  6319                              <2>  %elifidni %1, word fs
  6320                              <2>  o16 push %1
  6321                              <2>  %elifidni %1, word gs
  6322                              <2>  o16 push %1
  6323                              <2>  %else
  6324 0000061B 66FF750E            <2>  push %1
  6325                              <2>  %endif
  6326                              <2> 
  6327                              <2>  %rotate -1
  6328                              <2> 
  6329                              <2> 
  6330                              <2> 
  6331                              <2> 
  6332                              <2> 
  6333                              <2> 
  6334                              <2> 
  6335                              <2>  %ifidni %1, cs
  6336                              <2>  o16 push %1
  6337                              <2>  %elifidni %1, ds
  6338                              <2>  o16 push %1
  6339                              <2>  %elifidni %1, es
  6340                              <2>  o16 push %1
  6341                              <2>  %elifidni %1, fs
  6342                              <2>  o16 push %1
  6343                              <2>  %elifidni %1, gs
  6344                              <2>  o16 push %1
  6345                              <2>  %elifidni %1, word cs
  6346                              <2>  o16 push %1
  6347                              <2>  %elifidni %1, word ds
  6348                              <2>  o16 push %1
  6349                              <2>  %elifidni %1, word es
  6350                              <2>  o16 push %1
  6351                              <2>  %elifidni %1, word fs
  6352                              <2>  o16 push %1
  6353                              <2>  %elifidni %1, word gs
  6354                              <2>  o16 push %1
  6355                              <2>  %else
  6356 0000061F 66FF750C            <2>  push %1
  6357                              <2>  %endif
  6358                              <2> 
  6359                              <2>  %rotate -1
  6360                              <2> 
  6361                              <2> 
  6362                              <2> 
  6363                              <2> 
  6364                              <2> 
  6365                              <2> 
  6366                              <2> 
  6367                              <2>  %ifidni %1, cs
  6368                              <2>  o16 push %1
  6369                              <2>  %elifidni %1, ds
  6370                              <2>  o16 push %1
  6371                              <2>  %elifidni %1, es
  6372                              <2>  o16 push %1
  6373                              <2>  %elifidni %1, fs
  6374                              <2>  o16 push %1
  6375                              <2>  %elifidni %1, gs
  6376                              <2>  o16 push %1
  6377                              <2>  %elifidni %1, word cs
  6378                              <2>  o16 push %1
  6379                              <2>  %elifidni %1, word ds
  6380                              <2>  o16 push %1
  6381                              <2>  %elifidni %1, word es
  6382                              <2>  o16 push %1
  6383                              <2>  %elifidni %1, word fs
  6384                              <2>  o16 push %1
  6385                              <2>  %elifidni %1, word gs
  6386                              <2>  o16 push %1
  6387                              <2>  %else
  6388 00000623 FF7508              <2>  push %1
  6389                              <2>  %endif
  6390                              <2> 
  6391                              <2>  %rotate -1
  6392 00000626 E816FCFFFF          <1> call %1
  6393                              <1> %if (%0!=1)
  6394 0000062B 83C410              <1>  add esp, byte %1_arglen
  6395                              <1> %endif
  6396 0000062E 668B4510                	mov	ax, [.X + ebp]
  6397 00000632 662B05[44000000]        	sub	ax, [_ydist]		; x - ydist
  6398 00000639 668B5D12                	mov	bx, [.Y + ebp]
  6399 0000063D 66031D[42000000]        	add	bx, [_xdist]		; y + xdist
  6400                                  	invoke _DrawPixel, dword [.DestOff + ebp], word [.DestWidth + ebp], word [.DestHeight + ebp], ax, bx, dword [.Color + ebp]
  6401                              <1> %rotate -1
  6402                              <1> 
  6403                              <1> %rep (%0-1)
  6404                              <1> 
  6405                              <1> 
  6406                              <1> 
  6407                              <1> 
  6408                              <1> 
  6409                              <1> 
  6410                              <1> 
  6411                              <1>  %ifidni %1, cs
  6412                              <1>  o16 push %1
  6413                              <1>  %elifidni %1, ds
  6414                              <1>  o16 push %1
  6415                              <1>  %elifidni %1, es
  6416                              <1>  o16 push %1
  6417                              <1>  %elifidni %1, fs
  6418                              <1>  o16 push %1
  6419                              <1>  %elifidni %1, gs
  6420                              <1>  o16 push %1
  6421                              <1>  %elifidni %1, word cs
  6422                              <1>  o16 push %1
  6423                              <1>  %elifidni %1, word ds
  6424                              <1>  o16 push %1
  6425                              <1>  %elifidni %1, word es
  6426                              <1>  o16 push %1
  6427                              <1>  %elifidni %1, word fs
  6428                              <1>  o16 push %1
  6429                              <1>  %elifidni %1, word gs
  6430                              <1>  o16 push %1
  6431                              <1>  %else
  6432                              <1>  push %1
  6433                              <1>  %endif
  6434                              <1> 
  6435                              <1>  %rotate -1
  6436                              <1> %endrep
  6437                              <2> 
  6438                              <2> 
  6439                              <2> 
  6440                              <2> 
  6441                              <2> 
  6442                              <2> 
  6443                              <2> 
  6444                              <2>  %ifidni %1, cs
  6445                              <2>  o16 push %1
  6446                              <2>  %elifidni %1, ds
  6447                              <2>  o16 push %1
  6448                              <2>  %elifidni %1, es
  6449                              <2>  o16 push %1
  6450                              <2>  %elifidni %1, fs
  6451                              <2>  o16 push %1
  6452                              <2>  %elifidni %1, gs
  6453                              <2>  o16 push %1
  6454                              <2>  %elifidni %1, word cs
  6455                              <2>  o16 push %1
  6456                              <2>  %elifidni %1, word ds
  6457                              <2>  o16 push %1
  6458                              <2>  %elifidni %1, word es
  6459                              <2>  o16 push %1
  6460                              <2>  %elifidni %1, word fs
  6461                              <2>  o16 push %1
  6462                              <2>  %elifidni %1, word gs
  6463                              <2>  o16 push %1
  6464                              <2>  %else
  6465 00000644 FF7516              <2>  push %1
  6466                              <2>  %endif
  6467                              <2> 
  6468                              <2>  %rotate -1
  6469                              <2> 
  6470                              <2> 
  6471                              <2> 
  6472                              <2> 
  6473                              <2> 
  6474                              <2> 
  6475                              <2> 
  6476                              <2>  %ifidni %1, cs
  6477                              <2>  o16 push %1
  6478                              <2>  %elifidni %1, ds
  6479                              <2>  o16 push %1
  6480                              <2>  %elifidni %1, es
  6481                              <2>  o16 push %1
  6482                              <2>  %elifidni %1, fs
  6483                              <2>  o16 push %1
  6484                              <2>  %elifidni %1, gs
  6485                              <2>  o16 push %1
  6486                              <2>  %elifidni %1, word cs
  6487                              <2>  o16 push %1
  6488                              <2>  %elifidni %1, word ds
  6489                              <2>  o16 push %1
  6490                              <2>  %elifidni %1, word es
  6491                              <2>  o16 push %1
  6492                              <2>  %elifidni %1, word fs
  6493                              <2>  o16 push %1
  6494                              <2>  %elifidni %1, word gs
  6495                              <2>  o16 push %1
  6496                              <2>  %else
  6497 00000647 6653                <2>  push %1
  6498                              <2>  %endif
  6499                              <2> 
  6500                              <2>  %rotate -1
  6501                              <2> 
  6502                              <2> 
  6503                              <2> 
  6504                              <2> 
  6505                              <2> 
  6506                              <2> 
  6507                              <2> 
  6508                              <2>  %ifidni %1, cs
  6509                              <2>  o16 push %1
  6510                              <2>  %elifidni %1, ds
  6511                              <2>  o16 push %1
  6512                              <2>  %elifidni %1, es
  6513                              <2>  o16 push %1
  6514                              <2>  %elifidni %1, fs
  6515                              <2>  o16 push %1
  6516                              <2>  %elifidni %1, gs
  6517                              <2>  o16 push %1
  6518                              <2>  %elifidni %1, word cs
  6519                              <2>  o16 push %1
  6520                              <2>  %elifidni %1, word ds
  6521                              <2>  o16 push %1
  6522                              <2>  %elifidni %1, word es
  6523                              <2>  o16 push %1
  6524                              <2>  %elifidni %1, word fs
  6525                              <2>  o16 push %1
  6526                              <2>  %elifidni %1, word gs
  6527                              <2>  o16 push %1
  6528                              <2>  %else
  6529 00000649 6650                <2>  push %1
  6530                              <2>  %endif
  6531                              <2> 
  6532                              <2>  %rotate -1
  6533                              <2> 
  6534                              <2> 
  6535                              <2> 
  6536                              <2> 
  6537                              <2> 
  6538                              <2> 
  6539                              <2> 
  6540                              <2>  %ifidni %1, cs
  6541                              <2>  o16 push %1
  6542                              <2>  %elifidni %1, ds
  6543                              <2>  o16 push %1
  6544                              <2>  %elifidni %1, es
  6545                              <2>  o16 push %1
  6546                              <2>  %elifidni %1, fs
  6547                              <2>  o16 push %1
  6548                              <2>  %elifidni %1, gs
  6549                              <2>  o16 push %1
  6550                              <2>  %elifidni %1, word cs
  6551                              <2>  o16 push %1
  6552                              <2>  %elifidni %1, word ds
  6553                              <2>  o16 push %1
  6554                              <2>  %elifidni %1, word es
  6555                              <2>  o16 push %1
  6556                              <2>  %elifidni %1, word fs
  6557                              <2>  o16 push %1
  6558                              <2>  %elifidni %1, word gs
  6559                              <2>  o16 push %1
  6560                              <2>  %else
  6561 0000064B 66FF750E            <2>  push %1
  6562                              <2>  %endif
  6563                              <2> 
  6564                              <2>  %rotate -1
  6565                              <2> 
  6566                              <2> 
  6567                              <2> 
  6568                              <2> 
  6569                              <2> 
  6570                              <2> 
  6571                              <2> 
  6572                              <2>  %ifidni %1, cs
  6573                              <2>  o16 push %1
  6574                              <2>  %elifidni %1, ds
  6575                              <2>  o16 push %1
  6576                              <2>  %elifidni %1, es
  6577                              <2>  o16 push %1
  6578                              <2>  %elifidni %1, fs
  6579                              <2>  o16 push %1
  6580                              <2>  %elifidni %1, gs
  6581                              <2>  o16 push %1
  6582                              <2>  %elifidni %1, word cs
  6583                              <2>  o16 push %1
  6584                              <2>  %elifidni %1, word ds
  6585                              <2>  o16 push %1
  6586                              <2>  %elifidni %1, word es
  6587                              <2>  o16 push %1
  6588                              <2>  %elifidni %1, word fs
  6589                              <2>  o16 push %1
  6590                              <2>  %elifidni %1, word gs
  6591                              <2>  o16 push %1
  6592                              <2>  %else
  6593 0000064F 66FF750C            <2>  push %1
  6594                              <2>  %endif
  6595                              <2> 
  6596                              <2>  %rotate -1
  6597                              <2> 
  6598                              <2> 
  6599                              <2> 
  6600                              <2> 
  6601                              <2> 
  6602                              <2> 
  6603                              <2> 
  6604                              <2>  %ifidni %1, cs
  6605                              <2>  o16 push %1
  6606                              <2>  %elifidni %1, ds
  6607                              <2>  o16 push %1
  6608                              <2>  %elifidni %1, es
  6609                              <2>  o16 push %1
  6610                              <2>  %elifidni %1, fs
  6611                              <2>  o16 push %1
  6612                              <2>  %elifidni %1, gs
  6613                              <2>  o16 push %1
  6614                              <2>  %elifidni %1, word cs
  6615                              <2>  o16 push %1
  6616                              <2>  %elifidni %1, word ds
  6617                              <2>  o16 push %1
  6618                              <2>  %elifidni %1, word es
  6619                              <2>  o16 push %1
  6620                              <2>  %elifidni %1, word fs
  6621                              <2>  o16 push %1
  6622                              <2>  %elifidni %1, word gs
  6623                              <2>  o16 push %1
  6624                              <2>  %else
  6625 00000653 FF7508              <2>  push %1
  6626                              <2>  %endif
  6627                              <2> 
  6628                              <2>  %rotate -1
  6629 00000656 E8E6FBFFFF          <1> call %1
  6630                              <1> %if (%0!=1)
  6631 0000065B 83C410              <1>  add esp, byte %1_arglen
  6632                              <1> %endif
  6633 0000065E 668B4510                	mov	ax, [.X + ebp]
  6634 00000662 660305[44000000]        	add	ax, [_ydist]		; x + ydist
  6635 00000669 668B5D12                	mov	bx, [.Y + ebp]
  6636 0000066D 662B1D[42000000]        	sub	bx, [_xdist]		; y - xdist
  6637                                  	invoke _DrawPixel, dword [.DestOff + ebp], word [.DestWidth + ebp], word [.DestHeight + ebp], ax, bx, dword [.Color + ebp]
  6638                              <1> %rotate -1
  6639                              <1> 
  6640                              <1> %rep (%0-1)
  6641                              <1> 
  6642                              <1> 
  6643                              <1> 
  6644                              <1> 
  6645                              <1> 
  6646                              <1> 
  6647                              <1> 
  6648                              <1>  %ifidni %1, cs
  6649                              <1>  o16 push %1
  6650                              <1>  %elifidni %1, ds
  6651                              <1>  o16 push %1
  6652                              <1>  %elifidni %1, es
  6653                              <1>  o16 push %1
  6654                              <1>  %elifidni %1, fs
  6655                              <1>  o16 push %1
  6656                              <1>  %elifidni %1, gs
  6657                              <1>  o16 push %1
  6658                              <1>  %elifidni %1, word cs
  6659                              <1>  o16 push %1
  6660                              <1>  %elifidni %1, word ds
  6661                              <1>  o16 push %1
  6662                              <1>  %elifidni %1, word es
  6663                              <1>  o16 push %1
  6664                              <1>  %elifidni %1, word fs
  6665                              <1>  o16 push %1
  6666                              <1>  %elifidni %1, word gs
  6667                              <1>  o16 push %1
  6668                              <1>  %else
  6669                              <1>  push %1
  6670                              <1>  %endif
  6671                              <1> 
  6672                              <1>  %rotate -1
  6673                              <1> %endrep
  6674                              <2> 
  6675                              <2> 
  6676                              <2> 
  6677                              <2> 
  6678                              <2> 
  6679                              <2> 
  6680                              <2> 
  6681                              <2>  %ifidni %1, cs
  6682                              <2>  o16 push %1
  6683                              <2>  %elifidni %1, ds
  6684                              <2>  o16 push %1
  6685                              <2>  %elifidni %1, es
  6686                              <2>  o16 push %1
  6687                              <2>  %elifidni %1, fs
  6688                              <2>  o16 push %1
  6689                              <2>  %elifidni %1, gs
  6690                              <2>  o16 push %1
  6691                              <2>  %elifidni %1, word cs
  6692                              <2>  o16 push %1
  6693                              <2>  %elifidni %1, word ds
  6694                              <2>  o16 push %1
  6695                              <2>  %elifidni %1, word es
  6696                              <2>  o16 push %1
  6697                              <2>  %elifidni %1, word fs
  6698                              <2>  o16 push %1
  6699                              <2>  %elifidni %1, word gs
  6700                              <2>  o16 push %1
  6701                              <2>  %else
  6702 00000674 FF7516              <2>  push %1
  6703                              <2>  %endif
  6704                              <2> 
  6705                              <2>  %rotate -1
  6706                              <2> 
  6707                              <2> 
  6708                              <2> 
  6709                              <2> 
  6710                              <2> 
  6711                              <2> 
  6712                              <2> 
  6713                              <2>  %ifidni %1, cs
  6714                              <2>  o16 push %1
  6715                              <2>  %elifidni %1, ds
  6716                              <2>  o16 push %1
  6717                              <2>  %elifidni %1, es
  6718                              <2>  o16 push %1
  6719                              <2>  %elifidni %1, fs
  6720                              <2>  o16 push %1
  6721                              <2>  %elifidni %1, gs
  6722                              <2>  o16 push %1
  6723                              <2>  %elifidni %1, word cs
  6724                              <2>  o16 push %1
  6725                              <2>  %elifidni %1, word ds
  6726                              <2>  o16 push %1
  6727                              <2>  %elifidni %1, word es
  6728                              <2>  o16 push %1
  6729                              <2>  %elifidni %1, word fs
  6730                              <2>  o16 push %1
  6731                              <2>  %elifidni %1, word gs
  6732                              <2>  o16 push %1
  6733                              <2>  %else
  6734 00000677 6653                <2>  push %1
  6735                              <2>  %endif
  6736                              <2> 
  6737                              <2>  %rotate -1
  6738                              <2> 
  6739                              <2> 
  6740                              <2> 
  6741                              <2> 
  6742                              <2> 
  6743                              <2> 
  6744                              <2> 
  6745                              <2>  %ifidni %1, cs
  6746                              <2>  o16 push %1
  6747                              <2>  %elifidni %1, ds
  6748                              <2>  o16 push %1
  6749                              <2>  %elifidni %1, es
  6750                              <2>  o16 push %1
  6751                              <2>  %elifidni %1, fs
  6752                              <2>  o16 push %1
  6753                              <2>  %elifidni %1, gs
  6754                              <2>  o16 push %1
  6755                              <2>  %elifidni %1, word cs
  6756                              <2>  o16 push %1
  6757                              <2>  %elifidni %1, word ds
  6758                              <2>  o16 push %1
  6759                              <2>  %elifidni %1, word es
  6760                              <2>  o16 push %1
  6761                              <2>  %elifidni %1, word fs
  6762                              <2>  o16 push %1
  6763                              <2>  %elifidni %1, word gs
  6764                              <2>  o16 push %1
  6765                              <2>  %else
  6766 00000679 6650                <2>  push %1
  6767                              <2>  %endif
  6768                              <2> 
  6769                              <2>  %rotate -1
  6770                              <2> 
  6771                              <2> 
  6772                              <2> 
  6773                              <2> 
  6774                              <2> 
  6775                              <2> 
  6776                              <2> 
  6777                              <2>  %ifidni %1, cs
  6778                              <2>  o16 push %1
  6779                              <2>  %elifidni %1, ds
  6780                              <2>  o16 push %1
  6781                              <2>  %elifidni %1, es
  6782                              <2>  o16 push %1
  6783                              <2>  %elifidni %1, fs
  6784                              <2>  o16 push %1
  6785                              <2>  %elifidni %1, gs
  6786                              <2>  o16 push %1
  6787                              <2>  %elifidni %1, word cs
  6788                              <2>  o16 push %1
  6789                              <2>  %elifidni %1, word ds
  6790                              <2>  o16 push %1
  6791                              <2>  %elifidni %1, word es
  6792                              <2>  o16 push %1
  6793                              <2>  %elifidni %1, word fs
  6794                              <2>  o16 push %1
  6795                              <2>  %elifidni %1, word gs
  6796                              <2>  o16 push %1
  6797                              <2>  %else
  6798 0000067B 66FF750E            <2>  push %1
  6799                              <2>  %endif
  6800                              <2> 
  6801                              <2>  %rotate -1
  6802                              <2> 
  6803                              <2> 
  6804                              <2> 
  6805                              <2> 
  6806                              <2> 
  6807                              <2> 
  6808                              <2> 
  6809                              <2>  %ifidni %1, cs
  6810                              <2>  o16 push %1
  6811                              <2>  %elifidni %1, ds
  6812                              <2>  o16 push %1
  6813                              <2>  %elifidni %1, es
  6814                              <2>  o16 push %1
  6815                              <2>  %elifidni %1, fs
  6816                              <2>  o16 push %1
  6817                              <2>  %elifidni %1, gs
  6818                              <2>  o16 push %1
  6819                              <2>  %elifidni %1, word cs
  6820                              <2>  o16 push %1
  6821                              <2>  %elifidni %1, word ds
  6822                              <2>  o16 push %1
  6823                              <2>  %elifidni %1, word es
  6824                              <2>  o16 push %1
  6825                              <2>  %elifidni %1, word fs
  6826                              <2>  o16 push %1
  6827                              <2>  %elifidni %1, word gs
  6828                              <2>  o16 push %1
  6829                              <2>  %else
  6830 0000067F 66FF750C            <2>  push %1
  6831                              <2>  %endif
  6832                              <2> 
  6833                              <2>  %rotate -1
  6834                              <2> 
  6835                              <2> 
  6836                              <2> 
  6837                              <2> 
  6838                              <2> 
  6839                              <2> 
  6840                              <2> 
  6841                              <2>  %ifidni %1, cs
  6842                              <2>  o16 push %1
  6843                              <2>  %elifidni %1, ds
  6844                              <2>  o16 push %1
  6845                              <2>  %elifidni %1, es
  6846                              <2>  o16 push %1
  6847                              <2>  %elifidni %1, fs
  6848                              <2>  o16 push %1
  6849                              <2>  %elifidni %1, gs
  6850                              <2>  o16 push %1
  6851                              <2>  %elifidni %1, word cs
  6852                              <2>  o16 push %1
  6853                              <2>  %elifidni %1, word ds
  6854                              <2>  o16 push %1
  6855                              <2>  %elifidni %1, word es
  6856                              <2>  o16 push %1
  6857                              <2>  %elifidni %1, word fs
  6858                              <2>  o16 push %1
  6859                              <2>  %elifidni %1, word gs
  6860                              <2>  o16 push %1
  6861                              <2>  %else
  6862 00000683 FF7508              <2>  push %1
  6863                              <2>  %endif
  6864                              <2> 
  6865                              <2>  %rotate -1
  6866 00000686 E8B6FBFFFF          <1> call %1
  6867                              <1> %if (%0!=1)
  6868 0000068B 83C410              <1>  add esp, byte %1_arglen
  6869                              <1> %endif
  6870 0000068E 668B4510                	mov	ax, [.X + ebp]
  6871 00000692 662B05[44000000]        	sub	ax, [_ydist]		; x - ydist
  6872 00000699 668B5D12                	mov	bx, [.Y + ebp]
  6873 0000069D 662B1D[42000000]        	sub	bx, [_xdist]		; y - xdist
  6874                                  	invoke _DrawPixel, dword [.DestOff + ebp], word [.DestWidth + ebp], word [.DestHeight + ebp], ax, bx, dword [.Color + ebp]
  6875                              <1> %rotate -1
  6876                              <1> 
  6877                              <1> %rep (%0-1)
  6878                              <1> 
  6879                              <1> 
  6880                              <1> 
  6881                              <1> 
  6882                              <1> 
  6883                              <1> 
  6884                              <1> 
  6885                              <1>  %ifidni %1, cs
  6886                              <1>  o16 push %1
  6887                              <1>  %elifidni %1, ds
  6888                              <1>  o16 push %1
  6889                              <1>  %elifidni %1, es
  6890                              <1>  o16 push %1
  6891                              <1>  %elifidni %1, fs
  6892                              <1>  o16 push %1
  6893                              <1>  %elifidni %1, gs
  6894                              <1>  o16 push %1
  6895                              <1>  %elifidni %1, word cs
  6896                              <1>  o16 push %1
  6897                              <1>  %elifidni %1, word ds
  6898                              <1>  o16 push %1
  6899                              <1>  %elifidni %1, word es
  6900                              <1>  o16 push %1
  6901                              <1>  %elifidni %1, word fs
  6902                              <1>  o16 push %1
  6903                              <1>  %elifidni %1, word gs
  6904                              <1>  o16 push %1
  6905                              <1>  %else
  6906                              <1>  push %1
  6907                              <1>  %endif
  6908                              <1> 
  6909                              <1>  %rotate -1
  6910                              <1> %endrep
  6911                              <2> 
  6912                              <2> 
  6913                              <2> 
  6914                              <2> 
  6915                              <2> 
  6916                              <2> 
  6917                              <2> 
  6918                              <2>  %ifidni %1, cs
  6919                              <2>  o16 push %1
  6920                              <2>  %elifidni %1, ds
  6921                              <2>  o16 push %1
  6922                              <2>  %elifidni %1, es
  6923                              <2>  o16 push %1
  6924                              <2>  %elifidni %1, fs
  6925                              <2>  o16 push %1
  6926                              <2>  %elifidni %1, gs
  6927                              <2>  o16 push %1
  6928                              <2>  %elifidni %1, word cs
  6929                              <2>  o16 push %1
  6930                              <2>  %elifidni %1, word ds
  6931                              <2>  o16 push %1
  6932                              <2>  %elifidni %1, word es
  6933                              <2>  o16 push %1
  6934                              <2>  %elifidni %1, word fs
  6935                              <2>  o16 push %1
  6936                              <2>  %elifidni %1, word gs
  6937                              <2>  o16 push %1
  6938                              <2>  %else
  6939 000006A4 FF7516              <2>  push %1
  6940                              <2>  %endif
  6941                              <2> 
  6942                              <2>  %rotate -1
  6943                              <2> 
  6944                              <2> 
  6945                              <2> 
  6946                              <2> 
  6947                              <2> 
  6948                              <2> 
  6949                              <2> 
  6950                              <2>  %ifidni %1, cs
  6951                              <2>  o16 push %1
  6952                              <2>  %elifidni %1, ds
  6953                              <2>  o16 push %1
  6954                              <2>  %elifidni %1, es
  6955                              <2>  o16 push %1
  6956                              <2>  %elifidni %1, fs
  6957                              <2>  o16 push %1
  6958                              <2>  %elifidni %1, gs
  6959                              <2>  o16 push %1
  6960                              <2>  %elifidni %1, word cs
  6961                              <2>  o16 push %1
  6962                              <2>  %elifidni %1, word ds
  6963                              <2>  o16 push %1
  6964                              <2>  %elifidni %1, word es
  6965                              <2>  o16 push %1
  6966                              <2>  %elifidni %1, word fs
  6967                              <2>  o16 push %1
  6968                              <2>  %elifidni %1, word gs
  6969                              <2>  o16 push %1
  6970                              <2>  %else
  6971 000006A7 6653                <2>  push %1
  6972                              <2>  %endif
  6973                              <2> 
  6974                              <2>  %rotate -1
  6975                              <2> 
  6976                              <2> 
  6977                              <2> 
  6978                              <2> 
  6979                              <2> 
  6980                              <2> 
  6981                              <2> 
  6982                              <2>  %ifidni %1, cs
  6983                              <2>  o16 push %1
  6984                              <2>  %elifidni %1, ds
  6985                              <2>  o16 push %1
  6986                              <2>  %elifidni %1, es
  6987                              <2>  o16 push %1
  6988                              <2>  %elifidni %1, fs
  6989                              <2>  o16 push %1
  6990                              <2>  %elifidni %1, gs
  6991                              <2>  o16 push %1
  6992                              <2>  %elifidni %1, word cs
  6993                              <2>  o16 push %1
  6994                              <2>  %elifidni %1, word ds
  6995                              <2>  o16 push %1
  6996                              <2>  %elifidni %1, word es
  6997                              <2>  o16 push %1
  6998                              <2>  %elifidni %1, word fs
  6999                              <2>  o16 push %1
  7000                              <2>  %elifidni %1, word gs
  7001                              <2>  o16 push %1
  7002                              <2>  %else
  7003 000006A9 6650                <2>  push %1
  7004                              <2>  %endif
  7005                              <2> 
  7006                              <2>  %rotate -1
  7007                              <2> 
  7008                              <2> 
  7009                              <2> 
  7010                              <2> 
  7011                              <2> 
  7012                              <2> 
  7013                              <2> 
  7014                              <2>  %ifidni %1, cs
  7015                              <2>  o16 push %1
  7016                              <2>  %elifidni %1, ds
  7017                              <2>  o16 push %1
  7018                              <2>  %elifidni %1, es
  7019                              <2>  o16 push %1
  7020                              <2>  %elifidni %1, fs
  7021                              <2>  o16 push %1
  7022                              <2>  %elifidni %1, gs
  7023                              <2>  o16 push %1
  7024                              <2>  %elifidni %1, word cs
  7025                              <2>  o16 push %1
  7026                              <2>  %elifidni %1, word ds
  7027                              <2>  o16 push %1
  7028                              <2>  %elifidni %1, word es
  7029                              <2>  o16 push %1
  7030                              <2>  %elifidni %1, word fs
  7031                              <2>  o16 push %1
  7032                              <2>  %elifidni %1, word gs
  7033                              <2>  o16 push %1
  7034                              <2>  %else
  7035 000006AB 66FF750E            <2>  push %1
  7036                              <2>  %endif
  7037                              <2> 
  7038                              <2>  %rotate -1
  7039                              <2> 
  7040                              <2> 
  7041                              <2> 
  7042                              <2> 
  7043                              <2> 
  7044                              <2> 
  7045                              <2> 
  7046                              <2>  %ifidni %1, cs
  7047                              <2>  o16 push %1
  7048                              <2>  %elifidni %1, ds
  7049                              <2>  o16 push %1
  7050                              <2>  %elifidni %1, es
  7051                              <2>  o16 push %1
  7052                              <2>  %elifidni %1, fs
  7053                              <2>  o16 push %1
  7054                              <2>  %elifidni %1, gs
  7055                              <2>  o16 push %1
  7056                              <2>  %elifidni %1, word cs
  7057                              <2>  o16 push %1
  7058                              <2>  %elifidni %1, word ds
  7059                              <2>  o16 push %1
  7060                              <2>  %elifidni %1, word es
  7061                              <2>  o16 push %1
  7062                              <2>  %elifidni %1, word fs
  7063                              <2>  o16 push %1
  7064                              <2>  %elifidni %1, word gs
  7065                              <2>  o16 push %1
  7066                              <2>  %else
  7067 000006AF 66FF750C            <2>  push %1
  7068                              <2>  %endif
  7069                              <2> 
  7070                              <2>  %rotate -1
  7071                              <2> 
  7072                              <2> 
  7073                              <2> 
  7074                              <2> 
  7075                              <2> 
  7076                              <2> 
  7077                              <2> 
  7078                              <2>  %ifidni %1, cs
  7079                              <2>  o16 push %1
  7080                              <2>  %elifidni %1, ds
  7081                              <2>  o16 push %1
  7082                              <2>  %elifidni %1, es
  7083                              <2>  o16 push %1
  7084                              <2>  %elifidni %1, fs
  7085                              <2>  o16 push %1
  7086                              <2>  %elifidni %1, gs
  7087                              <2>  o16 push %1
  7088                              <2>  %elifidni %1, word cs
  7089                              <2>  o16 push %1
  7090                              <2>  %elifidni %1, word ds
  7091                              <2>  o16 push %1
  7092                              <2>  %elifidni %1, word es
  7093                              <2>  o16 push %1
  7094                              <2>  %elifidni %1, word fs
  7095                              <2>  o16 push %1
  7096                              <2>  %elifidni %1, word gs
  7097                              <2>  o16 push %1
  7098                              <2>  %else
  7099 000006B3 FF7508              <2>  push %1
  7100                              <2>  %endif
  7101                              <2> 
  7102                              <2>  %rotate -1
  7103 000006B6 E886FBFFFF          <1> call %1
  7104                              <1> %if (%0!=1)
  7105 000006BB 83C410              <1>  add esp, byte %1_arglen
  7106                              <1> %endif
  7107                                  
  7108 000006BE 66FF05[42000000]        	inc	word [_xdist]
  7109                                  
  7110 000006C5 66813D[40000000]00-     	cmp	word [_circleerror], 0
  7111 000006CD 00                 
  7112 000006CE 7D17                    	jge	.circleerrorPositive
  7113 000006D0 66A1[42000000]          	mov	ax, [_xdist]
  7114 000006D6 66D1E0                  	shl	ax, 1			;
  7115 000006D9 6640                    	inc	ax			;
  7116 000006DB 660105[40000000]        	add	[_circleerror], ax	; _circleerror = (2 * _xdist) + 1
  7117 000006E2 E944FEFFFF              	jmp	.loopDrawCircle
  7118                                  
  7119                                  .circleerrorPositive
  7120 000006E7 66FF0D[44000000]        	dec	word [_ydist]
  7121 000006EE 66A1[42000000]          	mov	ax, [_xdist]
  7122 000006F4 662B05[44000000]        	sub	ax, [_ydist]
  7123 000006FB 66D1E0                  	shl	ax, 1			;
  7124 000006FE 6640                    	inc	ax			;
  7125 00000700 660105[40000000]        	add	[_circleerror], ax	; _circleerror = 2 * (_xdist - _ydist) + 1
  7126 00000707 E91FFEFFFF              	jmp	.loopDrawCircle
  7127                                  
  7128                                  .fillCircle
  7129 0000070C 817D1A00000000          	cmp	dword [.FillCircleFlag + ebp], 0
  7130 00000713 7423                    	je	.done
  7131                                  	invoke	_FloodFill, dword [.DestOff + ebp], word [.DestWidth + ebp], word [.DestHeight + ebp], word [.X + ebp], word [.Y + ebp], dword [.Color + ebp], dword 0
  7132                              <1> %rotate -1
  7133                              <1> 
  7134                              <1> %rep (%0-1)
  7135                              <1> 
  7136                              <1> 
  7137                              <1> 
  7138                              <1> 
  7139                              <1> 
  7140                              <1> 
  7141                              <1> 
  7142                              <1>  %ifidni %1, cs
  7143                              <1>  o16 push %1
  7144                              <1>  %elifidni %1, ds
  7145                              <1>  o16 push %1
  7146                              <1>  %elifidni %1, es
  7147                              <1>  o16 push %1
  7148                              <1>  %elifidni %1, fs
  7149                              <1>  o16 push %1
  7150                              <1>  %elifidni %1, gs
  7151                              <1>  o16 push %1
  7152                              <1>  %elifidni %1, word cs
  7153                              <1>  o16 push %1
  7154                              <1>  %elifidni %1, word ds
  7155                              <1>  o16 push %1
  7156                              <1>  %elifidni %1, word es
  7157                              <1>  o16 push %1
  7158                              <1>  %elifidni %1, word fs
  7159                              <1>  o16 push %1
  7160                              <1>  %elifidni %1, word gs
  7161                              <1>  o16 push %1
  7162                              <1>  %else
  7163                              <1>  push %1
  7164                              <1>  %endif
  7165                              <1> 
  7166                              <1>  %rotate -1
  7167                              <1> %endrep
  7168                              <2> 
  7169                              <2> 
  7170                              <2> 
  7171                              <2> 
  7172                              <2> 
  7173                              <2> 
  7174                              <2> 
  7175                              <2>  %ifidni %1, cs
  7176                              <2>  o16 push %1
  7177                              <2>  %elifidni %1, ds
  7178                              <2>  o16 push %1
  7179                              <2>  %elifidni %1, es
  7180                              <2>  o16 push %1
  7181                              <2>  %elifidni %1, fs
  7182                              <2>  o16 push %1
  7183                              <2>  %elifidni %1, gs
  7184                              <2>  o16 push %1
  7185                              <2>  %elifidni %1, word cs
  7186                              <2>  o16 push %1
  7187                              <2>  %elifidni %1, word ds
  7188                              <2>  o16 push %1
  7189                              <2>  %elifidni %1, word es
  7190                              <2>  o16 push %1
  7191                              <2>  %elifidni %1, word fs
  7192                              <2>  o16 push %1
  7193                              <2>  %elifidni %1, word gs
  7194                              <2>  o16 push %1
  7195                              <2>  %else
  7196 00000715 6800000000          <2>  push %1
  7197                              <2>  %endif
  7198                              <2> 
  7199                              <2>  %rotate -1
  7200                              <2> 
  7201                              <2> 
  7202                              <2> 
  7203                              <2> 
  7204                              <2> 
  7205                              <2> 
  7206                              <2> 
  7207                              <2>  %ifidni %1, cs
  7208                              <2>  o16 push %1
  7209                              <2>  %elifidni %1, ds
  7210                              <2>  o16 push %1
  7211                              <2>  %elifidni %1, es
  7212                              <2>  o16 push %1
  7213                              <2>  %elifidni %1, fs
  7214                              <2>  o16 push %1
  7215                              <2>  %elifidni %1, gs
  7216                              <2>  o16 push %1
  7217                              <2>  %elifidni %1, word cs
  7218                              <2>  o16 push %1
  7219                              <2>  %elifidni %1, word ds
  7220                              <2>  o16 push %1
  7221                              <2>  %elifidni %1, word es
  7222                              <2>  o16 push %1
  7223                              <2>  %elifidni %1, word fs
  7224                              <2>  o16 push %1
  7225                              <2>  %elifidni %1, word gs
  7226                              <2>  o16 push %1
  7227                              <2>  %else
  7228 0000071A FF7516              <2>  push %1
  7229                              <2>  %endif
  7230                              <2> 
  7231                              <2>  %rotate -1
  7232                              <2> 
  7233                              <2> 
  7234                              <2> 
  7235                              <2> 
  7236                              <2> 
  7237                              <2> 
  7238                              <2> 
  7239                              <2>  %ifidni %1, cs
  7240                              <2>  o16 push %1
  7241                              <2>  %elifidni %1, ds
  7242                              <2>  o16 push %1
  7243                              <2>  %elifidni %1, es
  7244                              <2>  o16 push %1
  7245                              <2>  %elifidni %1, fs
  7246                              <2>  o16 push %1
  7247                              <2>  %elifidni %1, gs
  7248                              <2>  o16 push %1
  7249                              <2>  %elifidni %1, word cs
  7250                              <2>  o16 push %1
  7251                              <2>  %elifidni %1, word ds
  7252                              <2>  o16 push %1
  7253                              <2>  %elifidni %1, word es
  7254                              <2>  o16 push %1
  7255                              <2>  %elifidni %1, word fs
  7256                              <2>  o16 push %1
  7257                              <2>  %elifidni %1, word gs
  7258                              <2>  o16 push %1
  7259                              <2>  %else
  7260 0000071D 66FF7512            <2>  push %1
  7261                              <2>  %endif
  7262                              <2> 
  7263                              <2>  %rotate -1
  7264                              <2> 
  7265                              <2> 
  7266                              <2> 
  7267                              <2> 
  7268                              <2> 
  7269                              <2> 
  7270                              <2> 
  7271                              <2>  %ifidni %1, cs
  7272                              <2>  o16 push %1
  7273                              <2>  %elifidni %1, ds
  7274                              <2>  o16 push %1
  7275                              <2>  %elifidni %1, es
  7276                              <2>  o16 push %1
  7277                              <2>  %elifidni %1, fs
  7278                              <2>  o16 push %1
  7279                              <2>  %elifidni %1, gs
  7280                              <2>  o16 push %1
  7281                              <2>  %elifidni %1, word cs
  7282                              <2>  o16 push %1
  7283                              <2>  %elifidni %1, word ds
  7284                              <2>  o16 push %1
  7285                              <2>  %elifidni %1, word es
  7286                              <2>  o16 push %1
  7287                              <2>  %elifidni %1, word fs
  7288                              <2>  o16 push %1
  7289                              <2>  %elifidni %1, word gs
  7290                              <2>  o16 push %1
  7291                              <2>  %else
  7292 00000721 66FF7510            <2>  push %1
  7293                              <2>  %endif
  7294                              <2> 
  7295                              <2>  %rotate -1
  7296                              <2> 
  7297                              <2> 
  7298                              <2> 
  7299                              <2> 
  7300                              <2> 
  7301                              <2> 
  7302                              <2> 
  7303                              <2>  %ifidni %1, cs
  7304                              <2>  o16 push %1
  7305                              <2>  %elifidni %1, ds
  7306                              <2>  o16 push %1
  7307                              <2>  %elifidni %1, es
  7308                              <2>  o16 push %1
  7309                              <2>  %elifidni %1, fs
  7310                              <2>  o16 push %1
  7311                              <2>  %elifidni %1, gs
  7312                              <2>  o16 push %1
  7313                              <2>  %elifidni %1, word cs
  7314                              <2>  o16 push %1
  7315                              <2>  %elifidni %1, word ds
  7316                              <2>  o16 push %1
  7317                              <2>  %elifidni %1, word es
  7318                              <2>  o16 push %1
  7319                              <2>  %elifidni %1, word fs
  7320                              <2>  o16 push %1
  7321                              <2>  %elifidni %1, word gs
  7322                              <2>  o16 push %1
  7323                              <2>  %else
  7324 00000725 66FF750E            <2>  push %1
  7325                              <2>  %endif
  7326                              <2> 
  7327                              <2>  %rotate -1
  7328                              <2> 
  7329                              <2> 
  7330                              <2> 
  7331                              <2> 
  7332                              <2> 
  7333                              <2> 
  7334                              <2> 
  7335                              <2>  %ifidni %1, cs
  7336                              <2>  o16 push %1
  7337                              <2>  %elifidni %1, ds
  7338                              <2>  o16 push %1
  7339                              <2>  %elifidni %1, es
  7340                              <2>  o16 push %1
  7341                              <2>  %elifidni %1, fs
  7342                              <2>  o16 push %1
  7343                              <2>  %elifidni %1, gs
  7344                              <2>  o16 push %1
  7345                              <2>  %elifidni %1, word cs
  7346                              <2>  o16 push %1
  7347                              <2>  %elifidni %1, word ds
  7348                              <2>  o16 push %1
  7349                              <2>  %elifidni %1, word es
  7350                              <2>  o16 push %1
  7351                              <2>  %elifidni %1, word fs
  7352                              <2>  o16 push %1
  7353                              <2>  %elifidni %1, word gs
  7354                              <2>  o16 push %1
  7355                              <2>  %else
  7356 00000729 66FF750C            <2>  push %1
  7357                              <2>  %endif
  7358                              <2> 
  7359                              <2>  %rotate -1
  7360                              <2> 
  7361                              <2> 
  7362                              <2> 
  7363                              <2> 
  7364                              <2> 
  7365                              <2> 
  7366                              <2> 
  7367                              <2>  %ifidni %1, cs
  7368                              <2>  o16 push %1
  7369                              <2>  %elifidni %1, ds
  7370                              <2>  o16 push %1
  7371                              <2>  %elifidni %1, es
  7372                              <2>  o16 push %1
  7373                              <2>  %elifidni %1, fs
  7374                              <2>  o16 push %1
  7375                              <2>  %elifidni %1, gs
  7376                              <2>  o16 push %1
  7377                              <2>  %elifidni %1, word cs
  7378                              <2>  o16 push %1
  7379                              <2>  %elifidni %1, word ds
  7380                              <2>  o16 push %1
  7381                              <2>  %elifidni %1, word es
  7382                              <2>  o16 push %1
  7383                              <2>  %elifidni %1, word fs
  7384                              <2>  o16 push %1
  7385                              <2>  %elifidni %1, word gs
  7386                              <2>  o16 push %1
  7387                              <2>  %else
  7388 0000072D FF7508              <2>  push %1
  7389                              <2>  %endif
  7390                              <2> 
  7391                              <2>  %rotate -1
  7392 00000730 E807040000          <1> call %1
  7393                              <1> %if (%0!=1)
  7394 00000735 83C414              <1>  add esp, byte %1_arglen
  7395                              <1> %endif
  7396                                  
  7397                                  .done
  7398                                  	ret
  7399                              <1> %ifnctx proc
  7400                              <1>  ret %1
  7401                              <1> %else
  7402 00000738 89EC                <1>  mov esp, ebp
  7403 0000073A 5D                  <1>  pop ebp
  7404 0000073B C3                  <1>  ret %1
  7405                              <1> %endif
  7406                                  
  7407                                  endproc
  7408                              <1> %ifnctx proc
  7409                              <1> %error Mismatched `endproc'/`proc'
  7410                              <1> %else
  7411                              <1> .STACK_FRAME_SIZE equ %$local
  7412                              <1> 
  7413                              <1> 
  7414                              <1> %ifdef LEGACY_ENDPROC
  7415                              <1>  ret
  7416                              <1> %endif
  7417                              <1> 
  7418                              <1> 
  7419                              <1> 
  7420                              <1> 
  7421                              <1> 
  7422                              <1> 
  7423                              <1> 
  7424                              <1> 
  7425                              <1> 
  7426                              <1> %pop
  7427                              <1> %endif
  7428                                  _DrawCircle_arglen	EQU	22
  7429                                  
  7430                                  ;-------------------------------------------------------------------------------------------------------------------
  7431                                  ;-- void DrawText(dword *StringOff, dword *DestOff, word DestWidth, word DestHeight, word X, word Y, dword Color) --
  7432                                  ;-------------------------------------------------------------------------------------------------------------------
  7433                                  ; Inputs : StringOff - offset of string to draw
  7434                                  ;          DestOff - offset of an image buffer in memory
  7435                                  ;          DestWidth - width of the buffer
  7436                                  ;          DestHeight - height of the buffer
  7437                                  ;          X - x coordinate of start point
  7438                                  ;          Y - y coordinate of start point
  7439                                  ;          Color - color of the string to draw
  7440                                  ;          [_FontOff] - offset of font image data
  7441                                  ; Outputs : string drawn to buffer
  7442                                  ; Returns : -
  7443                                  ; Calls : _PointInBox
  7444                                  ; - draws a text string pointed to by StringOff with color Color at point (X, Y) in the buffer pointed to by DestOff
  7445                                  proc _DrawText
  7446                              <1> %ifctx proc
  7447                              <1> %error Mismatched `endproc'/`proc'
  7448                              <1> %else
  7449                              <1> %push proc
  7450                              <1>  global %1
  7451 0000073C 55                  <1> %1: push ebp
  7452 0000073D 89E5                <1>  mov ebp, esp
  7453                              <1> %assign %$arg 8
  7454                              <1> %assign %$local 0
  7455                              <1> 
  7456                              <1> %define %$procname %1
  7457                              <1> %endif
  7458                                  .StringOff	arg	4
  7459                              <1> .StringOff equ %$arg
  7460                              <1> 
  7461                              <1> 
  7462                              <1> %assign %$arg %1+%$arg
  7463                                  .DestOff	arg	4
  7464                              <1> .DestOff equ %$arg
  7465                              <1> 
  7466                              <1> 
  7467                              <1> %assign %$arg %1+%$arg
  7468                                  .DestWidth	arg	2
  7469                              <1> .DestWidth equ %$arg
  7470                              <1> 
  7471                              <1> 
  7472                              <1> %assign %$arg %1+%$arg
  7473                                  .DestHeight	arg	2
  7474                              <1> .DestHeight equ %$arg
  7475                              <1> 
  7476                              <1> 
  7477                              <1> %assign %$arg %1+%$arg
  7478                                  .X		arg	2
  7479                              <1> .X equ %$arg
  7480                              <1> 
  7481                              <1> 
  7482                              <1> %assign %$arg %1+%$arg
  7483                                  .Y		arg	2
  7484                              <1> .Y equ %$arg
  7485                              <1> 
  7486                              <1> 
  7487                              <1> %assign %$arg %1+%$arg
  7488                                  .Color		arg	4
  7489                              <1> .Color equ %$arg
  7490                              <1> 
  7491                              <1> 
  7492                              <1> %assign %$arg %1+%$arg
  7493                                  
  7494                                  ;	invoke	_libDrawText, dword [ebp+.StringOff], dword [ebp+.DestOff], word [ebp+.DestWidth], word [ebp+.DestHeight], word [ebp+.X], word [ebp+.Y], dword [ebp+.Color]
  7495                                  
  7496 0000073F 56                      	push	esi
  7497 00000740 57                      	push	edi
  7498                                  
  7499 00000741 31DB                    	xor	ebx, ebx
  7500                                  
  7501                                  .loopDrawText
  7502 00000743 8B4508                  	mov	eax, [.StringOff + ebp]		; calculate source offset (locate in font image)
  7503 00000746 01D8                    	add	eax, ebx			;
  7504 00000748 0FB630                  	movzx	esi, byte [eax]			;
  7505 0000074B 81FE24000000            	cmp	esi, '$'			;
  7506 00000751 0F84AF000000            	je	near .done			;
  7507 00000757 C1E606                  	shl	esi, 6				;
  7508 0000075A 0335[1A000000]          	add	esi, [_FontOff]			;
  7509                                  
  7510 00000760 0FB74510                	movzx	eax, word [.DestWidth + ebp]	; calculate destination offset (locate in buffer)
  7511 00000764 0FBF7D16                	movsx	edi, word [.Y + ebp]		;
  7512 00000768 F7EF                    	imul	edi				;
  7513 0000076A 0FBF7D14                	movsx	edi, word [.X + ebp]		;
  7514 0000076E 01F8                    	add	eax, edi			;
  7515 00000770 89DF                    	mov	edi, ebx			;
  7516 00000772 C1E704                  	shl	edi, 4				;
  7517 00000775 01F8                    	add	eax, edi			;
  7518 00000777 C1E002                  	shl	eax, 2				;
  7519 0000077A 03450C                  	add	eax, [.DestOff + ebp]		;
  7520 0000077D 89C7                    	mov	edi, eax
  7521                                  
  7522 0000077F 6631C9                  	xor	cx, cx
  7523                                  
  7524                                  .loopBlit
  7525 00000782 80F910                  	cmp	cl, 16				; if reaches end of 16th col
  7526 00000785 7C1D                    	jl	.keepCopying
  7527 00000787 FEC5                    	inc	ch
  7528 00000789 80FD10                  	cmp	ch, 16				; if reaches end of 16th row
  7529 0000078C 7D72                    	jge	.doneBlit
  7530 0000078E 30C9                    	xor	cl, cl
  7531 00000790 81C6C01F0000            	add	esi, 2048 * 4 - 16 * 4		; move to next row, starting col (source)
  7532 00000796 0FB74510                	movzx	eax, word [.DestWidth + ebp]
  7533 0000079A 2D10000000              	sub	eax, 16
  7534 0000079F C1E002                  	shl	eax, 2
  7535 000007A2 01C7                    	add	edi, eax			; move to next row, starting col (destination)
  7536                                  
  7537                                  .keepCopying
  7538 000007A4 660FB6C1                	movzx	ax, cl
  7539 000007A8 66034514                	add	ax, [.X + ebp]
  7540 000007AC 6689DA                  	mov	dx, bx
  7541 000007AF 66C1E204                	shl	dx, 4
  7542 000007B3 6601D0                  	add	ax, dx
  7543                                  
  7544 000007B6 660FB6D5                	movzx	dx, ch
  7545 000007BA 66035516                	add	dx, [.Y + ebp]
  7546                                  
  7547 000007BE 6651                    	push	cx
  7548 000007C0 53                      	push	ebx
  7549                                  	invoke	_PointInBox, ax, dx, word 0, word 0, word [.DestWidth + ebp], word [.DestHeight + ebp]
  7550                              <1> %rotate -1
  7551                              <1> 
  7552                              <1> %rep (%0-1)
  7553                              <1> 
  7554                              <1> 
  7555                              <1> 
  7556                              <1> 
  7557                              <1> 
  7558                              <1> 
  7559                              <1> 
  7560                              <1>  %ifidni %1, cs
  7561                              <1>  o16 push %1
  7562                              <1>  %elifidni %1, ds
  7563                              <1>  o16 push %1
  7564                              <1>  %elifidni %1, es
  7565                              <1>  o16 push %1
  7566                              <1>  %elifidni %1, fs
  7567                              <1>  o16 push %1
  7568                              <1>  %elifidni %1, gs
  7569                              <1>  o16 push %1
  7570                              <1>  %elifidni %1, word cs
  7571                              <1>  o16 push %1
  7572                              <1>  %elifidni %1, word ds
  7573                              <1>  o16 push %1
  7574                              <1>  %elifidni %1, word es
  7575                              <1>  o16 push %1
  7576                              <1>  %elifidni %1, word fs
  7577                              <1>  o16 push %1
  7578                              <1>  %elifidni %1, word gs
  7579                              <1>  o16 push %1
  7580                              <1>  %else
  7581                              <1>  push %1
  7582                              <1>  %endif
  7583                              <1> 
  7584                              <1>  %rotate -1
  7585                              <1> %endrep
  7586                              <2> 
  7587                              <2> 
  7588                              <2> 
  7589                              <2> 
  7590                              <2> 
  7591                              <2> 
  7592                              <2> 
  7593                              <2>  %ifidni %1, cs
  7594                              <2>  o16 push %1
  7595                              <2>  %elifidni %1, ds
  7596                              <2>  o16 push %1
  7597                              <2>  %elifidni %1, es
  7598                              <2>  o16 push %1
  7599                              <2>  %elifidni %1, fs
  7600                              <2>  o16 push %1
  7601                              <2>  %elifidni %1, gs
  7602                              <2>  o16 push %1
  7603                              <2>  %elifidni %1, word cs
  7604                              <2>  o16 push %1
  7605                              <2>  %elifidni %1, word ds
  7606                              <2>  o16 push %1
  7607                              <2>  %elifidni %1, word es
  7608                              <2>  o16 push %1
  7609                              <2>  %elifidni %1, word fs
  7610                              <2>  o16 push %1
  7611                              <2>  %elifidni %1, word gs
  7612                              <2>  o16 push %1
  7613                              <2>  %else
  7614 000007C1 66FF7512            <2>  push %1
  7615                              <2>  %endif
  7616                              <2> 
  7617                              <2>  %rotate -1
  7618                              <2> 
  7619                              <2> 
  7620                              <2> 
  7621                              <2> 
  7622                              <2> 
  7623                              <2> 
  7624                              <2> 
  7625                              <2>  %ifidni %1, cs
  7626                              <2>  o16 push %1
  7627                              <2>  %elifidni %1, ds
  7628                              <2>  o16 push %1
  7629                              <2>  %elifidni %1, es
  7630                              <2>  o16 push %1
  7631                              <2>  %elifidni %1, fs
  7632                              <2>  o16 push %1
  7633                              <2>  %elifidni %1, gs
  7634                              <2>  o16 push %1
  7635                              <2>  %elifidni %1, word cs
  7636                              <2>  o16 push %1
  7637                              <2>  %elifidni %1, word ds
  7638                              <2>  o16 push %1
  7639                              <2>  %elifidni %1, word es
  7640                              <2>  o16 push %1
  7641                              <2>  %elifidni %1, word fs
  7642                              <2>  o16 push %1
  7643                              <2>  %elifidni %1, word gs
  7644                              <2>  o16 push %1
  7645                              <2>  %else
  7646 000007C5 66FF7510            <2>  push %1
  7647                              <2>  %endif
  7648                              <2> 
  7649                              <2>  %rotate -1
  7650                              <2> 
  7651                              <2> 
  7652                              <2> 
  7653                              <2> 
  7654                              <2> 
  7655                              <2> 
  7656                              <2> 
  7657                              <2>  %ifidni %1, cs
  7658                              <2>  o16 push %1
  7659                              <2>  %elifidni %1, ds
  7660                              <2>  o16 push %1
  7661                              <2>  %elifidni %1, es
  7662                              <2>  o16 push %1
  7663                              <2>  %elifidni %1, fs
  7664                              <2>  o16 push %1
  7665                              <2>  %elifidni %1, gs
  7666                              <2>  o16 push %1
  7667                              <2>  %elifidni %1, word cs
  7668                              <2>  o16 push %1
  7669                              <2>  %elifidni %1, word ds
  7670                              <2>  o16 push %1
  7671                              <2>  %elifidni %1, word es
  7672                              <2>  o16 push %1
  7673                              <2>  %elifidni %1, word fs
  7674                              <2>  o16 push %1
  7675                              <2>  %elifidni %1, word gs
  7676                              <2>  o16 push %1
  7677                              <2>  %else
  7678 000007C9 66680000            <2>  push %1
  7679                              <2>  %endif
  7680                              <2> 
  7681                              <2>  %rotate -1
  7682                              <2> 
  7683                              <2> 
  7684                              <2> 
  7685                              <2> 
  7686                              <2> 
  7687                              <2> 
  7688                              <2> 
  7689                              <2>  %ifidni %1, cs
  7690                              <2>  o16 push %1
  7691                              <2>  %elifidni %1, ds
  7692                              <2>  o16 push %1
  7693                              <2>  %elifidni %1, es
  7694                              <2>  o16 push %1
  7695                              <2>  %elifidni %1, fs
  7696                              <2>  o16 push %1
  7697                              <2>  %elifidni %1, gs
  7698                              <2>  o16 push %1
  7699                              <2>  %elifidni %1, word cs
  7700                              <2>  o16 push %1
  7701                              <2>  %elifidni %1, word ds
  7702                              <2>  o16 push %1
  7703                              <2>  %elifidni %1, word es
  7704                              <2>  o16 push %1
  7705                              <2>  %elifidni %1, word fs
  7706                              <2>  o16 push %1
  7707                              <2>  %elifidni %1, word gs
  7708                              <2>  o16 push %1
  7709                              <2>  %else
  7710 000007CD 66680000            <2>  push %1
  7711                              <2>  %endif
  7712                              <2> 
  7713                              <2>  %rotate -1
  7714                              <2> 
  7715                              <2> 
  7716                              <2> 
  7717                              <2> 
  7718                              <2> 
  7719                              <2> 
  7720                              <2> 
  7721                              <2>  %ifidni %1, cs
  7722                              <2>  o16 push %1
  7723                              <2>  %elifidni %1, ds
  7724                              <2>  o16 push %1
  7725                              <2>  %elifidni %1, es
  7726                              <2>  o16 push %1
  7727                              <2>  %elifidni %1, fs
  7728                              <2>  o16 push %1
  7729                              <2>  %elifidni %1, gs
  7730                              <2>  o16 push %1
  7731                              <2>  %elifidni %1, word cs
  7732                              <2>  o16 push %1
  7733                              <2>  %elifidni %1, word ds
  7734                              <2>  o16 push %1
  7735                              <2>  %elifidni %1, word es
  7736                              <2>  o16 push %1
  7737                              <2>  %elifidni %1, word fs
  7738                              <2>  o16 push %1
  7739                              <2>  %elifidni %1, word gs
  7740                              <2>  o16 push %1
  7741                              <2>  %else
  7742 000007D1 6652                <2>  push %1
  7743                              <2>  %endif
  7744                              <2> 
  7745                              <2>  %rotate -1
  7746                              <2> 
  7747                              <2> 
  7748                              <2> 
  7749                              <2> 
  7750                              <2> 
  7751                              <2> 
  7752                              <2> 
  7753                              <2>  %ifidni %1, cs
  7754                              <2>  o16 push %1
  7755                              <2>  %elifidni %1, ds
  7756                              <2>  o16 push %1
  7757                              <2>  %elifidni %1, es
  7758                              <2>  o16 push %1
  7759                              <2>  %elifidni %1, fs
  7760                              <2>  o16 push %1
  7761                              <2>  %elifidni %1, gs
  7762                              <2>  o16 push %1
  7763                              <2>  %elifidni %1, word cs
  7764                              <2>  o16 push %1
  7765                              <2>  %elifidni %1, word ds
  7766                              <2>  o16 push %1
  7767                              <2>  %elifidni %1, word es
  7768                              <2>  o16 push %1
  7769                              <2>  %elifidni %1, word fs
  7770                              <2>  o16 push %1
  7771                              <2>  %elifidni %1, word gs
  7772                              <2>  o16 push %1
  7773                              <2>  %else
  7774 000007D3 6650                <2>  push %1
  7775                              <2>  %endif
  7776                              <2> 
  7777                              <2>  %rotate -1
  7778 000007D5 E8EBF9FFFF          <1> call %1
  7779                              <1> %if (%0!=1)
  7780 000007DA 83C40C              <1>  add esp, byte %1_arglen
  7781                              <1> %endif
  7782 000007DD 5B                      	pop	ebx
  7783 000007DE 6659                    	pop	cx
  7784 000007E0 85C0                    	test	eax, eax
  7785 000007E2 740C                    	jz	.outsideBoundary
  7786 000007E4 8B4518                  	mov	eax, [.Color + ebp]
  7787 000007E7 25FFFFFF00              	and	eax, 00ffffffh
  7788 000007EC 0B06                    	or	eax, [esi]
  7789 000007EE 8907                    	mov	[edi], eax
  7790                                  
  7791                                  .outsideBoundary
  7792 000007F0 81C604000000            	add	esi, 4
  7793 000007F6 81C704000000            	add	edi, 4
  7794 000007FC FEC1                    	inc	cl
  7795 000007FE EB82                    	jmp	.loopBlit
  7796                                  
  7797                                  .doneBlit
  7798 00000800 43                      	inc	ebx
  7799 00000801 E93DFFFFFF              	jmp	.loopDrawText
  7800                                  
  7801                                  .done
  7802 00000806 5F                      	pop	edi
  7803 00000807 5E                      	pop	esi
  7804                                  	ret
  7805                              <1> %ifnctx proc
  7806                              <1>  ret %1
  7807                              <1> %else
  7808 00000808 89EC                <1>  mov esp, ebp
  7809 0000080A 5D                  <1>  pop ebp
  7810 0000080B C3                  <1>  ret %1
  7811                              <1> %endif
  7812                                  
  7813                                  endproc
  7814                              <1> %ifnctx proc
  7815                              <1> %error Mismatched `endproc'/`proc'
  7816                              <1> %else
  7817                              <1> .STACK_FRAME_SIZE equ %$local
  7818                              <1> 
  7819                              <1> 
  7820                              <1> %ifdef LEGACY_ENDPROC
  7821                              <1>  ret
  7822                              <1> %endif
  7823                              <1> 
  7824                              <1> 
  7825                              <1> 
  7826                              <1> 
  7827                              <1> 
  7828                              <1> 
  7829                              <1> 
  7830                              <1> 
  7831                              <1> 
  7832                              <1> %pop
  7833                              <1> %endif
  7834                                  _DrawText_arglen	EQU	20
  7835                                  
  7836                                  ;------------------------------------------------------------------------------------
  7837                                  ;-- void ClearBuffer(dword *DestOff, word DestWidth, word DestHeight, dword Color) --
  7838                                  ;------------------------------------------------------------------------------------
  7839                                  ; Inputs : DestOff - offset of an image buffer in memory
  7840                                  ;          DestWidth - width of the buffer
  7841                                  ;          DestHeight - height of the buffer
  7842                                  ;          Color - color to make buffer
  7843                                  ; Outputs : color copied to buffer
  7844                                  ; Returns : -
  7845                                  ; Calls : -
  7846                                  ; - clears a buffer pointed to by DestOff by filling it with color Color
  7847                                  proc _ClearBuffer
  7848                              <1> %ifctx proc
  7849                              <1> %error Mismatched `endproc'/`proc'
  7850                              <1> %else
  7851                              <1> %push proc
  7852                              <1>  global %1
  7853 0000080C 55                  <1> %1: push ebp
  7854 0000080D 89E5                <1>  mov ebp, esp
  7855                              <1> %assign %$arg 8
  7856                              <1> %assign %$local 0
  7857                              <1> 
  7858                              <1> %define %$procname %1
  7859                              <1> %endif
  7860                                  .DestOff	arg	4
  7861                              <1> .DestOff equ %$arg
  7862                              <1> 
  7863                              <1> 
  7864                              <1> %assign %$arg %1+%$arg
  7865                                  .DestWidth	arg	2
  7866                              <1> .DestWidth equ %$arg
  7867                              <1> 
  7868                              <1> 
  7869                              <1> %assign %$arg %1+%$arg
  7870                                  .DestHeight	arg	2
  7871                              <1> .DestHeight equ %$arg
  7872                              <1> 
  7873                              <1> 
  7874                              <1> %assign %$arg %1+%$arg
  7875                                  .Color		arg	4
  7876                              <1> .Color equ %$arg
  7877                              <1> 
  7878                              <1> 
  7879                              <1> %assign %$arg %1+%$arg
  7880                                  
  7881                                  ;	invoke	_libClearBuffer, dword [ebp+.DestOff], word [ebp+.DestWidth], word [ebp+.DestHeight], dword [ebp+.Color]
  7882                                  
  7883 0000080F 57                      	push	edi
  7884                                  
  7885 00000810 668CD8                  	mov	ax, ds
  7886 00000813 8EC0                    	mov	es, ax
  7887 00000815 0FB7450C                	movzx	eax, word [.DestWidth + ebp]	;
  7888 00000819 0FB74D0E                	movzx	ecx, word [.DestHeight + ebp]	;
  7889 0000081D F7E1                    	mul	ecx				;
  7890 0000081F 89C1                    	mov	ecx, eax			; run (DestWidth * DestHeight) times
  7891 00000821 8B4510                  	mov	eax, [.Color + ebp]
  7892 00000824 FC                      	cld
  7893 00000825 8B7D08                  	mov	edi, [.DestOff + ebp]
  7894 00000828 F3AB                    	rep	stosd
  7895                                  
  7896 0000082A 5F                      	pop	edi
  7897                                  	ret
  7898                              <1> %ifnctx proc
  7899                              <1>  ret %1
  7900                              <1> %else
  7901 0000082B 89EC                <1>  mov esp, ebp
  7902 0000082D 5D                  <1>  pop ebp
  7903 0000082E C3                  <1>  ret %1
  7904                              <1> %endif
  7905                                  
  7906                                  endproc
  7907                              <1> %ifnctx proc
  7908                              <1> %error Mismatched `endproc'/`proc'
  7909                              <1> %else
  7910                              <1> .STACK_FRAME_SIZE equ %$local
  7911                              <1> 
  7912                              <1> 
  7913                              <1> %ifdef LEGACY_ENDPROC
  7914                              <1>  ret
  7915                              <1> %endif
  7916                              <1> 
  7917                              <1> 
  7918                              <1> 
  7919                              <1> 
  7920                              <1> 
  7921                              <1> 
  7922                              <1> 
  7923                              <1> 
  7924                              <1> 
  7925                              <1> %pop
  7926                              <1> %endif
  7927                                  _ClearBuffer_arglen	EQU	12
  7928                                  
  7929                                  ;------------------------------------------------------------------------------------------------------------------------------------
  7930                                  ;-- void CopyBuffer(dword *ScrOff, word SrcWidth, word SrcHeight, dword *DestOff, word DestWidth, word DestHeight, word X, word Y) --
  7931                                  ;------------------------------------------------------------------------------------------------------------------------------------
  7932                                  ; Inputs : ScrOff - offset of source buffer
  7933                                  ;          ScrWidth - width of source buffer
  7934                                  ;          SrcHeight - height of source buffer
  7935                                  ;          DestOff - offset of destination buffer
  7936                                  ;          DestWidth - width of destination buffer
  7937                                  ;          DestHeight - height of destination buffer
  7938                                  ;          X - x coordinate of start point in destination buffer
  7939                                  ;          Y - y coordinate of start point in destination buffer
  7940                                  ; Outputs : source buffer copied onto destination buffer
  7941                                  ; Returns : -
  7942                                  ; Calls : -
  7943                                  ; - copies a source buffer pointed to by ScrOff to a location (X, Y) in a destination buffer pointed to by DestOff
  7944                                  proc _CopyBuffer
  7945                              <1> %ifctx proc
  7946                              <1> %error Mismatched `endproc'/`proc'
  7947                              <1> %else
  7948                              <1> %push proc
  7949                              <1>  global %1
  7950 0000082F 55                  <1> %1: push ebp
  7951 00000830 89E5                <1>  mov ebp, esp
  7952                              <1> %assign %$arg 8
  7953                              <1> %assign %$local 0
  7954                              <1> 
  7955                              <1> %define %$procname %1
  7956                              <1> %endif
  7957                                  .SrcOff		arg	4
  7958                              <1> .SrcOff equ %$arg
  7959                              <1> 
  7960                              <1> 
  7961                              <1> %assign %$arg %1+%$arg
  7962                                  .SrcWidth	arg	2
  7963                              <1> .SrcWidth equ %$arg
  7964                              <1> 
  7965                              <1> 
  7966                              <1> %assign %$arg %1+%$arg
  7967                                  .SrcHeight	arg	2
  7968                              <1> .SrcHeight equ %$arg
  7969                              <1> 
  7970                              <1> 
  7971                              <1> %assign %$arg %1+%$arg
  7972                                  .DestOff	arg	4
  7973                              <1> .DestOff equ %$arg
  7974                              <1> 
  7975                              <1> 
  7976                              <1> %assign %$arg %1+%$arg
  7977                                  .DestWidth	arg	2
  7978                              <1> .DestWidth equ %$arg
  7979                              <1> 
  7980                              <1> 
  7981                              <1> %assign %$arg %1+%$arg
  7982                                  .DestHeight	arg	2
  7983                              <1> .DestHeight equ %$arg
  7984                              <1> 
  7985                              <1> 
  7986                              <1> %assign %$arg %1+%$arg
  7987                                  .X		arg	2
  7988                              <1> .X equ %$arg
  7989                              <1> 
  7990                              <1> 
  7991                              <1> %assign %$arg %1+%$arg
  7992                                  .Y		arg	2
  7993                              <1> .Y equ %$arg
  7994                              <1> 
  7995                              <1> 
  7996                              <1> %assign %$arg %1+%$arg
  7997                                  
  7998                                  ;	invoke	_libCopyBuffer, dword [ebp+.SrcOff], word [ebp+.SrcWidth], word [ebp+.SrcHeight], dword [ebp+.DestOff], word [ebp+.DestWidth], word [ebp+.DestHeight], word [ebp+.X], word [ebp+.Y]
  7999                                  
  8000 00000832 56                      	push	esi
  8001 00000833 57                      	push	edi
  8002                                  
  8003 00000834 668CD8                  	mov	ax, ds
  8004 00000837 8EC0                    	mov	es, ax
  8005                                  
  8006 00000839 8B7508                  	mov	esi, [.SrcOff + ebp]
  8007 0000083C 0FB74514                	movzx	eax, word [.DestWidth + ebp]	;
  8008 00000840 0FBF7D1A                	movsx	edi, word [.Y + ebp]		;
  8009 00000844 F7EF                    	imul	edi				;
  8010 00000846 0FBF7D18                	movsx	edi, word [.X + ebp]		;
  8011 0000084A 01F8                    	add	eax, edi			;
  8012 0000084C C1E002                  	shl	eax, 2				;
  8013 0000084F 034510                  	add	eax, [.DestOff + ebp]		;
  8014 00000852 89C7                    	mov	edi, eax			; calculate destination offset
  8015 00000854 FC                      	cld
  8016 00000855 668B5D0E                	mov	bx, word [.SrcHeight + ebp]
  8017                                  
  8018                                  .loopCopy
  8019 00000859 0FB74D0C                	movzx	ecx, word [.SrcWidth + ebp]	; run SrcWidth times
  8020 0000085D F3A5                    	rep	movsd
  8021 0000085F 0FB74514                	movzx	eax, word [.DestWidth + ebp]
  8022 00000863 662B450C                	sub	ax, word [.SrcWidth + ebp]
  8023 00000867 C1E002                  	shl	eax, 2
  8024 0000086A 01C7                    	add	edi, eax
  8025 0000086C 664B                    	dec	bx
  8026 0000086E 6685DB                  	test	bx, bx
  8027 00000871 75E6                    	jnz	.loopCopy
  8028                                  
  8029 00000873 5F                      	pop	edi
  8030 00000874 5E                      	pop	esi
  8031                                  	ret
  8032                              <1> %ifnctx proc
  8033                              <1>  ret %1
  8034                              <1> %else
  8035 00000875 89EC                <1>  mov esp, ebp
  8036 00000877 5D                  <1>  pop ebp
  8037 00000878 C3                  <1>  ret %1
  8038                              <1> %endif
  8039                                  
  8040                                  endproc
  8041                              <1> %ifnctx proc
  8042                              <1> %error Mismatched `endproc'/`proc'
  8043                              <1> %else
  8044                              <1> .STACK_FRAME_SIZE equ %$local
  8045                              <1> 
  8046                              <1> 
  8047                              <1> %ifdef LEGACY_ENDPROC
  8048                              <1>  ret
  8049                              <1> %endif
  8050                              <1> 
  8051                              <1> 
  8052                              <1> 
  8053                              <1> 
  8054                              <1> 
  8055                              <1> 
  8056                              <1> 
  8057                              <1> 
  8058                              <1> 
  8059                              <1> %pop
  8060                              <1> %endif
  8061                                  _CopyBuffer_arglen	EQU	20
  8062                                  
  8063                                  
  8064                                  ;----------------------------------------------------------------------------------------------------------------------------------------
  8065                                  ;-- void ComposeBuffers(dword *SrcOff, word SrcWidth, word SrcHeight, dword *DestOff, word DestWidth, word DestHeight, word X, word Y) --
  8066                                  ;----------------------------------------------------------------------------------------------------------------------------------------
  8067                                  ; Inputs : ScrOff - offset of source buffer
  8068                                  ;          ScrWidth - width of source buffer
  8069                                  ;          SrcHeight - height of source buffer
  8070                                  ;          DestOff - offset of destination buffer
  8071                                  ;          DestWidth - width of destination buffer
  8072                                  ;          DestHeight - height of destination buffer
  8073                                  ;          X - x coordinate of start point in destination buffer
  8074                                  ;          Y - y coordinate of start point in destination buffer
  8075                                  ; Outputs : source buffer alpha composed onto destination buffer
  8076                                  ; Returns : -
  8077                                  ; Calls : -
  8078                                  ; - alpha composes a source buffer pointed to by ScrOff onto a destination buffer pointed to by DestOff at location (X, Y)
  8079                                  proc _ComposeBuffers
  8080                              <1> %ifctx proc
  8081                              <1> %error Mismatched `endproc'/`proc'
  8082                              <1> %else
  8083                              <1> %push proc
  8084                              <1>  global %1
  8085 00000879 55                  <1> %1: push ebp
  8086 0000087A 89E5                <1>  mov ebp, esp
  8087                              <1> %assign %$arg 8
  8088                              <1> %assign %$local 0
  8089                              <1> 
  8090                              <1> %define %$procname %1
  8091                              <1> %endif
  8092                                  .SrcOff		arg	4
  8093                              <1> .SrcOff equ %$arg
  8094                              <1> 
  8095                              <1> 
  8096                              <1> %assign %$arg %1+%$arg
  8097                                  .SrcWidth	arg	2
  8098                              <1> .SrcWidth equ %$arg
  8099                              <1> 
  8100                              <1> 
  8101                              <1> %assign %$arg %1+%$arg
  8102                                  .SrcHeight	arg	2
  8103                              <1> .SrcHeight equ %$arg
  8104                              <1> 
  8105                              <1> 
  8106                              <1> %assign %$arg %1+%$arg
  8107                                  .DestOff	arg	4
  8108                              <1> .DestOff equ %$arg
  8109                              <1> 
  8110                              <1> 
  8111                              <1> %assign %$arg %1+%$arg
  8112                                  .DestWidth	arg	2
  8113                              <1> .DestWidth equ %$arg
  8114                              <1> 
  8115                              <1> 
  8116                              <1> %assign %$arg %1+%$arg
  8117                                  .DestHeight	arg	2
  8118                              <1> .DestHeight equ %$arg
  8119                              <1> 
  8120                              <1> 
  8121                              <1> %assign %$arg %1+%$arg
  8122                                  .X	        arg	2
  8123                              <1> .X equ %$arg
  8124                              <1> 
  8125                              <1> 
  8126                              <1> %assign %$arg %1+%$arg
  8127                                  .Y		arg	2
  8128                              <1> .Y equ %$arg
  8129                              <1> 
  8130                              <1> 
  8131                              <1> %assign %$arg %1+%$arg
  8132                                  
  8133                                  ;	invoke	_libComposeBuffers, dword [ebp+.SrcOff], word [ebp+.SrcWidth], word [ebp+.SrcHeight], dword [ebp+.DestOff], word [ebp+.DestWidth], word [ebp+.DestHeight], word [ebp+.X], word [ebp+.Y]
  8134                                  
  8135 0000087C 56                      	push	esi
  8136 0000087D 57                      	push	edi
  8137                                  
  8138 0000087E 8B7508                  	mov	esi, [.SrcOff + ebp]
  8139 00000881 0FB74514                	movzx	eax, word [.DestWidth + ebp]
  8140 00000885 0FBF7D1A                	movsx	edi, word [.Y + ebp]
  8141 00000889 F7EF                    	imul	edi
  8142 0000088B 0FBF7D18                	movsx	edi, word [.X + ebp]
  8143 0000088F 01F8                    	add	eax, edi
  8144 00000891 C1E002                  	shl	eax, 2
  8145 00000894 034510                  	add	eax, [.DestOff + ebp]
  8146 00000897 89C7                    	mov	edi, eax
  8147                                  
  8148 00000899 668B4D0E                	mov	cx, [.SrcHeight + ebp]
  8149 0000089D 668B550C                	mov	dx, [.SrcWidth + ebp]
  8150 000008A1 66D1EA                  	shr	dx, 1
  8151                                  
  8152                                  .loopCompose
  8153 000008A4 6685D2                  	test	dx, dx
  8154 000008A7 751F                    	jnz	.startMMX
  8155 000008A9 668B550C                	mov	dx, [.SrcWidth + ebp]
  8156 000008AD 66D1EA                  	shr	dx, 1
  8157 000008B0 0FB74514                	movzx	eax, word [.DestWidth + ebp]
  8158 000008B4 662B450C                	sub	ax, word [.SrcWidth + ebp]
  8159 000008B8 C1E002                  	shl	eax, 2
  8160 000008BB 01C7                    	add	edi, eax
  8161 000008BD 6649                    	dec	cx
  8162 000008BF 6685C9                  	test	cx, cx
  8163 000008C2 0F84A3000000            	jz	near .done
  8164                                  
  8165                                  .startMMX
  8166 000008C8 0F6F06                  	movq	mm0, [esi]		;
  8167 000008CB 0F6FC8                  	movq	mm1, mm0		;
  8168 000008CE 0FEFFF                  	pxor	mm7, mm7		;
  8169 000008D1 0F68CF                  	punpckhbw	mm1, mm7	; unpack high dword from mm0 into mm1 (source)
  8170                                  
  8171 000008D4 8A4607                  	mov	al, [esi + 7]		;
  8172 000008D7 88C4                    	mov	ah, al			;
  8173 000008D9 6689C3                  	mov	bx, ax			;
  8174 000008DC C1E310                  	shl	ebx, 16			;
  8175 000008DF 6689C3                  	mov	bx, ax			;
  8176 000008E2 0F6ED3                  	movd	mm2, ebx		;
  8177 000008E5 0F60D7                  	punpcklbw	mm2, mm7	; copy out source alpha byte into ebx then to mm2
  8178                                  
  8179 000008E8 0FD5CA                  	pmullw	mm1, mm2		; alpha * source
  8180 000008EB 0FDD0D[09020000]        	paddusw	mm1, [_RoundingFactor]
  8181 000008F2 0F71D108                	psrlw	mm1, 8
  8182                                  
  8183 000008F6 0F6F27                  	movq	mm4, [edi]		;
  8184 000008F9 0F6FEC                  	movq	mm5, mm4		;
  8185 000008FC 0F68EF                  	punpckhbw	mm5, mm7	; unpack high dword from mm4 into mm5 (destination)
  8186                                  
  8187 000008FF 0FDDCD                  	paddusw	mm1, mm5		; alpha * source + destination
  8188                                  
  8189 00000902 0FD5EA                  	pmullw	mm5, mm2		; alpha * destination
  8190 00000905 0FDD2D[09020000]        	paddusw	mm5, [_RoundingFactor]
  8191 0000090C 0F71D508                	psrlw	mm5, 8
  8192                                  
  8193 00000910 0FD9CD                  	psubusw	mm1, mm5		; (alpha * source) + destination - (alpha * destination)
  8194                                  
  8195 00000913 0F60C7                  	punpcklbw	mm0, mm7	; unpack low dword from mm0 into mm0 (source)
  8196                                  
  8197 00000916 8A4603                  	mov	al, [esi + 3]		;
  8198 00000919 88C4                    	mov	ah, al			;
  8199 0000091B 6689C3                  	mov	bx, ax			;
  8200 0000091E C1E310                  	shl	ebx, 16			;
  8201 00000921 6689C3                  	mov	bx, ax			;
  8202 00000924 0F6ED3                  	movd	mm2, ebx		;
  8203 00000927 0F60D7                  	punpcklbw	mm2, mm7	; copy out source alpha byte into ebx then to mm2
  8204                                  
  8205 0000092A 0FD5C2                  	pmullw	mm0, mm2		; alpha * source
  8206 0000092D 0FDD05[09020000]        	paddusw	mm0, [_RoundingFactor]
  8207 00000934 0F71D008                	psrlw	mm0, 8
  8208                                  
  8209 00000938 0F6FEC                  	movq	mm5, mm4		;
  8210 0000093B 0F60EF                  	punpcklbw	mm5, mm7	; unpack low dword from mm4 into mm5 (destination)
  8211                                  
  8212 0000093E 0FDDC5                  	paddusw	mm0, mm5		; alpha * source + destination
  8213                                  
  8214 00000941 0FD5EA                  	pmullw	mm5, mm2		; alpha * destination
  8215 00000944 0FDD2D[09020000]        	paddusw	mm5, [_RoundingFactor]
  8216 0000094B 0F71D508                	psrlw	mm5, 8
  8217                                  
  8218 0000094F 0FD9C5                  	psubusw mm0, mm5		; (alpha * source) + destination - (alpha * destination)
  8219                                  
  8220 00000952 0F67C1                  	packuswb	mm0, mm1	; pack high and low words back into mm0
  8221                                  
  8222 00000955 0F7F07                  	movq	[edi], mm0
  8223 00000958 664A                    	dec	dx
  8224 0000095A 81C608000000            	add	esi, 8
  8225 00000960 81C708000000            	add	edi, 8
  8226 00000966 E939FFFFFF              	jmp	.loopCompose
  8227                                  
  8228                                  .done
  8229 0000096B 5F                      	pop	edi
  8230 0000096C 5E                      	pop	esi
  8231                                  	ret
  8232                              <1> %ifnctx proc
  8233                              <1>  ret %1
  8234                              <1> %else
  8235 0000096D 89EC                <1>  mov esp, ebp
  8236 0000096F 5D                  <1>  pop ebp
  8237 00000970 C3                  <1>  ret %1
  8238                              <1> %endif
  8239                                  
  8240                                  endproc
  8241                              <1> %ifnctx proc
  8242                              <1> %error Mismatched `endproc'/`proc'
  8243                              <1> %else
  8244                              <1> .STACK_FRAME_SIZE equ %$local
  8245                              <1> 
  8246                              <1> 
  8247                              <1> %ifdef LEGACY_ENDPROC
  8248                              <1>  ret
  8249                              <1> %endif
  8250                              <1> 
  8251                              <1> 
  8252                              <1> 
  8253                              <1> 
  8254                              <1> 
  8255                              <1> 
  8256                              <1> 
  8257                              <1> 
  8258                              <1> 
  8259                              <1> %pop
  8260                              <1> %endif
  8261                                  _ComposeBuffers_arglen	EQU	20
  8262                                  
  8263                                  ;-------------------------------------------------------------------------------------
  8264                                  ;-- void BlurBuffer(dword *ScrOff, dword *DestOff, word DestWidth, word DestHeight) --
  8265                                  ;-------------------------------------------------------------------------------------
  8266                                  ; Inputs : ScrOff - offset of source buffer
  8267                                  ;          DestOff - offset of destination buffer
  8268                                  ;          DestWidth - width of destination buffer
  8269                                  ;          DestHeight - height of destination buffer
  8270                                  ; Outputs : string drawn to buffer
  8271                                  ; Returns : -
  8272                                  ; Calls : _GetPixel
  8273                                  ; - blurs the buffer pointed to by ScrOff and writes the blurred buffer to the buffer pointed to by DestOff
  8274                                  proc _BlurBuffer
  8275                              <1> %ifctx proc
  8276                              <1> %error Mismatched `endproc'/`proc'
  8277                              <1> %else
  8278                              <1> %push proc
  8279                              <1>  global %1
  8280 00000971 55                  <1> %1: push ebp
  8281 00000972 89E5                <1>  mov ebp, esp
  8282                              <1> %assign %$arg 8
  8283                              <1> %assign %$local 0
  8284                              <1> 
  8285                              <1> %define %$procname %1
  8286                              <1> %endif
  8287                                  .SrcOff		arg	4
  8288                              <1> .SrcOff equ %$arg
  8289                              <1> 
  8290                              <1> 
  8291                              <1> %assign %$arg %1+%$arg
  8292                                  .DestOff	arg	4
  8293                              <1> .DestOff equ %$arg
  8294                              <1> 
  8295                              <1> 
  8296                              <1> %assign %$arg %1+%$arg
  8297                                  .DestWidth	arg	2
  8298                              <1> .DestWidth equ %$arg
  8299                              <1> 
  8300                              <1> 
  8301                              <1> %assign %$arg %1+%$arg
  8302                                  .DestHeight	arg	2
  8303                              <1> .DestHeight equ %$arg
  8304                              <1> 
  8305                              <1> 
  8306                              <1> %assign %$arg %1+%$arg
  8307                                  
  8308                                  ;	invoke	_libBlurBuffer, dword [ebp+.SrcOff], dword [ebp+.DestOff], word [ebp+.DestWidth], word [ebp+.DestHeight]
  8309                                  
  8310 00000974 56                      	push	esi
  8311 00000975 57                      	push	edi
  8312                                  
  8313 00000976 66C705[2A000000]00-     	mov	word [_y], 0
  8314 0000097E 00                 
  8315 0000097F 31DB                    	xor	ebx, ebx
  8316 00000981 668B5D12                	mov	bx, word [ebp+.DestHeight]	; height counter
  8317                                  
  8318                                  .rowLoop
  8319 00000985 66C705[28000000]00-     	mov	word [_x], 0			; width counter
  8320 0000098D 00                 
  8321 0000098E 0FB74D10                	movzx	ecx, word [ebp+.DestWidth]
  8322                                  
  8323                                  .colLoop
  8324 00000992 50                      	push	eax
  8325 00000993 53                      	push	ebx
  8326 00000994 51                      	push	ecx
  8327 00000995 52                      	push	edx
  8328                                  	
  8329 00000996 0FB735[28000000]        	movzx	esi, word [_x]			; x and y pointers
  8330 0000099D 0FB73D[2A000000]        	movzx	edi, word [_y]
  8331                                  
  8332                                  						; take a weighted sum of the current pixel and its neighboring pixels
  8333 000009A4 4E                      	dec	esi				; upper-left neighbor
  8334 000009A5 4F                      	dec	edi
  8335                                  	invoke  _GetPixel, dword [ebp+.SrcOff], word [ebp+.DestWidth], word [ebp+.DestHeight], si, di
  8336                              <1> %rotate -1
  8337                              <1> 
  8338                              <1> %rep (%0-1)
  8339                              <1> 
  8340                              <1> 
  8341                              <1> 
  8342                              <1> 
  8343                              <1> 
  8344                              <1> 
  8345                              <1> 
  8346                              <1>  %ifidni %1, cs
  8347                              <1>  o16 push %1
  8348                              <1>  %elifidni %1, ds
  8349                              <1>  o16 push %1
  8350                              <1>  %elifidni %1, es
  8351                              <1>  o16 push %1
  8352                              <1>  %elifidni %1, fs
  8353                              <1>  o16 push %1
  8354                              <1>  %elifidni %1, gs
  8355                              <1>  o16 push %1
  8356                              <1>  %elifidni %1, word cs
  8357                              <1>  o16 push %1
  8358                              <1>  %elifidni %1, word ds
  8359                              <1>  o16 push %1
  8360                              <1>  %elifidni %1, word es
  8361                              <1>  o16 push %1
  8362                              <1>  %elifidni %1, word fs
  8363                              <1>  o16 push %1
  8364                              <1>  %elifidni %1, word gs
  8365                              <1>  o16 push %1
  8366                              <1>  %else
  8367                              <1>  push %1
  8368                              <1>  %endif
  8369                              <1> 
  8370                              <1>  %rotate -1
  8371                              <1> %endrep
  8372                              <2> 
  8373                              <2> 
  8374                              <2> 
  8375                              <2> 
  8376                              <2> 
  8377                              <2> 
  8378                              <2> 
  8379                              <2>  %ifidni %1, cs
  8380                              <2>  o16 push %1
  8381                              <2>  %elifidni %1, ds
  8382                              <2>  o16 push %1
  8383                              <2>  %elifidni %1, es
  8384                              <2>  o16 push %1
  8385                              <2>  %elifidni %1, fs
  8386                              <2>  o16 push %1
  8387                              <2>  %elifidni %1, gs
  8388                              <2>  o16 push %1
  8389                              <2>  %elifidni %1, word cs
  8390                              <2>  o16 push %1
  8391                              <2>  %elifidni %1, word ds
  8392                              <2>  o16 push %1
  8393                              <2>  %elifidni %1, word es
  8394                              <2>  o16 push %1
  8395                              <2>  %elifidni %1, word fs
  8396                              <2>  o16 push %1
  8397                              <2>  %elifidni %1, word gs
  8398                              <2>  o16 push %1
  8399                              <2>  %else
  8400 000009A6 6657                <2>  push %1
  8401                              <2>  %endif
  8402                              <2> 
  8403                              <2>  %rotate -1
  8404                              <2> 
  8405                              <2> 
  8406                              <2> 
  8407                              <2> 
  8408                              <2> 
  8409                              <2> 
  8410                              <2> 
  8411                              <2>  %ifidni %1, cs
  8412                              <2>  o16 push %1
  8413                              <2>  %elifidni %1, ds
  8414                              <2>  o16 push %1
  8415                              <2>  %elifidni %1, es
  8416                              <2>  o16 push %1
  8417                              <2>  %elifidni %1, fs
  8418                              <2>  o16 push %1
  8419                              <2>  %elifidni %1, gs
  8420                              <2>  o16 push %1
  8421                              <2>  %elifidni %1, word cs
  8422                              <2>  o16 push %1
  8423                              <2>  %elifidni %1, word ds
  8424                              <2>  o16 push %1
  8425                              <2>  %elifidni %1, word es
  8426                              <2>  o16 push %1
  8427                              <2>  %elifidni %1, word fs
  8428                              <2>  o16 push %1
  8429                              <2>  %elifidni %1, word gs
  8430                              <2>  o16 push %1
  8431                              <2>  %else
  8432 000009A8 6656                <2>  push %1
  8433                              <2>  %endif
  8434                              <2> 
  8435                              <2>  %rotate -1
  8436                              <2> 
  8437                              <2> 
  8438                              <2> 
  8439                              <2> 
  8440                              <2> 
  8441                              <2> 
  8442                              <2> 
  8443                              <2>  %ifidni %1, cs
  8444                              <2>  o16 push %1
  8445                              <2>  %elifidni %1, ds
  8446                              <2>  o16 push %1
  8447                              <2>  %elifidni %1, es
  8448                              <2>  o16 push %1
  8449                              <2>  %elifidni %1, fs
  8450                              <2>  o16 push %1
  8451                              <2>  %elifidni %1, gs
  8452                              <2>  o16 push %1
  8453                              <2>  %elifidni %1, word cs
  8454                              <2>  o16 push %1
  8455                              <2>  %elifidni %1, word ds
  8456                              <2>  o16 push %1
  8457                              <2>  %elifidni %1, word es
  8458                              <2>  o16 push %1
  8459                              <2>  %elifidni %1, word fs
  8460                              <2>  o16 push %1
  8461                              <2>  %elifidni %1, word gs
  8462                              <2>  o16 push %1
  8463                              <2>  %else
  8464 000009AA 66FF7512            <2>  push %1
  8465                              <2>  %endif
  8466                              <2> 
  8467                              <2>  %rotate -1
  8468                              <2> 
  8469                              <2> 
  8470                              <2> 
  8471                              <2> 
  8472                              <2> 
  8473                              <2> 
  8474                              <2> 
  8475                              <2>  %ifidni %1, cs
  8476                              <2>  o16 push %1
  8477                              <2>  %elifidni %1, ds
  8478                              <2>  o16 push %1
  8479                              <2>  %elifidni %1, es
  8480                              <2>  o16 push %1
  8481                              <2>  %elifidni %1, fs
  8482                              <2>  o16 push %1
  8483                              <2>  %elifidni %1, gs
  8484                              <2>  o16 push %1
  8485                              <2>  %elifidni %1, word cs
  8486                              <2>  o16 push %1
  8487                              <2>  %elifidni %1, word ds
  8488                              <2>  o16 push %1
  8489                              <2>  %elifidni %1, word es
  8490                              <2>  o16 push %1
  8491                              <2>  %elifidni %1, word fs
  8492                              <2>  o16 push %1
  8493                              <2>  %elifidni %1, word gs
  8494                              <2>  o16 push %1
  8495                              <2>  %else
  8496 000009AE 66FF7510            <2>  push %1
  8497                              <2>  %endif
  8498                              <2> 
  8499                              <2>  %rotate -1
  8500                              <2> 
  8501                              <2> 
  8502                              <2> 
  8503                              <2> 
  8504                              <2> 
  8505                              <2> 
  8506                              <2> 
  8507                              <2>  %ifidni %1, cs
  8508                              <2>  o16 push %1
  8509                              <2>  %elifidni %1, ds
  8510                              <2>  o16 push %1
  8511                              <2>  %elifidni %1, es
  8512                              <2>  o16 push %1
  8513                              <2>  %elifidni %1, fs
  8514                              <2>  o16 push %1
  8515                              <2>  %elifidni %1, gs
  8516                              <2>  o16 push %1
  8517                              <2>  %elifidni %1, word cs
  8518                              <2>  o16 push %1
  8519                              <2>  %elifidni %1, word ds
  8520                              <2>  o16 push %1
  8521                              <2>  %elifidni %1, word es
  8522                              <2>  o16 push %1
  8523                              <2>  %elifidni %1, word fs
  8524                              <2>  o16 push %1
  8525                              <2>  %elifidni %1, word gs
  8526                              <2>  o16 push %1
  8527                              <2>  %else
  8528 000009B2 FF7508              <2>  push %1
  8529                              <2>  %endif
  8530                              <2> 
  8531                              <2>  %rotate -1
  8532 000009B5 E841F8FFFF          <1> call %1
  8533                              <1> %if (%0!=1)
  8534 000009BA 83C40C              <1>  add esp, byte %1_arglen
  8535                              <1> %endif
  8536 000009BD 0F6EC8                  	movd	mm1, eax			
  8537 000009C0 0FEFC0                  	pxor	mm0, mm0
  8538 000009C3 0F60C8                  	punpcklbw	mm1, mm0
  8539                                  	
  8540 000009C6 46                      	inc	esi				; top neighbor
  8541                                  	invoke  _GetPixel, dword [ebp+.SrcOff], word [ebp+.DestWidth], word [ebp+.DestHeight], si, di
  8542                              <1> %rotate -1
  8543                              <1> 
  8544                              <1> %rep (%0-1)
  8545                              <1> 
  8546                              <1> 
  8547                              <1> 
  8548                              <1> 
  8549                              <1> 
  8550                              <1> 
  8551                              <1> 
  8552                              <1>  %ifidni %1, cs
  8553                              <1>  o16 push %1
  8554                              <1>  %elifidni %1, ds
  8555                              <1>  o16 push %1
  8556                              <1>  %elifidni %1, es
  8557                              <1>  o16 push %1
  8558                              <1>  %elifidni %1, fs
  8559                              <1>  o16 push %1
  8560                              <1>  %elifidni %1, gs
  8561                              <1>  o16 push %1
  8562                              <1>  %elifidni %1, word cs
  8563                              <1>  o16 push %1
  8564                              <1>  %elifidni %1, word ds
  8565                              <1>  o16 push %1
  8566                              <1>  %elifidni %1, word es
  8567                              <1>  o16 push %1
  8568                              <1>  %elifidni %1, word fs
  8569                              <1>  o16 push %1
  8570                              <1>  %elifidni %1, word gs
  8571                              <1>  o16 push %1
  8572                              <1>  %else
  8573                              <1>  push %1
  8574                              <1>  %endif
  8575                              <1> 
  8576                              <1>  %rotate -1
  8577                              <1> %endrep
  8578                              <2> 
  8579                              <2> 
  8580                              <2> 
  8581                              <2> 
  8582                              <2> 
  8583                              <2> 
  8584                              <2> 
  8585                              <2>  %ifidni %1, cs
  8586                              <2>  o16 push %1
  8587                              <2>  %elifidni %1, ds
  8588                              <2>  o16 push %1
  8589                              <2>  %elifidni %1, es
  8590                              <2>  o16 push %1
  8591                              <2>  %elifidni %1, fs
  8592                              <2>  o16 push %1
  8593                              <2>  %elifidni %1, gs
  8594                              <2>  o16 push %1
  8595                              <2>  %elifidni %1, word cs
  8596                              <2>  o16 push %1
  8597                              <2>  %elifidni %1, word ds
  8598                              <2>  o16 push %1
  8599                              <2>  %elifidni %1, word es
  8600                              <2>  o16 push %1
  8601                              <2>  %elifidni %1, word fs
  8602                              <2>  o16 push %1
  8603                              <2>  %elifidni %1, word gs
  8604                              <2>  o16 push %1
  8605                              <2>  %else
  8606 000009C7 6657                <2>  push %1
  8607                              <2>  %endif
  8608                              <2> 
  8609                              <2>  %rotate -1
  8610                              <2> 
  8611                              <2> 
  8612                              <2> 
  8613                              <2> 
  8614                              <2> 
  8615                              <2> 
  8616                              <2> 
  8617                              <2>  %ifidni %1, cs
  8618                              <2>  o16 push %1
  8619                              <2>  %elifidni %1, ds
  8620                              <2>  o16 push %1
  8621                              <2>  %elifidni %1, es
  8622                              <2>  o16 push %1
  8623                              <2>  %elifidni %1, fs
  8624                              <2>  o16 push %1
  8625                              <2>  %elifidni %1, gs
  8626                              <2>  o16 push %1
  8627                              <2>  %elifidni %1, word cs
  8628                              <2>  o16 push %1
  8629                              <2>  %elifidni %1, word ds
  8630                              <2>  o16 push %1
  8631                              <2>  %elifidni %1, word es
  8632                              <2>  o16 push %1
  8633                              <2>  %elifidni %1, word fs
  8634                              <2>  o16 push %1
  8635                              <2>  %elifidni %1, word gs
  8636                              <2>  o16 push %1
  8637                              <2>  %else
  8638 000009C9 6656                <2>  push %1
  8639                              <2>  %endif
  8640                              <2> 
  8641                              <2>  %rotate -1
  8642                              <2> 
  8643                              <2> 
  8644                              <2> 
  8645                              <2> 
  8646                              <2> 
  8647                              <2> 
  8648                              <2> 
  8649                              <2>  %ifidni %1, cs
  8650                              <2>  o16 push %1
  8651                              <2>  %elifidni %1, ds
  8652                              <2>  o16 push %1
  8653                              <2>  %elifidni %1, es
  8654                              <2>  o16 push %1
  8655                              <2>  %elifidni %1, fs
  8656                              <2>  o16 push %1
  8657                              <2>  %elifidni %1, gs
  8658                              <2>  o16 push %1
  8659                              <2>  %elifidni %1, word cs
  8660                              <2>  o16 push %1
  8661                              <2>  %elifidni %1, word ds
  8662                              <2>  o16 push %1
  8663                              <2>  %elifidni %1, word es
  8664                              <2>  o16 push %1
  8665                              <2>  %elifidni %1, word fs
  8666                              <2>  o16 push %1
  8667                              <2>  %elifidni %1, word gs
  8668                              <2>  o16 push %1
  8669                              <2>  %else
  8670 000009CB 66FF7512            <2>  push %1
  8671                              <2>  %endif
  8672                              <2> 
  8673                              <2>  %rotate -1
  8674                              <2> 
  8675                              <2> 
  8676                              <2> 
  8677                              <2> 
  8678                              <2> 
  8679                              <2> 
  8680                              <2> 
  8681                              <2>  %ifidni %1, cs
  8682                              <2>  o16 push %1
  8683                              <2>  %elifidni %1, ds
  8684                              <2>  o16 push %1
  8685                              <2>  %elifidni %1, es
  8686                              <2>  o16 push %1
  8687                              <2>  %elifidni %1, fs
  8688                              <2>  o16 push %1
  8689                              <2>  %elifidni %1, gs
  8690                              <2>  o16 push %1
  8691                              <2>  %elifidni %1, word cs
  8692                              <2>  o16 push %1
  8693                              <2>  %elifidni %1, word ds
  8694                              <2>  o16 push %1
  8695                              <2>  %elifidni %1, word es
  8696                              <2>  o16 push %1
  8697                              <2>  %elifidni %1, word fs
  8698                              <2>  o16 push %1
  8699                              <2>  %elifidni %1, word gs
  8700                              <2>  o16 push %1
  8701                              <2>  %else
  8702 000009CF 66FF7510            <2>  push %1
  8703                              <2>  %endif
  8704                              <2> 
  8705                              <2>  %rotate -1
  8706                              <2> 
  8707                              <2> 
  8708                              <2> 
  8709                              <2> 
  8710                              <2> 
  8711                              <2> 
  8712                              <2> 
  8713                              <2>  %ifidni %1, cs
  8714                              <2>  o16 push %1
  8715                              <2>  %elifidni %1, ds
  8716                              <2>  o16 push %1
  8717                              <2>  %elifidni %1, es
  8718                              <2>  o16 push %1
  8719                              <2>  %elifidni %1, fs
  8720                              <2>  o16 push %1
  8721                              <2>  %elifidni %1, gs
  8722                              <2>  o16 push %1
  8723                              <2>  %elifidni %1, word cs
  8724                              <2>  o16 push %1
  8725                              <2>  %elifidni %1, word ds
  8726                              <2>  o16 push %1
  8727                              <2>  %elifidni %1, word es
  8728                              <2>  o16 push %1
  8729                              <2>  %elifidni %1, word fs
  8730                              <2>  o16 push %1
  8731                              <2>  %elifidni %1, word gs
  8732                              <2>  o16 push %1
  8733                              <2>  %else
  8734 000009D3 FF7508              <2>  push %1
  8735                              <2>  %endif
  8736                              <2> 
  8737                              <2>  %rotate -1
  8738 000009D6 E820F8FFFF          <1> call %1
  8739                              <1> %if (%0!=1)
  8740 000009DB 83C40C              <1>  add esp, byte %1_arglen
  8741                              <1> %endif
  8742 000009DE 0F6ED0                  	movd	mm2, eax
  8743 000009E1 0F60D0                  	punpcklbw	mm2, mm0
  8744 000009E4 0F71F201                	psllw	mm2, 1
  8745 000009E8 0FFDCA                  	paddw	mm1, mm2			
  8746                                  	
  8747 000009EB 46                      	inc	esi				; upper-right neighbor
  8748                                  	invoke  _GetPixel, dword [ebp+.SrcOff], word [ebp+.DestWidth], word [ebp+.DestHeight], si, di
  8749                              <1> %rotate -1
  8750                              <1> 
  8751                              <1> %rep (%0-1)
  8752                              <1> 
  8753                              <1> 
  8754                              <1> 
  8755                              <1> 
  8756                              <1> 
  8757                              <1> 
  8758                              <1> 
  8759                              <1>  %ifidni %1, cs
  8760                              <1>  o16 push %1
  8761                              <1>  %elifidni %1, ds
  8762                              <1>  o16 push %1
  8763                              <1>  %elifidni %1, es
  8764                              <1>  o16 push %1
  8765                              <1>  %elifidni %1, fs
  8766                              <1>  o16 push %1
  8767                              <1>  %elifidni %1, gs
  8768                              <1>  o16 push %1
  8769                              <1>  %elifidni %1, word cs
  8770                              <1>  o16 push %1
  8771                              <1>  %elifidni %1, word ds
  8772                              <1>  o16 push %1
  8773                              <1>  %elifidni %1, word es
  8774                              <1>  o16 push %1
  8775                              <1>  %elifidni %1, word fs
  8776                              <1>  o16 push %1
  8777                              <1>  %elifidni %1, word gs
  8778                              <1>  o16 push %1
  8779                              <1>  %else
  8780                              <1>  push %1
  8781                              <1>  %endif
  8782                              <1> 
  8783                              <1>  %rotate -1
  8784                              <1> %endrep
  8785                              <2> 
  8786                              <2> 
  8787                              <2> 
  8788                              <2> 
  8789                              <2> 
  8790                              <2> 
  8791                              <2> 
  8792                              <2>  %ifidni %1, cs
  8793                              <2>  o16 push %1
  8794                              <2>  %elifidni %1, ds
  8795                              <2>  o16 push %1
  8796                              <2>  %elifidni %1, es
  8797                              <2>  o16 push %1
  8798                              <2>  %elifidni %1, fs
  8799                              <2>  o16 push %1
  8800                              <2>  %elifidni %1, gs
  8801                              <2>  o16 push %1
  8802                              <2>  %elifidni %1, word cs
  8803                              <2>  o16 push %1
  8804                              <2>  %elifidni %1, word ds
  8805                              <2>  o16 push %1
  8806                              <2>  %elifidni %1, word es
  8807                              <2>  o16 push %1
  8808                              <2>  %elifidni %1, word fs
  8809                              <2>  o16 push %1
  8810                              <2>  %elifidni %1, word gs
  8811                              <2>  o16 push %1
  8812                              <2>  %else
  8813 000009EC 6657                <2>  push %1
  8814                              <2>  %endif
  8815                              <2> 
  8816                              <2>  %rotate -1
  8817                              <2> 
  8818                              <2> 
  8819                              <2> 
  8820                              <2> 
  8821                              <2> 
  8822                              <2> 
  8823                              <2> 
  8824                              <2>  %ifidni %1, cs
  8825                              <2>  o16 push %1
  8826                              <2>  %elifidni %1, ds
  8827                              <2>  o16 push %1
  8828                              <2>  %elifidni %1, es
  8829                              <2>  o16 push %1
  8830                              <2>  %elifidni %1, fs
  8831                              <2>  o16 push %1
  8832                              <2>  %elifidni %1, gs
  8833                              <2>  o16 push %1
  8834                              <2>  %elifidni %1, word cs
  8835                              <2>  o16 push %1
  8836                              <2>  %elifidni %1, word ds
  8837                              <2>  o16 push %1
  8838                              <2>  %elifidni %1, word es
  8839                              <2>  o16 push %1
  8840                              <2>  %elifidni %1, word fs
  8841                              <2>  o16 push %1
  8842                              <2>  %elifidni %1, word gs
  8843                              <2>  o16 push %1
  8844                              <2>  %else
  8845 000009EE 6656                <2>  push %1
  8846                              <2>  %endif
  8847                              <2> 
  8848                              <2>  %rotate -1
  8849                              <2> 
  8850                              <2> 
  8851                              <2> 
  8852                              <2> 
  8853                              <2> 
  8854                              <2> 
  8855                              <2> 
  8856                              <2>  %ifidni %1, cs
  8857                              <2>  o16 push %1
  8858                              <2>  %elifidni %1, ds
  8859                              <2>  o16 push %1
  8860                              <2>  %elifidni %1, es
  8861                              <2>  o16 push %1
  8862                              <2>  %elifidni %1, fs
  8863                              <2>  o16 push %1
  8864                              <2>  %elifidni %1, gs
  8865                              <2>  o16 push %1
  8866                              <2>  %elifidni %1, word cs
  8867                              <2>  o16 push %1
  8868                              <2>  %elifidni %1, word ds
  8869                              <2>  o16 push %1
  8870                              <2>  %elifidni %1, word es
  8871                              <2>  o16 push %1
  8872                              <2>  %elifidni %1, word fs
  8873                              <2>  o16 push %1
  8874                              <2>  %elifidni %1, word gs
  8875                              <2>  o16 push %1
  8876                              <2>  %else
  8877 000009F0 66FF7512            <2>  push %1
  8878                              <2>  %endif
  8879                              <2> 
  8880                              <2>  %rotate -1
  8881                              <2> 
  8882                              <2> 
  8883                              <2> 
  8884                              <2> 
  8885                              <2> 
  8886                              <2> 
  8887                              <2> 
  8888                              <2>  %ifidni %1, cs
  8889                              <2>  o16 push %1
  8890                              <2>  %elifidni %1, ds
  8891                              <2>  o16 push %1
  8892                              <2>  %elifidni %1, es
  8893                              <2>  o16 push %1
  8894                              <2>  %elifidni %1, fs
  8895                              <2>  o16 push %1
  8896                              <2>  %elifidni %1, gs
  8897                              <2>  o16 push %1
  8898                              <2>  %elifidni %1, word cs
  8899                              <2>  o16 push %1
  8900                              <2>  %elifidni %1, word ds
  8901                              <2>  o16 push %1
  8902                              <2>  %elifidni %1, word es
  8903                              <2>  o16 push %1
  8904                              <2>  %elifidni %1, word fs
  8905                              <2>  o16 push %1
  8906                              <2>  %elifidni %1, word gs
  8907                              <2>  o16 push %1
  8908                              <2>  %else
  8909 000009F4 66FF7510            <2>  push %1
  8910                              <2>  %endif
  8911                              <2> 
  8912                              <2>  %rotate -1
  8913                              <2> 
  8914                              <2> 
  8915                              <2> 
  8916                              <2> 
  8917                              <2> 
  8918                              <2> 
  8919                              <2> 
  8920                              <2>  %ifidni %1, cs
  8921                              <2>  o16 push %1
  8922                              <2>  %elifidni %1, ds
  8923                              <2>  o16 push %1
  8924                              <2>  %elifidni %1, es
  8925                              <2>  o16 push %1
  8926                              <2>  %elifidni %1, fs
  8927                              <2>  o16 push %1
  8928                              <2>  %elifidni %1, gs
  8929                              <2>  o16 push %1
  8930                              <2>  %elifidni %1, word cs
  8931                              <2>  o16 push %1
  8932                              <2>  %elifidni %1, word ds
  8933                              <2>  o16 push %1
  8934                              <2>  %elifidni %1, word es
  8935                              <2>  o16 push %1
  8936                              <2>  %elifidni %1, word fs
  8937                              <2>  o16 push %1
  8938                              <2>  %elifidni %1, word gs
  8939                              <2>  o16 push %1
  8940                              <2>  %else
  8941 000009F8 FF7508              <2>  push %1
  8942                              <2>  %endif
  8943                              <2> 
  8944                              <2>  %rotate -1
  8945 000009FB E8FBF7FFFF          <1> call %1
  8946                              <1> %if (%0!=1)
  8947 00000A00 83C40C              <1>  add esp, byte %1_arglen
  8948                              <1> %endif
  8949 00000A03 0F6ED0                  	movd	mm2, eax
  8950 00000A06 0F60D0                  	punpcklbw	mm2, mm0
  8951 00000A09 0FFDCA                  	paddw	mm1, mm2			
  8952                                  	
  8953 00000A0C 47                      	inc	edi				; left neighbor
  8954                                  	invoke  _GetPixel, dword [ebp+.SrcOff], word [ebp+.DestWidth], word [ebp+.DestHeight], si, di
  8955                              <1> %rotate -1
  8956                              <1> 
  8957                              <1> %rep (%0-1)
  8958                              <1> 
  8959                              <1> 
  8960                              <1> 
  8961                              <1> 
  8962                              <1> 
  8963                              <1> 
  8964                              <1> 
  8965                              <1>  %ifidni %1, cs
  8966                              <1>  o16 push %1
  8967                              <1>  %elifidni %1, ds
  8968                              <1>  o16 push %1
  8969                              <1>  %elifidni %1, es
  8970                              <1>  o16 push %1
  8971                              <1>  %elifidni %1, fs
  8972                              <1>  o16 push %1
  8973                              <1>  %elifidni %1, gs
  8974                              <1>  o16 push %1
  8975                              <1>  %elifidni %1, word cs
  8976                              <1>  o16 push %1
  8977                              <1>  %elifidni %1, word ds
  8978                              <1>  o16 push %1
  8979                              <1>  %elifidni %1, word es
  8980                              <1>  o16 push %1
  8981                              <1>  %elifidni %1, word fs
  8982                              <1>  o16 push %1
  8983                              <1>  %elifidni %1, word gs
  8984                              <1>  o16 push %1
  8985                              <1>  %else
  8986                              <1>  push %1
  8987                              <1>  %endif
  8988                              <1> 
  8989                              <1>  %rotate -1
  8990                              <1> %endrep
  8991                              <2> 
  8992                              <2> 
  8993                              <2> 
  8994                              <2> 
  8995                              <2> 
  8996                              <2> 
  8997                              <2> 
  8998                              <2>  %ifidni %1, cs
  8999                              <2>  o16 push %1
  9000                              <2>  %elifidni %1, ds
  9001                              <2>  o16 push %1
  9002                              <2>  %elifidni %1, es
  9003                              <2>  o16 push %1
  9004                              <2>  %elifidni %1, fs
  9005                              <2>  o16 push %1
  9006                              <2>  %elifidni %1, gs
  9007                              <2>  o16 push %1
  9008                              <2>  %elifidni %1, word cs
  9009                              <2>  o16 push %1
  9010                              <2>  %elifidni %1, word ds
  9011                              <2>  o16 push %1
  9012                              <2>  %elifidni %1, word es
  9013                              <2>  o16 push %1
  9014                              <2>  %elifidni %1, word fs
  9015                              <2>  o16 push %1
  9016                              <2>  %elifidni %1, word gs
  9017                              <2>  o16 push %1
  9018                              <2>  %else
  9019 00000A0D 6657                <2>  push %1
  9020                              <2>  %endif
  9021                              <2> 
  9022                              <2>  %rotate -1
  9023                              <2> 
  9024                              <2> 
  9025                              <2> 
  9026                              <2> 
  9027                              <2> 
  9028                              <2> 
  9029                              <2> 
  9030                              <2>  %ifidni %1, cs
  9031                              <2>  o16 push %1
  9032                              <2>  %elifidni %1, ds
  9033                              <2>  o16 push %1
  9034                              <2>  %elifidni %1, es
  9035                              <2>  o16 push %1
  9036                              <2>  %elifidni %1, fs
  9037                              <2>  o16 push %1
  9038                              <2>  %elifidni %1, gs
  9039                              <2>  o16 push %1
  9040                              <2>  %elifidni %1, word cs
  9041                              <2>  o16 push %1
  9042                              <2>  %elifidni %1, word ds
  9043                              <2>  o16 push %1
  9044                              <2>  %elifidni %1, word es
  9045                              <2>  o16 push %1
  9046                              <2>  %elifidni %1, word fs
  9047                              <2>  o16 push %1
  9048                              <2>  %elifidni %1, word gs
  9049                              <2>  o16 push %1
  9050                              <2>  %else
  9051 00000A0F 6656                <2>  push %1
  9052                              <2>  %endif
  9053                              <2> 
  9054                              <2>  %rotate -1
  9055                              <2> 
  9056                              <2> 
  9057                              <2> 
  9058                              <2> 
  9059                              <2> 
  9060                              <2> 
  9061                              <2> 
  9062                              <2>  %ifidni %1, cs
  9063                              <2>  o16 push %1
  9064                              <2>  %elifidni %1, ds
  9065                              <2>  o16 push %1
  9066                              <2>  %elifidni %1, es
  9067                              <2>  o16 push %1
  9068                              <2>  %elifidni %1, fs
  9069                              <2>  o16 push %1
  9070                              <2>  %elifidni %1, gs
  9071                              <2>  o16 push %1
  9072                              <2>  %elifidni %1, word cs
  9073                              <2>  o16 push %1
  9074                              <2>  %elifidni %1, word ds
  9075                              <2>  o16 push %1
  9076                              <2>  %elifidni %1, word es
  9077                              <2>  o16 push %1
  9078                              <2>  %elifidni %1, word fs
  9079                              <2>  o16 push %1
  9080                              <2>  %elifidni %1, word gs
  9081                              <2>  o16 push %1
  9082                              <2>  %else
  9083 00000A11 66FF7512            <2>  push %1
  9084                              <2>  %endif
  9085                              <2> 
  9086                              <2>  %rotate -1
  9087                              <2> 
  9088                              <2> 
  9089                              <2> 
  9090                              <2> 
  9091                              <2> 
  9092                              <2> 
  9093                              <2> 
  9094                              <2>  %ifidni %1, cs
  9095                              <2>  o16 push %1
  9096                              <2>  %elifidni %1, ds
  9097                              <2>  o16 push %1
  9098                              <2>  %elifidni %1, es
  9099                              <2>  o16 push %1
  9100                              <2>  %elifidni %1, fs
  9101                              <2>  o16 push %1
  9102                              <2>  %elifidni %1, gs
  9103                              <2>  o16 push %1
  9104                              <2>  %elifidni %1, word cs
  9105                              <2>  o16 push %1
  9106                              <2>  %elifidni %1, word ds
  9107                              <2>  o16 push %1
  9108                              <2>  %elifidni %1, word es
  9109                              <2>  o16 push %1
  9110                              <2>  %elifidni %1, word fs
  9111                              <2>  o16 push %1
  9112                              <2>  %elifidni %1, word gs
  9113                              <2>  o16 push %1
  9114                              <2>  %else
  9115 00000A15 66FF7510            <2>  push %1
  9116                              <2>  %endif
  9117                              <2> 
  9118                              <2>  %rotate -1
  9119                              <2> 
  9120                              <2> 
  9121                              <2> 
  9122                              <2> 
  9123                              <2> 
  9124                              <2> 
  9125                              <2> 
  9126                              <2>  %ifidni %1, cs
  9127                              <2>  o16 push %1
  9128                              <2>  %elifidni %1, ds
  9129                              <2>  o16 push %1
  9130                              <2>  %elifidni %1, es
  9131                              <2>  o16 push %1
  9132                              <2>  %elifidni %1, fs
  9133                              <2>  o16 push %1
  9134                              <2>  %elifidni %1, gs
  9135                              <2>  o16 push %1
  9136                              <2>  %elifidni %1, word cs
  9137                              <2>  o16 push %1
  9138                              <2>  %elifidni %1, word ds
  9139                              <2>  o16 push %1
  9140                              <2>  %elifidni %1, word es
  9141                              <2>  o16 push %1
  9142                              <2>  %elifidni %1, word fs
  9143                              <2>  o16 push %1
  9144                              <2>  %elifidni %1, word gs
  9145                              <2>  o16 push %1
  9146                              <2>  %else
  9147 00000A19 FF7508              <2>  push %1
  9148                              <2>  %endif
  9149                              <2> 
  9150                              <2>  %rotate -1
  9151 00000A1C E8DAF7FFFF          <1> call %1
  9152                              <1> %if (%0!=1)
  9153 00000A21 83C40C              <1>  add esp, byte %1_arglen
  9154                              <1> %endif
  9155 00000A24 0F6ED0                  	movd	mm2, eax
  9156 00000A27 0F60D0                  	punpcklbw	mm2, mm0
  9157 00000A2A 0F71F201                	psllw	mm2, 1
  9158 00000A2E 0FFDCA                  	paddw	mm1, mm2			
  9159                                  	
  9160 00000A31 4E                      	dec	esi				; current pixel
  9161                                  	invoke  _GetPixel, dword [ebp+.SrcOff], word [ebp+.DestWidth], word [ebp+.DestHeight], si, di
  9162                              <1> %rotate -1
  9163                              <1> 
  9164                              <1> %rep (%0-1)
  9165                              <1> 
  9166                              <1> 
  9167                              <1> 
  9168                              <1> 
  9169                              <1> 
  9170                              <1> 
  9171                              <1> 
  9172                              <1>  %ifidni %1, cs
  9173                              <1>  o16 push %1
  9174                              <1>  %elifidni %1, ds
  9175                              <1>  o16 push %1
  9176                              <1>  %elifidni %1, es
  9177                              <1>  o16 push %1
  9178                              <1>  %elifidni %1, fs
  9179                              <1>  o16 push %1
  9180                              <1>  %elifidni %1, gs
  9181                              <1>  o16 push %1
  9182                              <1>  %elifidni %1, word cs
  9183                              <1>  o16 push %1
  9184                              <1>  %elifidni %1, word ds
  9185                              <1>  o16 push %1
  9186                              <1>  %elifidni %1, word es
  9187                              <1>  o16 push %1
  9188                              <1>  %elifidni %1, word fs
  9189                              <1>  o16 push %1
  9190                              <1>  %elifidni %1, word gs
  9191                              <1>  o16 push %1
  9192                              <1>  %else
  9193                              <1>  push %1
  9194                              <1>  %endif
  9195                              <1> 
  9196                              <1>  %rotate -1
  9197                              <1> %endrep
  9198                              <2> 
  9199                              <2> 
  9200                              <2> 
  9201                              <2> 
  9202                              <2> 
  9203                              <2> 
  9204                              <2> 
  9205                              <2>  %ifidni %1, cs
  9206                              <2>  o16 push %1
  9207                              <2>  %elifidni %1, ds
  9208                              <2>  o16 push %1
  9209                              <2>  %elifidni %1, es
  9210                              <2>  o16 push %1
  9211                              <2>  %elifidni %1, fs
  9212                              <2>  o16 push %1
  9213                              <2>  %elifidni %1, gs
  9214                              <2>  o16 push %1
  9215                              <2>  %elifidni %1, word cs
  9216                              <2>  o16 push %1
  9217                              <2>  %elifidni %1, word ds
  9218                              <2>  o16 push %1
  9219                              <2>  %elifidni %1, word es
  9220                              <2>  o16 push %1
  9221                              <2>  %elifidni %1, word fs
  9222                              <2>  o16 push %1
  9223                              <2>  %elifidni %1, word gs
  9224                              <2>  o16 push %1
  9225                              <2>  %else
  9226 00000A32 6657                <2>  push %1
  9227                              <2>  %endif
  9228                              <2> 
  9229                              <2>  %rotate -1
  9230                              <2> 
  9231                              <2> 
  9232                              <2> 
  9233                              <2> 
  9234                              <2> 
  9235                              <2> 
  9236                              <2> 
  9237                              <2>  %ifidni %1, cs
  9238                              <2>  o16 push %1
  9239                              <2>  %elifidni %1, ds
  9240                              <2>  o16 push %1
  9241                              <2>  %elifidni %1, es
  9242                              <2>  o16 push %1
  9243                              <2>  %elifidni %1, fs
  9244                              <2>  o16 push %1
  9245                              <2>  %elifidni %1, gs
  9246                              <2>  o16 push %1
  9247                              <2>  %elifidni %1, word cs
  9248                              <2>  o16 push %1
  9249                              <2>  %elifidni %1, word ds
  9250                              <2>  o16 push %1
  9251                              <2>  %elifidni %1, word es
  9252                              <2>  o16 push %1
  9253                              <2>  %elifidni %1, word fs
  9254                              <2>  o16 push %1
  9255                              <2>  %elifidni %1, word gs
  9256                              <2>  o16 push %1
  9257                              <2>  %else
  9258 00000A34 6656                <2>  push %1
  9259                              <2>  %endif
  9260                              <2> 
  9261                              <2>  %rotate -1
  9262                              <2> 
  9263                              <2> 
  9264                              <2> 
  9265                              <2> 
  9266                              <2> 
  9267                              <2> 
  9268                              <2> 
  9269                              <2>  %ifidni %1, cs
  9270                              <2>  o16 push %1
  9271                              <2>  %elifidni %1, ds
  9272                              <2>  o16 push %1
  9273                              <2>  %elifidni %1, es
  9274                              <2>  o16 push %1
  9275                              <2>  %elifidni %1, fs
  9276                              <2>  o16 push %1
  9277                              <2>  %elifidni %1, gs
  9278                              <2>  o16 push %1
  9279                              <2>  %elifidni %1, word cs
  9280                              <2>  o16 push %1
  9281                              <2>  %elifidni %1, word ds
  9282                              <2>  o16 push %1
  9283                              <2>  %elifidni %1, word es
  9284                              <2>  o16 push %1
  9285                              <2>  %elifidni %1, word fs
  9286                              <2>  o16 push %1
  9287                              <2>  %elifidni %1, word gs
  9288                              <2>  o16 push %1
  9289                              <2>  %else
  9290 00000A36 66FF7512            <2>  push %1
  9291                              <2>  %endif
  9292                              <2> 
  9293                              <2>  %rotate -1
  9294                              <2> 
  9295                              <2> 
  9296                              <2> 
  9297                              <2> 
  9298                              <2> 
  9299                              <2> 
  9300                              <2> 
  9301                              <2>  %ifidni %1, cs
  9302                              <2>  o16 push %1
  9303                              <2>  %elifidni %1, ds
  9304                              <2>  o16 push %1
  9305                              <2>  %elifidni %1, es
  9306                              <2>  o16 push %1
  9307                              <2>  %elifidni %1, fs
  9308                              <2>  o16 push %1
  9309                              <2>  %elifidni %1, gs
  9310                              <2>  o16 push %1
  9311                              <2>  %elifidni %1, word cs
  9312                              <2>  o16 push %1
  9313                              <2>  %elifidni %1, word ds
  9314                              <2>  o16 push %1
  9315                              <2>  %elifidni %1, word es
  9316                              <2>  o16 push %1
  9317                              <2>  %elifidni %1, word fs
  9318                              <2>  o16 push %1
  9319                              <2>  %elifidni %1, word gs
  9320                              <2>  o16 push %1
  9321                              <2>  %else
  9322 00000A3A 66FF7510            <2>  push %1
  9323                              <2>  %endif
  9324                              <2> 
  9325                              <2>  %rotate -1
  9326                              <2> 
  9327                              <2> 
  9328                              <2> 
  9329                              <2> 
  9330                              <2> 
  9331                              <2> 
  9332                              <2> 
  9333                              <2>  %ifidni %1, cs
  9334                              <2>  o16 push %1
  9335                              <2>  %elifidni %1, ds
  9336                              <2>  o16 push %1
  9337                              <2>  %elifidni %1, es
  9338                              <2>  o16 push %1
  9339                              <2>  %elifidni %1, fs
  9340                              <2>  o16 push %1
  9341                              <2>  %elifidni %1, gs
  9342                              <2>  o16 push %1
  9343                              <2>  %elifidni %1, word cs
  9344                              <2>  o16 push %1
  9345                              <2>  %elifidni %1, word ds
  9346                              <2>  o16 push %1
  9347                              <2>  %elifidni %1, word es
  9348                              <2>  o16 push %1
  9349                              <2>  %elifidni %1, word fs
  9350                              <2>  o16 push %1
  9351                              <2>  %elifidni %1, word gs
  9352                              <2>  o16 push %1
  9353                              <2>  %else
  9354 00000A3E FF7508              <2>  push %1
  9355                              <2>  %endif
  9356                              <2> 
  9357                              <2>  %rotate -1
  9358 00000A41 E8B5F7FFFF          <1> call %1
  9359                              <1> %if (%0!=1)
  9360 00000A46 83C40C              <1>  add esp, byte %1_arglen
  9361                              <1> %endif
  9362 00000A49 0F6ED0                  	movd	mm2, eax
  9363 00000A4C 0F60D0                  	punpcklbw	mm2, mm0
  9364 00000A4F 0F71F202                	psllw	mm2, 2
  9365 00000A53 0FFDCA                  	paddw	mm1, mm2			
  9366                                  	
  9367 00000A56 4E                      	dec	esi				; right neighbor
  9368                                  	invoke  _GetPixel, dword [ebp+.SrcOff], word [ebp+.DestWidth], word [ebp+.DestHeight], si, di
  9369                              <1> %rotate -1
  9370                              <1> 
  9371                              <1> %rep (%0-1)
  9372                              <1> 
  9373                              <1> 
  9374                              <1> 
  9375                              <1> 
  9376                              <1> 
  9377                              <1> 
  9378                              <1> 
  9379                              <1>  %ifidni %1, cs
  9380                              <1>  o16 push %1
  9381                              <1>  %elifidni %1, ds
  9382                              <1>  o16 push %1
  9383                              <1>  %elifidni %1, es
  9384                              <1>  o16 push %1
  9385                              <1>  %elifidni %1, fs
  9386                              <1>  o16 push %1
  9387                              <1>  %elifidni %1, gs
  9388                              <1>  o16 push %1
  9389                              <1>  %elifidni %1, word cs
  9390                              <1>  o16 push %1
  9391                              <1>  %elifidni %1, word ds
  9392                              <1>  o16 push %1
  9393                              <1>  %elifidni %1, word es
  9394                              <1>  o16 push %1
  9395                              <1>  %elifidni %1, word fs
  9396                              <1>  o16 push %1
  9397                              <1>  %elifidni %1, word gs
  9398                              <1>  o16 push %1
  9399                              <1>  %else
  9400                              <1>  push %1
  9401                              <1>  %endif
  9402                              <1> 
  9403                              <1>  %rotate -1
  9404                              <1> %endrep
  9405                              <2> 
  9406                              <2> 
  9407                              <2> 
  9408                              <2> 
  9409                              <2> 
  9410                              <2> 
  9411                              <2> 
  9412                              <2>  %ifidni %1, cs
  9413                              <2>  o16 push %1
  9414                              <2>  %elifidni %1, ds
  9415                              <2>  o16 push %1
  9416                              <2>  %elifidni %1, es
  9417                              <2>  o16 push %1
  9418                              <2>  %elifidni %1, fs
  9419                              <2>  o16 push %1
  9420                              <2>  %elifidni %1, gs
  9421                              <2>  o16 push %1
  9422                              <2>  %elifidni %1, word cs
  9423                              <2>  o16 push %1
  9424                              <2>  %elifidni %1, word ds
  9425                              <2>  o16 push %1
  9426                              <2>  %elifidni %1, word es
  9427                              <2>  o16 push %1
  9428                              <2>  %elifidni %1, word fs
  9429                              <2>  o16 push %1
  9430                              <2>  %elifidni %1, word gs
  9431                              <2>  o16 push %1
  9432                              <2>  %else
  9433 00000A57 6657                <2>  push %1
  9434                              <2>  %endif
  9435                              <2> 
  9436                              <2>  %rotate -1
  9437                              <2> 
  9438                              <2> 
  9439                              <2> 
  9440                              <2> 
  9441                              <2> 
  9442                              <2> 
  9443                              <2> 
  9444                              <2>  %ifidni %1, cs
  9445                              <2>  o16 push %1
  9446                              <2>  %elifidni %1, ds
  9447                              <2>  o16 push %1
  9448                              <2>  %elifidni %1, es
  9449                              <2>  o16 push %1
  9450                              <2>  %elifidni %1, fs
  9451                              <2>  o16 push %1
  9452                              <2>  %elifidni %1, gs
  9453                              <2>  o16 push %1
  9454                              <2>  %elifidni %1, word cs
  9455                              <2>  o16 push %1
  9456                              <2>  %elifidni %1, word ds
  9457                              <2>  o16 push %1
  9458                              <2>  %elifidni %1, word es
  9459                              <2>  o16 push %1
  9460                              <2>  %elifidni %1, word fs
  9461                              <2>  o16 push %1
  9462                              <2>  %elifidni %1, word gs
  9463                              <2>  o16 push %1
  9464                              <2>  %else
  9465 00000A59 6656                <2>  push %1
  9466                              <2>  %endif
  9467                              <2> 
  9468                              <2>  %rotate -1
  9469                              <2> 
  9470                              <2> 
  9471                              <2> 
  9472                              <2> 
  9473                              <2> 
  9474                              <2> 
  9475                              <2> 
  9476                              <2>  %ifidni %1, cs
  9477                              <2>  o16 push %1
  9478                              <2>  %elifidni %1, ds
  9479                              <2>  o16 push %1
  9480                              <2>  %elifidni %1, es
  9481                              <2>  o16 push %1
  9482                              <2>  %elifidni %1, fs
  9483                              <2>  o16 push %1
  9484                              <2>  %elifidni %1, gs
  9485                              <2>  o16 push %1
  9486                              <2>  %elifidni %1, word cs
  9487                              <2>  o16 push %1
  9488                              <2>  %elifidni %1, word ds
  9489                              <2>  o16 push %1
  9490                              <2>  %elifidni %1, word es
  9491                              <2>  o16 push %1
  9492                              <2>  %elifidni %1, word fs
  9493                              <2>  o16 push %1
  9494                              <2>  %elifidni %1, word gs
  9495                              <2>  o16 push %1
  9496                              <2>  %else
  9497 00000A5B 66FF7512            <2>  push %1
  9498                              <2>  %endif
  9499                              <2> 
  9500                              <2>  %rotate -1
  9501                              <2> 
  9502                              <2> 
  9503                              <2> 
  9504                              <2> 
  9505                              <2> 
  9506                              <2> 
  9507                              <2> 
  9508                              <2>  %ifidni %1, cs
  9509                              <2>  o16 push %1
  9510                              <2>  %elifidni %1, ds
  9511                              <2>  o16 push %1
  9512                              <2>  %elifidni %1, es
  9513                              <2>  o16 push %1
  9514                              <2>  %elifidni %1, fs
  9515                              <2>  o16 push %1
  9516                              <2>  %elifidni %1, gs
  9517                              <2>  o16 push %1
  9518                              <2>  %elifidni %1, word cs
  9519                              <2>  o16 push %1
  9520                              <2>  %elifidni %1, word ds
  9521                              <2>  o16 push %1
  9522                              <2>  %elifidni %1, word es
  9523                              <2>  o16 push %1
  9524                              <2>  %elifidni %1, word fs
  9525                              <2>  o16 push %1
  9526                              <2>  %elifidni %1, word gs
  9527                              <2>  o16 push %1
  9528                              <2>  %else
  9529 00000A5F 66FF7510            <2>  push %1
  9530                              <2>  %endif
  9531                              <2> 
  9532                              <2>  %rotate -1
  9533                              <2> 
  9534                              <2> 
  9535                              <2> 
  9536                              <2> 
  9537                              <2> 
  9538                              <2> 
  9539                              <2> 
  9540                              <2>  %ifidni %1, cs
  9541                              <2>  o16 push %1
  9542                              <2>  %elifidni %1, ds
  9543                              <2>  o16 push %1
  9544                              <2>  %elifidni %1, es
  9545                              <2>  o16 push %1
  9546                              <2>  %elifidni %1, fs
  9547                              <2>  o16 push %1
  9548                              <2>  %elifidni %1, gs
  9549                              <2>  o16 push %1
  9550                              <2>  %elifidni %1, word cs
  9551                              <2>  o16 push %1
  9552                              <2>  %elifidni %1, word ds
  9553                              <2>  o16 push %1
  9554                              <2>  %elifidni %1, word es
  9555                              <2>  o16 push %1
  9556                              <2>  %elifidni %1, word fs
  9557                              <2>  o16 push %1
  9558                              <2>  %elifidni %1, word gs
  9559                              <2>  o16 push %1
  9560                              <2>  %else
  9561 00000A63 FF7508              <2>  push %1
  9562                              <2>  %endif
  9563                              <2> 
  9564                              <2>  %rotate -1
  9565 00000A66 E890F7FFFF          <1> call %1
  9566                              <1> %if (%0!=1)
  9567 00000A6B 83C40C              <1>  add esp, byte %1_arglen
  9568                              <1> %endif
  9569 00000A6E 0F6ED0                  	movd	mm2, eax
  9570 00000A71 0F60D0                  	punpcklbw	mm2, mm0
  9571 00000A74 0F71F201                	psllw	mm2, 1
  9572 00000A78 0FFDCA                  	paddw	mm1, mm2			
  9573                                  	
  9574 00000A7B 47                      	inc	edi				; lower-left neighbor
  9575                                  	invoke  _GetPixel, dword [ebp+.SrcOff], word [ebp+.DestWidth], word [ebp+.DestHeight], si, di
  9576                              <1> %rotate -1
  9577                              <1> 
  9578                              <1> %rep (%0-1)
  9579                              <1> 
  9580                              <1> 
  9581                              <1> 
  9582                              <1> 
  9583                              <1> 
  9584                              <1> 
  9585                              <1> 
  9586                              <1>  %ifidni %1, cs
  9587                              <1>  o16 push %1
  9588                              <1>  %elifidni %1, ds
  9589                              <1>  o16 push %1
  9590                              <1>  %elifidni %1, es
  9591                              <1>  o16 push %1
  9592                              <1>  %elifidni %1, fs
  9593                              <1>  o16 push %1
  9594                              <1>  %elifidni %1, gs
  9595                              <1>  o16 push %1
  9596                              <1>  %elifidni %1, word cs
  9597                              <1>  o16 push %1
  9598                              <1>  %elifidni %1, word ds
  9599                              <1>  o16 push %1
  9600                              <1>  %elifidni %1, word es
  9601                              <1>  o16 push %1
  9602                              <1>  %elifidni %1, word fs
  9603                              <1>  o16 push %1
  9604                              <1>  %elifidni %1, word gs
  9605                              <1>  o16 push %1
  9606                              <1>  %else
  9607                              <1>  push %1
  9608                              <1>  %endif
  9609                              <1> 
  9610                              <1>  %rotate -1
  9611                              <1> %endrep
  9612                              <2> 
  9613                              <2> 
  9614                              <2> 
  9615                              <2> 
  9616                              <2> 
  9617                              <2> 
  9618                              <2> 
  9619                              <2>  %ifidni %1, cs
  9620                              <2>  o16 push %1
  9621                              <2>  %elifidni %1, ds
  9622                              <2>  o16 push %1
  9623                              <2>  %elifidni %1, es
  9624                              <2>  o16 push %1
  9625                              <2>  %elifidni %1, fs
  9626                              <2>  o16 push %1
  9627                              <2>  %elifidni %1, gs
  9628                              <2>  o16 push %1
  9629                              <2>  %elifidni %1, word cs
  9630                              <2>  o16 push %1
  9631                              <2>  %elifidni %1, word ds
  9632                              <2>  o16 push %1
  9633                              <2>  %elifidni %1, word es
  9634                              <2>  o16 push %1
  9635                              <2>  %elifidni %1, word fs
  9636                              <2>  o16 push %1
  9637                              <2>  %elifidni %1, word gs
  9638                              <2>  o16 push %1
  9639                              <2>  %else
  9640 00000A7C 6657                <2>  push %1
  9641                              <2>  %endif
  9642                              <2> 
  9643                              <2>  %rotate -1
  9644                              <2> 
  9645                              <2> 
  9646                              <2> 
  9647                              <2> 
  9648                              <2> 
  9649                              <2> 
  9650                              <2> 
  9651                              <2>  %ifidni %1, cs
  9652                              <2>  o16 push %1
  9653                              <2>  %elifidni %1, ds
  9654                              <2>  o16 push %1
  9655                              <2>  %elifidni %1, es
  9656                              <2>  o16 push %1
  9657                              <2>  %elifidni %1, fs
  9658                              <2>  o16 push %1
  9659                              <2>  %elifidni %1, gs
  9660                              <2>  o16 push %1
  9661                              <2>  %elifidni %1, word cs
  9662                              <2>  o16 push %1
  9663                              <2>  %elifidni %1, word ds
  9664                              <2>  o16 push %1
  9665                              <2>  %elifidni %1, word es
  9666                              <2>  o16 push %1
  9667                              <2>  %elifidni %1, word fs
  9668                              <2>  o16 push %1
  9669                              <2>  %elifidni %1, word gs
  9670                              <2>  o16 push %1
  9671                              <2>  %else
  9672 00000A7E 6656                <2>  push %1
  9673                              <2>  %endif
  9674                              <2> 
  9675                              <2>  %rotate -1
  9676                              <2> 
  9677                              <2> 
  9678                              <2> 
  9679                              <2> 
  9680                              <2> 
  9681                              <2> 
  9682                              <2> 
  9683                              <2>  %ifidni %1, cs
  9684                              <2>  o16 push %1
  9685                              <2>  %elifidni %1, ds
  9686                              <2>  o16 push %1
  9687                              <2>  %elifidni %1, es
  9688                              <2>  o16 push %1
  9689                              <2>  %elifidni %1, fs
  9690                              <2>  o16 push %1
  9691                              <2>  %elifidni %1, gs
  9692                              <2>  o16 push %1
  9693                              <2>  %elifidni %1, word cs
  9694                              <2>  o16 push %1
  9695                              <2>  %elifidni %1, word ds
  9696                              <2>  o16 push %1
  9697                              <2>  %elifidni %1, word es
  9698                              <2>  o16 push %1
  9699                              <2>  %elifidni %1, word fs
  9700                              <2>  o16 push %1
  9701                              <2>  %elifidni %1, word gs
  9702                              <2>  o16 push %1
  9703                              <2>  %else
  9704 00000A80 66FF7512            <2>  push %1
  9705                              <2>  %endif
  9706                              <2> 
  9707                              <2>  %rotate -1
  9708                              <2> 
  9709                              <2> 
  9710                              <2> 
  9711                              <2> 
  9712                              <2> 
  9713                              <2> 
  9714                              <2> 
  9715                              <2>  %ifidni %1, cs
  9716                              <2>  o16 push %1
  9717                              <2>  %elifidni %1, ds
  9718                              <2>  o16 push %1
  9719                              <2>  %elifidni %1, es
  9720                              <2>  o16 push %1
  9721                              <2>  %elifidni %1, fs
  9722                              <2>  o16 push %1
  9723                              <2>  %elifidni %1, gs
  9724                              <2>  o16 push %1
  9725                              <2>  %elifidni %1, word cs
  9726                              <2>  o16 push %1
  9727                              <2>  %elifidni %1, word ds
  9728                              <2>  o16 push %1
  9729                              <2>  %elifidni %1, word es
  9730                              <2>  o16 push %1
  9731                              <2>  %elifidni %1, word fs
  9732                              <2>  o16 push %1
  9733                              <2>  %elifidni %1, word gs
  9734                              <2>  o16 push %1
  9735                              <2>  %else
  9736 00000A84 66FF7510            <2>  push %1
  9737                              <2>  %endif
  9738                              <2> 
  9739                              <2>  %rotate -1
  9740                              <2> 
  9741                              <2> 
  9742                              <2> 
  9743                              <2> 
  9744                              <2> 
  9745                              <2> 
  9746                              <2> 
  9747                              <2>  %ifidni %1, cs
  9748                              <2>  o16 push %1
  9749                              <2>  %elifidni %1, ds
  9750                              <2>  o16 push %1
  9751                              <2>  %elifidni %1, es
  9752                              <2>  o16 push %1
  9753                              <2>  %elifidni %1, fs
  9754                              <2>  o16 push %1
  9755                              <2>  %elifidni %1, gs
  9756                              <2>  o16 push %1
  9757                              <2>  %elifidni %1, word cs
  9758                              <2>  o16 push %1
  9759                              <2>  %elifidni %1, word ds
  9760                              <2>  o16 push %1
  9761                              <2>  %elifidni %1, word es
  9762                              <2>  o16 push %1
  9763                              <2>  %elifidni %1, word fs
  9764                              <2>  o16 push %1
  9765                              <2>  %elifidni %1, word gs
  9766                              <2>  o16 push %1
  9767                              <2>  %else
  9768 00000A88 FF7508              <2>  push %1
  9769                              <2>  %endif
  9770                              <2> 
  9771                              <2>  %rotate -1
  9772 00000A8B E86BF7FFFF          <1> call %1
  9773                              <1> %if (%0!=1)
  9774 00000A90 83C40C              <1>  add esp, byte %1_arglen
  9775                              <1> %endif
  9776 00000A93 0F6ED0                  	movd	mm2, eax
  9777 00000A96 0F60D0                  	punpcklbw	mm2, mm0
  9778 00000A99 0FFDCA                  	paddw	mm1, mm2
  9779                                  	
  9780 00000A9C 46                      	inc	esi				; bottom neighbor
  9781                                  	invoke  _GetPixel, dword [ebp+.SrcOff], word [ebp+.DestWidth], word [ebp+.DestHeight], si, di
  9782                              <1> %rotate -1
  9783                              <1> 
  9784                              <1> %rep (%0-1)
  9785                              <1> 
  9786                              <1> 
  9787                              <1> 
  9788                              <1> 
  9789                              <1> 
  9790                              <1> 
  9791                              <1> 
  9792                              <1>  %ifidni %1, cs
  9793                              <1>  o16 push %1
  9794                              <1>  %elifidni %1, ds
  9795                              <1>  o16 push %1
  9796                              <1>  %elifidni %1, es
  9797                              <1>  o16 push %1
  9798                              <1>  %elifidni %1, fs
  9799                              <1>  o16 push %1
  9800                              <1>  %elifidni %1, gs
  9801                              <1>  o16 push %1
  9802                              <1>  %elifidni %1, word cs
  9803                              <1>  o16 push %1
  9804                              <1>  %elifidni %1, word ds
  9805                              <1>  o16 push %1
  9806                              <1>  %elifidni %1, word es
  9807                              <1>  o16 push %1
  9808                              <1>  %elifidni %1, word fs
  9809                              <1>  o16 push %1
  9810                              <1>  %elifidni %1, word gs
  9811                              <1>  o16 push %1
  9812                              <1>  %else
  9813                              <1>  push %1
  9814                              <1>  %endif
  9815                              <1> 
  9816                              <1>  %rotate -1
  9817                              <1> %endrep
  9818                              <2> 
  9819                              <2> 
  9820                              <2> 
  9821                              <2> 
  9822                              <2> 
  9823                              <2> 
  9824                              <2> 
  9825                              <2>  %ifidni %1, cs
  9826                              <2>  o16 push %1
  9827                              <2>  %elifidni %1, ds
  9828                              <2>  o16 push %1
  9829                              <2>  %elifidni %1, es
  9830                              <2>  o16 push %1
  9831                              <2>  %elifidni %1, fs
  9832                              <2>  o16 push %1
  9833                              <2>  %elifidni %1, gs
  9834                              <2>  o16 push %1
  9835                              <2>  %elifidni %1, word cs
  9836                              <2>  o16 push %1
  9837                              <2>  %elifidni %1, word ds
  9838                              <2>  o16 push %1
  9839                              <2>  %elifidni %1, word es
  9840                              <2>  o16 push %1
  9841                              <2>  %elifidni %1, word fs
  9842                              <2>  o16 push %1
  9843                              <2>  %elifidni %1, word gs
  9844                              <2>  o16 push %1
  9845                              <2>  %else
  9846 00000A9D 6657                <2>  push %1
  9847                              <2>  %endif
  9848                              <2> 
  9849                              <2>  %rotate -1
  9850                              <2> 
  9851                              <2> 
  9852                              <2> 
  9853                              <2> 
  9854                              <2> 
  9855                              <2> 
  9856                              <2> 
  9857                              <2>  %ifidni %1, cs
  9858                              <2>  o16 push %1
  9859                              <2>  %elifidni %1, ds
  9860                              <2>  o16 push %1
  9861                              <2>  %elifidni %1, es
  9862                              <2>  o16 push %1
  9863                              <2>  %elifidni %1, fs
  9864                              <2>  o16 push %1
  9865                              <2>  %elifidni %1, gs
  9866                              <2>  o16 push %1
  9867                              <2>  %elifidni %1, word cs
  9868                              <2>  o16 push %1
  9869                              <2>  %elifidni %1, word ds
  9870                              <2>  o16 push %1
  9871                              <2>  %elifidni %1, word es
  9872                              <2>  o16 push %1
  9873                              <2>  %elifidni %1, word fs
  9874                              <2>  o16 push %1
  9875                              <2>  %elifidni %1, word gs
  9876                              <2>  o16 push %1
  9877                              <2>  %else
  9878 00000A9F 6656                <2>  push %1
  9879                              <2>  %endif
  9880                              <2> 
  9881                              <2>  %rotate -1
  9882                              <2> 
  9883                              <2> 
  9884                              <2> 
  9885                              <2> 
  9886                              <2> 
  9887                              <2> 
  9888                              <2> 
  9889                              <2>  %ifidni %1, cs
  9890                              <2>  o16 push %1
  9891                              <2>  %elifidni %1, ds
  9892                              <2>  o16 push %1
  9893                              <2>  %elifidni %1, es
  9894                              <2>  o16 push %1
  9895                              <2>  %elifidni %1, fs
  9896                              <2>  o16 push %1
  9897                              <2>  %elifidni %1, gs
  9898                              <2>  o16 push %1
  9899                              <2>  %elifidni %1, word cs
  9900                              <2>  o16 push %1
  9901                              <2>  %elifidni %1, word ds
  9902                              <2>  o16 push %1
  9903                              <2>  %elifidni %1, word es
  9904                              <2>  o16 push %1
  9905                              <2>  %elifidni %1, word fs
  9906                              <2>  o16 push %1
  9907                              <2>  %elifidni %1, word gs
  9908                              <2>  o16 push %1
  9909                              <2>  %else
  9910 00000AA1 66FF7512            <2>  push %1
  9911                              <2>  %endif
  9912                              <2> 
  9913                              <2>  %rotate -1
  9914                              <2> 
  9915                              <2> 
  9916                              <2> 
  9917                              <2> 
  9918                              <2> 
  9919                              <2> 
  9920                              <2> 
  9921                              <2>  %ifidni %1, cs
  9922                              <2>  o16 push %1
  9923                              <2>  %elifidni %1, ds
  9924                              <2>  o16 push %1
  9925                              <2>  %elifidni %1, es
  9926                              <2>  o16 push %1
  9927                              <2>  %elifidni %1, fs
  9928                              <2>  o16 push %1
  9929                              <2>  %elifidni %1, gs
  9930                              <2>  o16 push %1
  9931                              <2>  %elifidni %1, word cs
  9932                              <2>  o16 push %1
  9933                              <2>  %elifidni %1, word ds
  9934                              <2>  o16 push %1
  9935                              <2>  %elifidni %1, word es
  9936                              <2>  o16 push %1
  9937                              <2>  %elifidni %1, word fs
  9938                              <2>  o16 push %1
  9939                              <2>  %elifidni %1, word gs
  9940                              <2>  o16 push %1
  9941                              <2>  %else
  9942 00000AA5 66FF7510            <2>  push %1
  9943                              <2>  %endif
  9944                              <2> 
  9945                              <2>  %rotate -1
  9946                              <2> 
  9947                              <2> 
  9948                              <2> 
  9949                              <2> 
  9950                              <2> 
  9951                              <2> 
  9952                              <2> 
  9953                              <2>  %ifidni %1, cs
  9954                              <2>  o16 push %1
  9955                              <2>  %elifidni %1, ds
  9956                              <2>  o16 push %1
  9957                              <2>  %elifidni %1, es
  9958                              <2>  o16 push %1
  9959                              <2>  %elifidni %1, fs
  9960                              <2>  o16 push %1
  9961                              <2>  %elifidni %1, gs
  9962                              <2>  o16 push %1
  9963                              <2>  %elifidni %1, word cs
  9964                              <2>  o16 push %1
  9965                              <2>  %elifidni %1, word ds
  9966                              <2>  o16 push %1
  9967                              <2>  %elifidni %1, word es
  9968                              <2>  o16 push %1
  9969                              <2>  %elifidni %1, word fs
  9970                              <2>  o16 push %1
  9971                              <2>  %elifidni %1, word gs
  9972                              <2>  o16 push %1
  9973                              <2>  %else
  9974 00000AA9 FF7508              <2>  push %1
  9975                              <2>  %endif
  9976                              <2> 
  9977                              <2>  %rotate -1
  9978 00000AAC E84AF7FFFF          <1> call %1
  9979                              <1> %if (%0!=1)
  9980 00000AB1 83C40C              <1>  add esp, byte %1_arglen
  9981                              <1> %endif
  9982 00000AB4 0F6ED0                  	movd	mm2, eax
  9983 00000AB7 0F60D0                  	punpcklbw	mm2, mm0
  9984 00000ABA 0F71F201                	psllw	mm2, 1
  9985 00000ABE 0FFDCA                  	paddw	mm1, mm2
  9986                                  	
  9987 00000AC1 46                      	inc	esi				; lower-right neighbor
  9988                                  	invoke  _GetPixel, dword [ebp+.SrcOff], word [ebp+.DestWidth], word [ebp+.DestHeight], si, di
  9989                              <1> %rotate -1
  9990                              <1> 
  9991                              <1> %rep (%0-1)
  9992                              <1> 
  9993                              <1> 
  9994                              <1> 
  9995                              <1> 
  9996                              <1> 
  9997                              <1> 
  9998                              <1> 
  9999                              <1>  %ifidni %1, cs
 10000                              <1>  o16 push %1
 10001                              <1>  %elifidni %1, ds
 10002                              <1>  o16 push %1
 10003                              <1>  %elifidni %1, es
 10004                              <1>  o16 push %1
 10005                              <1>  %elifidni %1, fs
 10006                              <1>  o16 push %1
 10007                              <1>  %elifidni %1, gs
 10008                              <1>  o16 push %1
 10009                              <1>  %elifidni %1, word cs
 10010                              <1>  o16 push %1
 10011                              <1>  %elifidni %1, word ds
 10012                              <1>  o16 push %1
 10013                              <1>  %elifidni %1, word es
 10014                              <1>  o16 push %1
 10015                              <1>  %elifidni %1, word fs
 10016                              <1>  o16 push %1
 10017                              <1>  %elifidni %1, word gs
 10018                              <1>  o16 push %1
 10019                              <1>  %else
 10020                              <1>  push %1
 10021                              <1>  %endif
 10022                              <1> 
 10023                              <1>  %rotate -1
 10024                              <1> %endrep
 10025                              <2> 
 10026                              <2> 
 10027                              <2> 
 10028                              <2> 
 10029                              <2> 
 10030                              <2> 
 10031                              <2> 
 10032                              <2>  %ifidni %1, cs
 10033                              <2>  o16 push %1
 10034                              <2>  %elifidni %1, ds
 10035                              <2>  o16 push %1
 10036                              <2>  %elifidni %1, es
 10037                              <2>  o16 push %1
 10038                              <2>  %elifidni %1, fs
 10039                              <2>  o16 push %1
 10040                              <2>  %elifidni %1, gs
 10041                              <2>  o16 push %1
 10042                              <2>  %elifidni %1, word cs
 10043                              <2>  o16 push %1
 10044                              <2>  %elifidni %1, word ds
 10045                              <2>  o16 push %1
 10046                              <2>  %elifidni %1, word es
 10047                              <2>  o16 push %1
 10048                              <2>  %elifidni %1, word fs
 10049                              <2>  o16 push %1
 10050                              <2>  %elifidni %1, word gs
 10051                              <2>  o16 push %1
 10052                              <2>  %else
 10053 00000AC2 6657                <2>  push %1
 10054                              <2>  %endif
 10055                              <2> 
 10056                              <2>  %rotate -1
 10057                              <2> 
 10058                              <2> 
 10059                              <2> 
 10060                              <2> 
 10061                              <2> 
 10062                              <2> 
 10063                              <2> 
 10064                              <2>  %ifidni %1, cs
 10065                              <2>  o16 push %1
 10066                              <2>  %elifidni %1, ds
 10067                              <2>  o16 push %1
 10068                              <2>  %elifidni %1, es
 10069                              <2>  o16 push %1
 10070                              <2>  %elifidni %1, fs
 10071                              <2>  o16 push %1
 10072                              <2>  %elifidni %1, gs
 10073                              <2>  o16 push %1
 10074                              <2>  %elifidni %1, word cs
 10075                              <2>  o16 push %1
 10076                              <2>  %elifidni %1, word ds
 10077                              <2>  o16 push %1
 10078                              <2>  %elifidni %1, word es
 10079                              <2>  o16 push %1
 10080                              <2>  %elifidni %1, word fs
 10081                              <2>  o16 push %1
 10082                              <2>  %elifidni %1, word gs
 10083                              <2>  o16 push %1
 10084                              <2>  %else
 10085 00000AC4 6656                <2>  push %1
 10086                              <2>  %endif
 10087                              <2> 
 10088                              <2>  %rotate -1
 10089                              <2> 
 10090                              <2> 
 10091                              <2> 
 10092                              <2> 
 10093                              <2> 
 10094                              <2> 
 10095                              <2> 
 10096                              <2>  %ifidni %1, cs
 10097                              <2>  o16 push %1
 10098                              <2>  %elifidni %1, ds
 10099                              <2>  o16 push %1
 10100                              <2>  %elifidni %1, es
 10101                              <2>  o16 push %1
 10102                              <2>  %elifidni %1, fs
 10103                              <2>  o16 push %1
 10104                              <2>  %elifidni %1, gs
 10105                              <2>  o16 push %1
 10106                              <2>  %elifidni %1, word cs
 10107                              <2>  o16 push %1
 10108                              <2>  %elifidni %1, word ds
 10109                              <2>  o16 push %1
 10110                              <2>  %elifidni %1, word es
 10111                              <2>  o16 push %1
 10112                              <2>  %elifidni %1, word fs
 10113                              <2>  o16 push %1
 10114                              <2>  %elifidni %1, word gs
 10115                              <2>  o16 push %1
 10116                              <2>  %else
 10117 00000AC6 66FF7512            <2>  push %1
 10118                              <2>  %endif
 10119                              <2> 
 10120                              <2>  %rotate -1
 10121                              <2> 
 10122                              <2> 
 10123                              <2> 
 10124                              <2> 
 10125                              <2> 
 10126                              <2> 
 10127                              <2> 
 10128                              <2>  %ifidni %1, cs
 10129                              <2>  o16 push %1
 10130                              <2>  %elifidni %1, ds
 10131                              <2>  o16 push %1
 10132                              <2>  %elifidni %1, es
 10133                              <2>  o16 push %1
 10134                              <2>  %elifidni %1, fs
 10135                              <2>  o16 push %1
 10136                              <2>  %elifidni %1, gs
 10137                              <2>  o16 push %1
 10138                              <2>  %elifidni %1, word cs
 10139                              <2>  o16 push %1
 10140                              <2>  %elifidni %1, word ds
 10141                              <2>  o16 push %1
 10142                              <2>  %elifidni %1, word es
 10143                              <2>  o16 push %1
 10144                              <2>  %elifidni %1, word fs
 10145                              <2>  o16 push %1
 10146                              <2>  %elifidni %1, word gs
 10147                              <2>  o16 push %1
 10148                              <2>  %else
 10149 00000ACA 66FF7510            <2>  push %1
 10150                              <2>  %endif
 10151                              <2> 
 10152                              <2>  %rotate -1
 10153                              <2> 
 10154                              <2> 
 10155                              <2> 
 10156                              <2> 
 10157                              <2> 
 10158                              <2> 
 10159                              <2> 
 10160                              <2>  %ifidni %1, cs
 10161                              <2>  o16 push %1
 10162                              <2>  %elifidni %1, ds
 10163                              <2>  o16 push %1
 10164                              <2>  %elifidni %1, es
 10165                              <2>  o16 push %1
 10166                              <2>  %elifidni %1, fs
 10167                              <2>  o16 push %1
 10168                              <2>  %elifidni %1, gs
 10169                              <2>  o16 push %1
 10170                              <2>  %elifidni %1, word cs
 10171                              <2>  o16 push %1
 10172                              <2>  %elifidni %1, word ds
 10173                              <2>  o16 push %1
 10174                              <2>  %elifidni %1, word es
 10175                              <2>  o16 push %1
 10176                              <2>  %elifidni %1, word fs
 10177                              <2>  o16 push %1
 10178                              <2>  %elifidni %1, word gs
 10179                              <2>  o16 push %1
 10180                              <2>  %else
 10181 00000ACE FF7508              <2>  push %1
 10182                              <2>  %endif
 10183                              <2> 
 10184                              <2>  %rotate -1
 10185 00000AD1 E825F7FFFF          <1> call %1
 10186                              <1> %if (%0!=1)
 10187 00000AD6 83C40C              <1>  add esp, byte %1_arglen
 10188                              <1> %endif
 10189 00000AD9 0F6ED0                  	movd	mm2, eax
 10190 00000ADC 0F60D0                  	punpcklbw	mm2, mm0
 10191 00000ADF 0FFDCA                  	paddw	mm1, mm2
 10192                                  	
 10193 00000AE2 5A                      	pop	edx
 10194 00000AE3 59                      	pop	ecx
 10195 00000AE4 5B                      	pop	ebx
 10196 00000AE5 58                      	pop	eax
 10197                                  	
 10198                                  .calcBlur
 10199 00000AE6 0F71D104                	psrlw	mm1, 4
 10200                                  
 10201 00000AEA 0F67C8                  	packuswb	mm1, mm0
 10202                                  
 10203 00000AED 0FB715[2A000000]        	movzx	edx, word [_y]
 10204 00000AF4 0FB74510                	movzx	eax, word [ebp+.DestWidth]	; calculate the offset of the current pixel
 10205 00000AF8 F7E2                    	mul	edx
 10206 00000AFA 0FB715[28000000]        	movzx	edx, word [_x]
 10207 00000B01 01D0                    	add	eax, edx
 10208 00000B03 C1E002                  	shl	eax, 2				; take the average
 10209 00000B06 03450C                  	add	eax, dword [ebp+.DestOff]
 10210                                  
 10211 00000B09 0F7ECA                  	movd	edx, mm1
 10212 00000B0C 8910                    	mov	dword[eax], edx
 10213                                  
 10214 00000B0E 66FF05[28000000]        	inc	word [_x]
 10215                                  
 10216 00000B15 49                      	dec	ecx
 10217 00000B16 81F900000000            	cmp	ecx, 0
 10218 00000B1C 0F8770FEFFFF            	ja	NEAR	.colLoop		; end of the column loop
 10219                                  
 10220 00000B22 66FF05[2A000000]        	inc	word [_y]
 10221                                  
 10222 00000B29 4B                      	dec	ebx
 10223 00000B2A 81FB00000000            	cmp	ebx, 0	
 10224 00000B30 0F874FFEFFFF            	ja	.rowLoop			; end of the row loop
 10225                                  
 10226                                  .blurDone
 10227 00000B36 5F                      	pop	edi
 10228 00000B37 5E                      	pop	esi
 10229                                  	ret
 10230                              <1> %ifnctx proc
 10231                              <1>  ret %1
 10232                              <1> %else
 10233 00000B38 89EC                <1>  mov esp, ebp
 10234 00000B3A 5D                  <1>  pop ebp
 10235 00000B3B C3                  <1>  ret %1
 10236                              <1> %endif
 10237                                  
 10238                                  endproc
 10239                              <1> %ifnctx proc
 10240                              <1> %error Mismatched `endproc'/`proc'
 10241                              <1> %else
 10242                              <1> .STACK_FRAME_SIZE equ %$local
 10243                              <1> 
 10244                              <1> 
 10245                              <1> %ifdef LEGACY_ENDPROC
 10246                              <1>  ret
 10247                              <1> %endif
 10248                              <1> 
 10249                              <1> 
 10250                              <1> 
 10251                              <1> 
 10252                              <1> 
 10253                              <1> 
 10254                              <1> 
 10255                              <1> 
 10256                              <1> 
 10257                              <1> %pop
 10258                              <1> %endif
 10259                                  _BlurBuffer_arglen	EQU	12
 10260                                  
 10261                                  ;---------------------------------------------------------------------------------------------------------------------
 10262                                  ;-- void FloodFill(dword *DestOff, word DestWidth, word DestHeight, word X, word Y, dword Color, dword ComposeFlag) --
 10263                                  ;---------------------------------------------------------------------------------------------------------------------
 10264                                  ; Inputs : DestOff - offset of an image buffer in memory
 10265                                  ;          DestWidth - width of the buffer
 10266                                  ;          DestHeight - height of the buffer
 10267                                  ;          X - x coordinate of point in the region
 10268                                  ;          Y - y coordinate of point in the region
 10269                                  ;          Color - new color for region
 10270                                  ;          ComposeFlag - flag to determine whether or not to alpha compose the current color of the region with Color
 10271                                  ; Outputs : region filled with color Color in buffer
 10272                                  ; Returns : -
 10273                                  ; Calls : _PointInBox, _GetPixel, _DrawPixel
 10274                                  ; - performs a flood fill operation on a region in the buffer pointed to by DestOff
 10275                                  proc _FloodFill
 10276                              <1> %ifctx proc
 10277                              <1> %error Mismatched `endproc'/`proc'
 10278                              <1> %else
 10279                              <1> %push proc
 10280                              <1>  global %1
 10281 00000B3C 55                  <1> %1: push ebp
 10282 00000B3D 89E5                <1>  mov ebp, esp
 10283                              <1> %assign %$arg 8
 10284                              <1> %assign %$local 0
 10285                              <1> 
 10286                              <1> %define %$procname %1
 10287                              <1> %endif
 10288                                  .DestOff	arg	4
 10289                              <1> .DestOff equ %$arg
 10290                              <1> 
 10291                              <1> 
 10292                              <1> %assign %$arg %1+%$arg
 10293                                  .DestWidth	arg	2
 10294                              <1> .DestWidth equ %$arg
 10295                              <1> 
 10296                              <1> 
 10297                              <1> %assign %$arg %1+%$arg
 10298                                  .DestHeight	arg	2
 10299                              <1> .DestHeight equ %$arg
 10300                              <1> 
 10301                              <1> 
 10302                              <1> %assign %$arg %1+%$arg
 10303                                  .X		arg	2
 10304                              <1> .X equ %$arg
 10305                              <1> 
 10306                              <1> 
 10307                              <1> %assign %$arg %1+%$arg
 10308                                  .Y		arg	2
 10309                              <1> .Y equ %$arg
 10310                              <1> 
 10311                              <1> 
 10312                              <1> %assign %$arg %1+%$arg
 10313                                  .Color		arg	4
 10314                              <1> .Color equ %$arg
 10315                              <1> 
 10316                              <1> 
 10317                              <1> %assign %$arg %1+%$arg
 10318                                  .ComposeFlag	arg	4
 10319                              <1> .ComposeFlag equ %$arg
 10320                              <1> 
 10321                              <1> 
 10322                              <1> %assign %$arg %1+%$arg
 10323                                  
 10324                                  ;	invoke	_libFloodFill, dword [ebp+.DestOff], word [ebp+.DestWidth], word [ebp+.DestHeight], word [ebp+.X], word [ebp+.Y], dword [ebp+.Color], dword [ebp+.ComposeFlag]
 10325                                  
 10326 00000B3F 56                      	push	esi
 10327 00000B40 57                      	push	edi
 10328                                  
 10329 00000B41 8B3D[46000000]          	mov	edi, [_PointQueue]	;
 10330 00000B47 893D[4A000000]          	mov	[_QueueHead], edi	;
 10331 00000B4D 893D[4E000000]          	mov	[_QueueTail], edi	; initialize _QueueHead and _QueueTail
 10332 00000B53 668B4510                	mov	ax, [.X + ebp]
 10333 00000B57 668907                  	mov	[edi], ax
 10334 00000B5A 668B4512                	mov	ax, [.Y + ebp]
 10335 00000B5E 66894702                	mov	[edi + 2], ax
 10336 00000B62 8105[4E000000]0400-     	add	dword [_QueueTail], 4
 10337 00000B6A 0000               
 10338                                  	invoke	_GetPixel, dword [.DestOff + ebp], word [.DestWidth + ebp], word [.DestHeight + ebp], word [.X + ebp], word [.Y + ebp]
 10339                              <1> %rotate -1
 10340                              <1> 
 10341                              <1> %rep (%0-1)
 10342                              <1> 
 10343                              <1> 
 10344                              <1> 
 10345                              <1> 
 10346                              <1> 
 10347                              <1> 
 10348                              <1> 
 10349                              <1>  %ifidni %1, cs
 10350                              <1>  o16 push %1
 10351                              <1>  %elifidni %1, ds
 10352                              <1>  o16 push %1
 10353                              <1>  %elifidni %1, es
 10354                              <1>  o16 push %1
 10355                              <1>  %elifidni %1, fs
 10356                              <1>  o16 push %1
 10357                              <1>  %elifidni %1, gs
 10358                              <1>  o16 push %1
 10359                              <1>  %elifidni %1, word cs
 10360                              <1>  o16 push %1
 10361                              <1>  %elifidni %1, word ds
 10362                              <1>  o16 push %1
 10363                              <1>  %elifidni %1, word es
 10364                              <1>  o16 push %1
 10365                              <1>  %elifidni %1, word fs
 10366                              <1>  o16 push %1
 10367                              <1>  %elifidni %1, word gs
 10368                              <1>  o16 push %1
 10369                              <1>  %else
 10370                              <1>  push %1
 10371                              <1>  %endif
 10372                              <1> 
 10373                              <1>  %rotate -1
 10374                              <1> %endrep
 10375                              <2> 
 10376                              <2> 
 10377                              <2> 
 10378                              <2> 
 10379                              <2> 
 10380                              <2> 
 10381                              <2> 
 10382                              <2>  %ifidni %1, cs
 10383                              <2>  o16 push %1
 10384                              <2>  %elifidni %1, ds
 10385                              <2>  o16 push %1
 10386                              <2>  %elifidni %1, es
 10387                              <2>  o16 push %1
 10388                              <2>  %elifidni %1, fs
 10389                              <2>  o16 push %1
 10390                              <2>  %elifidni %1, gs
 10391                              <2>  o16 push %1
 10392                              <2>  %elifidni %1, word cs
 10393                              <2>  o16 push %1
 10394                              <2>  %elifidni %1, word ds
 10395                              <2>  o16 push %1
 10396                              <2>  %elifidni %1, word es
 10397                              <2>  o16 push %1
 10398                              <2>  %elifidni %1, word fs
 10399                              <2>  o16 push %1
 10400                              <2>  %elifidni %1, word gs
 10401                              <2>  o16 push %1
 10402                              <2>  %else
 10403 00000B6C 66FF7512            <2>  push %1
 10404                              <2>  %endif
 10405                              <2> 
 10406                              <2>  %rotate -1
 10407                              <2> 
 10408                              <2> 
 10409                              <2> 
 10410                              <2> 
 10411                              <2> 
 10412                              <2> 
 10413                              <2> 
 10414                              <2>  %ifidni %1, cs
 10415                              <2>  o16 push %1
 10416                              <2>  %elifidni %1, ds
 10417                              <2>  o16 push %1
 10418                              <2>  %elifidni %1, es
 10419                              <2>  o16 push %1
 10420                              <2>  %elifidni %1, fs
 10421                              <2>  o16 push %1
 10422                              <2>  %elifidni %1, gs
 10423                              <2>  o16 push %1
 10424                              <2>  %elifidni %1, word cs
 10425                              <2>  o16 push %1
 10426                              <2>  %elifidni %1, word ds
 10427                              <2>  o16 push %1
 10428                              <2>  %elifidni %1, word es
 10429                              <2>  o16 push %1
 10430                              <2>  %elifidni %1, word fs
 10431                              <2>  o16 push %1
 10432                              <2>  %elifidni %1, word gs
 10433                              <2>  o16 push %1
 10434                              <2>  %else
 10435 00000B70 66FF7510            <2>  push %1
 10436                              <2>  %endif
 10437                              <2> 
 10438                              <2>  %rotate -1
 10439                              <2> 
 10440                              <2> 
 10441                              <2> 
 10442                              <2> 
 10443                              <2> 
 10444                              <2> 
 10445                              <2> 
 10446                              <2>  %ifidni %1, cs
 10447                              <2>  o16 push %1
 10448                              <2>  %elifidni %1, ds
 10449                              <2>  o16 push %1
 10450                              <2>  %elifidni %1, es
 10451                              <2>  o16 push %1
 10452                              <2>  %elifidni %1, fs
 10453                              <2>  o16 push %1
 10454                              <2>  %elifidni %1, gs
 10455                              <2>  o16 push %1
 10456                              <2>  %elifidni %1, word cs
 10457                              <2>  o16 push %1
 10458                              <2>  %elifidni %1, word ds
 10459                              <2>  o16 push %1
 10460                              <2>  %elifidni %1, word es
 10461                              <2>  o16 push %1
 10462                              <2>  %elifidni %1, word fs
 10463                              <2>  o16 push %1
 10464                              <2>  %elifidni %1, word gs
 10465                              <2>  o16 push %1
 10466                              <2>  %else
 10467 00000B74 66FF750E            <2>  push %1
 10468                              <2>  %endif
 10469                              <2> 
 10470                              <2>  %rotate -1
 10471                              <2> 
 10472                              <2> 
 10473                              <2> 
 10474                              <2> 
 10475                              <2> 
 10476                              <2> 
 10477                              <2> 
 10478                              <2>  %ifidni %1, cs
 10479                              <2>  o16 push %1
 10480                              <2>  %elifidni %1, ds
 10481                              <2>  o16 push %1
 10482                              <2>  %elifidni %1, es
 10483                              <2>  o16 push %1
 10484                              <2>  %elifidni %1, fs
 10485                              <2>  o16 push %1
 10486                              <2>  %elifidni %1, gs
 10487                              <2>  o16 push %1
 10488                              <2>  %elifidni %1, word cs
 10489                              <2>  o16 push %1
 10490                              <2>  %elifidni %1, word ds
 10491                              <2>  o16 push %1
 10492                              <2>  %elifidni %1, word es
 10493                              <2>  o16 push %1
 10494                              <2>  %elifidni %1, word fs
 10495                              <2>  o16 push %1
 10496                              <2>  %elifidni %1, word gs
 10497                              <2>  o16 push %1
 10498                              <2>  %else
 10499 00000B78 66FF750C            <2>  push %1
 10500                              <2>  %endif
 10501                              <2> 
 10502                              <2>  %rotate -1
 10503                              <2> 
 10504                              <2> 
 10505                              <2> 
 10506                              <2> 
 10507                              <2> 
 10508                              <2> 
 10509                              <2> 
 10510                              <2>  %ifidni %1, cs
 10511                              <2>  o16 push %1
 10512                              <2>  %elifidni %1, ds
 10513                              <2>  o16 push %1
 10514                              <2>  %elifidni %1, es
 10515                              <2>  o16 push %1
 10516                              <2>  %elifidni %1, fs
 10517                              <2>  o16 push %1
 10518                              <2>  %elifidni %1, gs
 10519                              <2>  o16 push %1
 10520                              <2>  %elifidni %1, word cs
 10521                              <2>  o16 push %1
 10522                              <2>  %elifidni %1, word ds
 10523                              <2>  o16 push %1
 10524                              <2>  %elifidni %1, word es
 10525                              <2>  o16 push %1
 10526                              <2>  %elifidni %1, word fs
 10527                              <2>  o16 push %1
 10528                              <2>  %elifidni %1, word gs
 10529                              <2>  o16 push %1
 10530                              <2>  %else
 10531 00000B7C FF7508              <2>  push %1
 10532                              <2>  %endif
 10533                              <2> 
 10534                              <2>  %rotate -1
 10535 00000B7F E877F6FFFF          <1> call %1
 10536                              <1> %if (%0!=1)
 10537 00000B84 83C40C              <1>  add esp, byte %1_arglen
 10538                              <1> %endif
 10539 00000B87 89C6                    	mov	esi, eax		; esi = old color
 10540                                  
 10541                                  .loopFill
 10542 00000B89 8B3D[4A000000]          	mov	edi, [_QueueHead]
 10543 00000B8F 3B3D[4E000000]          	cmp	edi, [_QueueTail]
 10544 00000B95 0F8310010000            	jae	near .done
 10545 00000B9B 8105[4A000000]0400-     	add	dword [_QueueHead], 4	; dequeue
 10546 00000BA3 0000               
 10547                                  	invoke	_PointInBox, word [edi], word [edi + 2], word 0, word 0, word [.DestWidth + ebp], word [.DestHeight + ebp]
 10548                              <1> %rotate -1
 10549                              <1> 
 10550                              <1> %rep (%0-1)
 10551                              <1> 
 10552                              <1> 
 10553                              <1> 
 10554                              <1> 
 10555                              <1> 
 10556                              <1> 
 10557                              <1> 
 10558                              <1>  %ifidni %1, cs
 10559                              <1>  o16 push %1
 10560                              <1>  %elifidni %1, ds
 10561                              <1>  o16 push %1
 10562                              <1>  %elifidni %1, es
 10563                              <1>  o16 push %1
 10564                              <1>  %elifidni %1, fs
 10565                              <1>  o16 push %1
 10566                              <1>  %elifidni %1, gs
 10567                              <1>  o16 push %1
 10568                              <1>  %elifidni %1, word cs
 10569                              <1>  o16 push %1
 10570                              <1>  %elifidni %1, word ds
 10571                              <1>  o16 push %1
 10572                              <1>  %elifidni %1, word es
 10573                              <1>  o16 push %1
 10574                              <1>  %elifidni %1, word fs
 10575                              <1>  o16 push %1
 10576                              <1>  %elifidni %1, word gs
 10577                              <1>  o16 push %1
 10578                              <1>  %else
 10579                              <1>  push %1
 10580                              <1>  %endif
 10581                              <1> 
 10582                              <1>  %rotate -1
 10583                              <1> %endrep
 10584                              <2> 
 10585                              <2> 
 10586                              <2> 
 10587                              <2> 
 10588                              <2> 
 10589                              <2> 
 10590                              <2> 
 10591                              <2>  %ifidni %1, cs
 10592                              <2>  o16 push %1
 10593                              <2>  %elifidni %1, ds
 10594                              <2>  o16 push %1
 10595                              <2>  %elifidni %1, es
 10596                              <2>  o16 push %1
 10597                              <2>  %elifidni %1, fs
 10598                              <2>  o16 push %1
 10599                              <2>  %elifidni %1, gs
 10600                              <2>  o16 push %1
 10601                              <2>  %elifidni %1, word cs
 10602                              <2>  o16 push %1
 10603                              <2>  %elifidni %1, word ds
 10604                              <2>  o16 push %1
 10605                              <2>  %elifidni %1, word es
 10606                              <2>  o16 push %1
 10607                              <2>  %elifidni %1, word fs
 10608                              <2>  o16 push %1
 10609                              <2>  %elifidni %1, word gs
 10610                              <2>  o16 push %1
 10611                              <2>  %else
 10612 00000BA5 66FF750E            <2>  push %1
 10613                              <2>  %endif
 10614                              <2> 
 10615                              <2>  %rotate -1
 10616                              <2> 
 10617                              <2> 
 10618                              <2> 
 10619                              <2> 
 10620                              <2> 
 10621                              <2> 
 10622                              <2> 
 10623                              <2>  %ifidni %1, cs
 10624                              <2>  o16 push %1
 10625                              <2>  %elifidni %1, ds
 10626                              <2>  o16 push %1
 10627                              <2>  %elifidni %1, es
 10628                              <2>  o16 push %1
 10629                              <2>  %elifidni %1, fs
 10630                              <2>  o16 push %1
 10631                              <2>  %elifidni %1, gs
 10632                              <2>  o16 push %1
 10633                              <2>  %elifidni %1, word cs
 10634                              <2>  o16 push %1
 10635                              <2>  %elifidni %1, word ds
 10636                              <2>  o16 push %1
 10637                              <2>  %elifidni %1, word es
 10638                              <2>  o16 push %1
 10639                              <2>  %elifidni %1, word fs
 10640                              <2>  o16 push %1
 10641                              <2>  %elifidni %1, word gs
 10642                              <2>  o16 push %1
 10643                              <2>  %else
 10644 00000BA9 66FF750C            <2>  push %1
 10645                              <2>  %endif
 10646                              <2> 
 10647                              <2>  %rotate -1
 10648                              <2> 
 10649                              <2> 
 10650                              <2> 
 10651                              <2> 
 10652                              <2> 
 10653                              <2> 
 10654                              <2> 
 10655                              <2>  %ifidni %1, cs
 10656                              <2>  o16 push %1
 10657                              <2>  %elifidni %1, ds
 10658                              <2>  o16 push %1
 10659                              <2>  %elifidni %1, es
 10660                              <2>  o16 push %1
 10661                              <2>  %elifidni %1, fs
 10662                              <2>  o16 push %1
 10663                              <2>  %elifidni %1, gs
 10664                              <2>  o16 push %1
 10665                              <2>  %elifidni %1, word cs
 10666                              <2>  o16 push %1
 10667                              <2>  %elifidni %1, word ds
 10668                              <2>  o16 push %1
 10669                              <2>  %elifidni %1, word es
 10670                              <2>  o16 push %1
 10671                              <2>  %elifidni %1, word fs
 10672                              <2>  o16 push %1
 10673                              <2>  %elifidni %1, word gs
 10674                              <2>  o16 push %1
 10675                              <2>  %else
 10676 00000BAD 66680000            <2>  push %1
 10677                              <2>  %endif
 10678                              <2> 
 10679                              <2>  %rotate -1
 10680                              <2> 
 10681                              <2> 
 10682                              <2> 
 10683                              <2> 
 10684                              <2> 
 10685                              <2> 
 10686                              <2> 
 10687                              <2>  %ifidni %1, cs
 10688                              <2>  o16 push %1
 10689                              <2>  %elifidni %1, ds
 10690                              <2>  o16 push %1
 10691                              <2>  %elifidni %1, es
 10692                              <2>  o16 push %1
 10693                              <2>  %elifidni %1, fs
 10694                              <2>  o16 push %1
 10695                              <2>  %elifidni %1, gs
 10696                              <2>  o16 push %1
 10697                              <2>  %elifidni %1, word cs
 10698                              <2>  o16 push %1
 10699                              <2>  %elifidni %1, word ds
 10700                              <2>  o16 push %1
 10701                              <2>  %elifidni %1, word es
 10702                              <2>  o16 push %1
 10703                              <2>  %elifidni %1, word fs
 10704                              <2>  o16 push %1
 10705                              <2>  %elifidni %1, word gs
 10706                              <2>  o16 push %1
 10707                              <2>  %else
 10708 00000BB1 66680000            <2>  push %1
 10709                              <2>  %endif
 10710                              <2> 
 10711                              <2>  %rotate -1
 10712                              <2> 
 10713                              <2> 
 10714                              <2> 
 10715                              <2> 
 10716                              <2> 
 10717                              <2> 
 10718                              <2> 
 10719                              <2>  %ifidni %1, cs
 10720                              <2>  o16 push %1
 10721                              <2>  %elifidni %1, ds
 10722                              <2>  o16 push %1
 10723                              <2>  %elifidni %1, es
 10724                              <2>  o16 push %1
 10725                              <2>  %elifidni %1, fs
 10726                              <2>  o16 push %1
 10727                              <2>  %elifidni %1, gs
 10728                              <2>  o16 push %1
 10729                              <2>  %elifidni %1, word cs
 10730                              <2>  o16 push %1
 10731                              <2>  %elifidni %1, word ds
 10732                              <2>  o16 push %1
 10733                              <2>  %elifidni %1, word es
 10734                              <2>  o16 push %1
 10735                              <2>  %elifidni %1, word fs
 10736                              <2>  o16 push %1
 10737                              <2>  %elifidni %1, word gs
 10738                              <2>  o16 push %1
 10739                              <2>  %else
 10740 00000BB5 66FF7702            <2>  push %1
 10741                              <2>  %endif
 10742                              <2> 
 10743                              <2>  %rotate -1
 10744                              <2> 
 10745                              <2> 
 10746                              <2> 
 10747                              <2> 
 10748                              <2> 
 10749                              <2> 
 10750                              <2> 
 10751                              <2>  %ifidni %1, cs
 10752                              <2>  o16 push %1
 10753                              <2>  %elifidni %1, ds
 10754                              <2>  o16 push %1
 10755                              <2>  %elifidni %1, es
 10756                              <2>  o16 push %1
 10757                              <2>  %elifidni %1, fs
 10758                              <2>  o16 push %1
 10759                              <2>  %elifidni %1, gs
 10760                              <2>  o16 push %1
 10761                              <2>  %elifidni %1, word cs
 10762                              <2>  o16 push %1
 10763                              <2>  %elifidni %1, word ds
 10764                              <2>  o16 push %1
 10765                              <2>  %elifidni %1, word es
 10766                              <2>  o16 push %1
 10767                              <2>  %elifidni %1, word fs
 10768                              <2>  o16 push %1
 10769                              <2>  %elifidni %1, word gs
 10770                              <2>  o16 push %1
 10771                              <2>  %else
 10772 00000BB9 66FF37              <2>  push %1
 10773                              <2>  %endif
 10774                              <2> 
 10775                              <2>  %rotate -1
 10776 00000BBC E804F6FFFF          <1> call %1
 10777                              <1> %if (%0!=1)
 10778 00000BC1 83C40C              <1>  add esp, byte %1_arglen
 10779                              <1> %endif
 10780 00000BC4 85C0                    	test	eax, eax
 10781 00000BC6 74C1                    	jz	.loopFill
 10782                                  	invoke	_GetPixel, dword [.DestOff + ebp], word [.DestWidth + ebp], word [.DestHeight + ebp], word [edi], word [edi + 2]
 10783                              <1> %rotate -1
 10784                              <1> 
 10785                              <1> %rep (%0-1)
 10786                              <1> 
 10787                              <1> 
 10788                              <1> 
 10789                              <1> 
 10790                              <1> 
 10791                              <1> 
 10792                              <1> 
 10793                              <1>  %ifidni %1, cs
 10794                              <1>  o16 push %1
 10795                              <1>  %elifidni %1, ds
 10796                              <1>  o16 push %1
 10797                              <1>  %elifidni %1, es
 10798                              <1>  o16 push %1
 10799                              <1>  %elifidni %1, fs
 10800                              <1>  o16 push %1
 10801                              <1>  %elifidni %1, gs
 10802                              <1>  o16 push %1
 10803                              <1>  %elifidni %1, word cs
 10804                              <1>  o16 push %1
 10805                              <1>  %elifidni %1, word ds
 10806                              <1>  o16 push %1
 10807                              <1>  %elifidni %1, word es
 10808                              <1>  o16 push %1
 10809                              <1>  %elifidni %1, word fs
 10810                              <1>  o16 push %1
 10811                              <1>  %elifidni %1, word gs
 10812                              <1>  o16 push %1
 10813                              <1>  %else
 10814                              <1>  push %1
 10815                              <1>  %endif
 10816                              <1> 
 10817                              <1>  %rotate -1
 10818                              <1> %endrep
 10819                              <2> 
 10820                              <2> 
 10821                              <2> 
 10822                              <2> 
 10823                              <2> 
 10824                              <2> 
 10825                              <2> 
 10826                              <2>  %ifidni %1, cs
 10827                              <2>  o16 push %1
 10828                              <2>  %elifidni %1, ds
 10829                              <2>  o16 push %1
 10830                              <2>  %elifidni %1, es
 10831                              <2>  o16 push %1
 10832                              <2>  %elifidni %1, fs
 10833                              <2>  o16 push %1
 10834                              <2>  %elifidni %1, gs
 10835                              <2>  o16 push %1
 10836                              <2>  %elifidni %1, word cs
 10837                              <2>  o16 push %1
 10838                              <2>  %elifidni %1, word ds
 10839                              <2>  o16 push %1
 10840                              <2>  %elifidni %1, word es
 10841                              <2>  o16 push %1
 10842                              <2>  %elifidni %1, word fs
 10843                              <2>  o16 push %1
 10844                              <2>  %elifidni %1, word gs
 10845                              <2>  o16 push %1
 10846                              <2>  %else
 10847 00000BC8 66FF7702            <2>  push %1
 10848                              <2>  %endif
 10849                              <2> 
 10850                              <2>  %rotate -1
 10851                              <2> 
 10852                              <2> 
 10853                              <2> 
 10854                              <2> 
 10855                              <2> 
 10856                              <2> 
 10857                              <2> 
 10858                              <2>  %ifidni %1, cs
 10859                              <2>  o16 push %1
 10860                              <2>  %elifidni %1, ds
 10861                              <2>  o16 push %1
 10862                              <2>  %elifidni %1, es
 10863                              <2>  o16 push %1
 10864                              <2>  %elifidni %1, fs
 10865                              <2>  o16 push %1
 10866                              <2>  %elifidni %1, gs
 10867                              <2>  o16 push %1
 10868                              <2>  %elifidni %1, word cs
 10869                              <2>  o16 push %1
 10870                              <2>  %elifidni %1, word ds
 10871                              <2>  o16 push %1
 10872                              <2>  %elifidni %1, word es
 10873                              <2>  o16 push %1
 10874                              <2>  %elifidni %1, word fs
 10875                              <2>  o16 push %1
 10876                              <2>  %elifidni %1, word gs
 10877                              <2>  o16 push %1
 10878                              <2>  %else
 10879 00000BCC 66FF37              <2>  push %1
 10880                              <2>  %endif
 10881                              <2> 
 10882                              <2>  %rotate -1
 10883                              <2> 
 10884                              <2> 
 10885                              <2> 
 10886                              <2> 
 10887                              <2> 
 10888                              <2> 
 10889                              <2> 
 10890                              <2>  %ifidni %1, cs
 10891                              <2>  o16 push %1
 10892                              <2>  %elifidni %1, ds
 10893                              <2>  o16 push %1
 10894                              <2>  %elifidni %1, es
 10895                              <2>  o16 push %1
 10896                              <2>  %elifidni %1, fs
 10897                              <2>  o16 push %1
 10898                              <2>  %elifidni %1, gs
 10899                              <2>  o16 push %1
 10900                              <2>  %elifidni %1, word cs
 10901                              <2>  o16 push %1
 10902                              <2>  %elifidni %1, word ds
 10903                              <2>  o16 push %1
 10904                              <2>  %elifidni %1, word es
 10905                              <2>  o16 push %1
 10906                              <2>  %elifidni %1, word fs
 10907                              <2>  o16 push %1
 10908                              <2>  %elifidni %1, word gs
 10909                              <2>  o16 push %1
 10910                              <2>  %else
 10911 00000BCF 66FF750E            <2>  push %1
 10912                              <2>  %endif
 10913                              <2> 
 10914                              <2>  %rotate -1
 10915                              <2> 
 10916                              <2> 
 10917                              <2> 
 10918                              <2> 
 10919                              <2> 
 10920                              <2> 
 10921                              <2> 
 10922                              <2>  %ifidni %1, cs
 10923                              <2>  o16 push %1
 10924                              <2>  %elifidni %1, ds
 10925                              <2>  o16 push %1
 10926                              <2>  %elifidni %1, es
 10927                              <2>  o16 push %1
 10928                              <2>  %elifidni %1, fs
 10929                              <2>  o16 push %1
 10930                              <2>  %elifidni %1, gs
 10931                              <2>  o16 push %1
 10932                              <2>  %elifidni %1, word cs
 10933                              <2>  o16 push %1
 10934                              <2>  %elifidni %1, word ds
 10935                              <2>  o16 push %1
 10936                              <2>  %elifidni %1, word es
 10937                              <2>  o16 push %1
 10938                              <2>  %elifidni %1, word fs
 10939                              <2>  o16 push %1
 10940                              <2>  %elifidni %1, word gs
 10941                              <2>  o16 push %1
 10942                              <2>  %else
 10943 00000BD3 66FF750C            <2>  push %1
 10944                              <2>  %endif
 10945                              <2> 
 10946                              <2>  %rotate -1
 10947                              <2> 
 10948                              <2> 
 10949                              <2> 
 10950                              <2> 
 10951                              <2> 
 10952                              <2> 
 10953                              <2> 
 10954                              <2>  %ifidni %1, cs
 10955                              <2>  o16 push %1
 10956                              <2>  %elifidni %1, ds
 10957                              <2>  o16 push %1
 10958                              <2>  %elifidni %1, es
 10959                              <2>  o16 push %1
 10960                              <2>  %elifidni %1, fs
 10961                              <2>  o16 push %1
 10962                              <2>  %elifidni %1, gs
 10963                              <2>  o16 push %1
 10964                              <2>  %elifidni %1, word cs
 10965                              <2>  o16 push %1
 10966                              <2>  %elifidni %1, word ds
 10967                              <2>  o16 push %1
 10968                              <2>  %elifidni %1, word es
 10969                              <2>  o16 push %1
 10970                              <2>  %elifidni %1, word fs
 10971                              <2>  o16 push %1
 10972                              <2>  %elifidni %1, word gs
 10973                              <2>  o16 push %1
 10974                              <2>  %else
 10975 00000BD7 FF7508              <2>  push %1
 10976                              <2>  %endif
 10977                              <2> 
 10978                              <2>  %rotate -1
 10979 00000BDA E81CF6FFFF          <1> call %1
 10980                              <1> %if (%0!=1)
 10981 00000BDF 83C40C              <1>  add esp, byte %1_arglen
 10982                              <1> %endif
 10983 00000BE2 39C6                    	cmp	esi, eax
 10984 00000BE4 75A3                    	jne	.loopFill
 10985 00000BE6 8B5D14                  	mov	ebx, [.Color + ebp]
 10986                                  
 10987 00000BE9 817D1800000000          	cmp	dword [.ComposeFlag + ebp], 0
 10988 00000BF0 744C                    	je	.noAlphaCompose
 10989 00000BF2 0F6E4514                	movd	mm0, [.Color + ebp]	;
 10990 00000BF6 0FEFFF                  	pxor	mm7, mm7		;
 10991 00000BF9 0F60C7                  	punpcklbw	mm0, mm7	; unpack .Color to mm0
 10992                                  
 10993 00000BFC 8A5517                  	mov	dl, [.Color + ebp + 3]	;
 10994 00000BFF 88D6                    	mov	dh, dl			;
 10995 00000C01 6689D3                  	mov	bx, dx			;
 10996 00000C04 C1E310                  	shl	ebx, 16			;
 10997 00000C07 6689D3                  	mov	bx, dx			;
 10998 00000C0A 0F6ED3                  	movd	mm2, ebx		;
 10999 00000C0D 0F60D7                  	punpcklbw	mm2, mm7	; copy out source alpha byte into ebx then to mm2
 11000                                  
 11001 00000C10 0FD5C2                  	pmullw	mm0, mm2		; alpha * source
 11002 00000C13 0FDD05[09020000]        	paddusw	mm0, [_RoundingFactor]
 11003 00000C1A 0F71D008                	psrlw	mm0, 8
 11004                                  
 11005 00000C1E 0F6EE0                  	movd	mm4, eax
 11006 00000C21 0F60E7                  	punpcklbw	mm4, mm7	; unpack low dword from mm4 into mm5 (destination)
 11007                                  
 11008 00000C24 0FDDC4                  	paddusw	mm0, mm4		; alpha * source + destination
 11009                                  
 11010 00000C27 0FD5E2                  	pmullw	mm4, mm2		; alpha * destination
 11011 00000C2A 0FDD25[09020000]        	paddusw	mm4, [_RoundingFactor]
 11012 00000C31 0F71D408                	psrlw	mm4, 8
 11013                                  
 11014 00000C35 0FD9C4                  	psubusw mm0, mm4		; (alpha * source) + destination - (alpha * destination)
 11015                                  
 11016 00000C38 0F67C7                  	packuswb	mm0, mm7	; pack into low word in mm0
 11017 00000C3B 0F7EC3                  	movd	ebx, mm0
 11018                                  
 11019                                  .noAlphaCompose
 11020 00000C3E 39C3                    	cmp	ebx, eax
 11021 00000C40 0F8443FFFFFF            	je	.loopFill
 11022                                  	invoke	_DrawPixel, dword [.DestOff + ebp], word [.DestWidth + ebp], word [.DestHeight + ebp], word [edi], word [edi + 2], ebx
 11023                              <1> %rotate -1
 11024                              <1> 
 11025                              <1> %rep (%0-1)
 11026                              <1> 
 11027                              <1> 
 11028                              <1> 
 11029                              <1> 
 11030                              <1> 
 11031                              <1> 
 11032                              <1> 
 11033                              <1>  %ifidni %1, cs
 11034                              <1>  o16 push %1
 11035                              <1>  %elifidni %1, ds
 11036                              <1>  o16 push %1
 11037                              <1>  %elifidni %1, es
 11038                              <1>  o16 push %1
 11039                              <1>  %elifidni %1, fs
 11040                              <1>  o16 push %1
 11041                              <1>  %elifidni %1, gs
 11042                              <1>  o16 push %1
 11043                              <1>  %elifidni %1, word cs
 11044                              <1>  o16 push %1
 11045                              <1>  %elifidni %1, word ds
 11046                              <1>  o16 push %1
 11047                              <1>  %elifidni %1, word es
 11048                              <1>  o16 push %1
 11049                              <1>  %elifidni %1, word fs
 11050                              <1>  o16 push %1
 11051                              <1>  %elifidni %1, word gs
 11052                              <1>  o16 push %1
 11053                              <1>  %else
 11054                              <1>  push %1
 11055                              <1>  %endif
 11056                              <1> 
 11057                              <1>  %rotate -1
 11058                              <1> %endrep
 11059                              <2> 
 11060                              <2> 
 11061                              <2> 
 11062                              <2> 
 11063                              <2> 
 11064                              <2> 
 11065                              <2> 
 11066                              <2>  %ifidni %1, cs
 11067                              <2>  o16 push %1
 11068                              <2>  %elifidni %1, ds
 11069                              <2>  o16 push %1
 11070                              <2>  %elifidni %1, es
 11071                              <2>  o16 push %1
 11072                              <2>  %elifidni %1, fs
 11073                              <2>  o16 push %1
 11074                              <2>  %elifidni %1, gs
 11075                              <2>  o16 push %1
 11076                              <2>  %elifidni %1, word cs
 11077                              <2>  o16 push %1
 11078                              <2>  %elifidni %1, word ds
 11079                              <2>  o16 push %1
 11080                              <2>  %elifidni %1, word es
 11081                              <2>  o16 push %1
 11082                              <2>  %elifidni %1, word fs
 11083                              <2>  o16 push %1
 11084                              <2>  %elifidni %1, word gs
 11085                              <2>  o16 push %1
 11086                              <2>  %else
 11087 00000C46 53                  <2>  push %1
 11088                              <2>  %endif
 11089                              <2> 
 11090                              <2>  %rotate -1
 11091                              <2> 
 11092                              <2> 
 11093                              <2> 
 11094                              <2> 
 11095                              <2> 
 11096                              <2> 
 11097                              <2> 
 11098                              <2>  %ifidni %1, cs
 11099                              <2>  o16 push %1
 11100                              <2>  %elifidni %1, ds
 11101                              <2>  o16 push %1
 11102                              <2>  %elifidni %1, es
 11103                              <2>  o16 push %1
 11104                              <2>  %elifidni %1, fs
 11105                              <2>  o16 push %1
 11106                              <2>  %elifidni %1, gs
 11107                              <2>  o16 push %1
 11108                              <2>  %elifidni %1, word cs
 11109                              <2>  o16 push %1
 11110                              <2>  %elifidni %1, word ds
 11111                              <2>  o16 push %1
 11112                              <2>  %elifidni %1, word es
 11113                              <2>  o16 push %1
 11114                              <2>  %elifidni %1, word fs
 11115                              <2>  o16 push %1
 11116                              <2>  %elifidni %1, word gs
 11117                              <2>  o16 push %1
 11118                              <2>  %else
 11119 00000C47 66FF7702            <2>  push %1
 11120                              <2>  %endif
 11121                              <2> 
 11122                              <2>  %rotate -1
 11123                              <2> 
 11124                              <2> 
 11125                              <2> 
 11126                              <2> 
 11127                              <2> 
 11128                              <2> 
 11129                              <2> 
 11130                              <2>  %ifidni %1, cs
 11131                              <2>  o16 push %1
 11132                              <2>  %elifidni %1, ds
 11133                              <2>  o16 push %1
 11134                              <2>  %elifidni %1, es
 11135                              <2>  o16 push %1
 11136                              <2>  %elifidni %1, fs
 11137                              <2>  o16 push %1
 11138                              <2>  %elifidni %1, gs
 11139                              <2>  o16 push %1
 11140                              <2>  %elifidni %1, word cs
 11141                              <2>  o16 push %1
 11142                              <2>  %elifidni %1, word ds
 11143                              <2>  o16 push %1
 11144                              <2>  %elifidni %1, word es
 11145                              <2>  o16 push %1
 11146                              <2>  %elifidni %1, word fs
 11147                              <2>  o16 push %1
 11148                              <2>  %elifidni %1, word gs
 11149                              <2>  o16 push %1
 11150                              <2>  %else
 11151 00000C4B 66FF37              <2>  push %1
 11152                              <2>  %endif
 11153                              <2> 
 11154                              <2>  %rotate -1
 11155                              <2> 
 11156                              <2> 
 11157                              <2> 
 11158                              <2> 
 11159                              <2> 
 11160                              <2> 
 11161                              <2> 
 11162                              <2>  %ifidni %1, cs
 11163                              <2>  o16 push %1
 11164                              <2>  %elifidni %1, ds
 11165                              <2>  o16 push %1
 11166                              <2>  %elifidni %1, es
 11167                              <2>  o16 push %1
 11168                              <2>  %elifidni %1, fs
 11169                              <2>  o16 push %1
 11170                              <2>  %elifidni %1, gs
 11171                              <2>  o16 push %1
 11172                              <2>  %elifidni %1, word cs
 11173                              <2>  o16 push %1
 11174                              <2>  %elifidni %1, word ds
 11175                              <2>  o16 push %1
 11176                              <2>  %elifidni %1, word es
 11177                              <2>  o16 push %1
 11178                              <2>  %elifidni %1, word fs
 11179                              <2>  o16 push %1
 11180                              <2>  %elifidni %1, word gs
 11181                              <2>  o16 push %1
 11182                              <2>  %else
 11183 00000C4E 66FF750E            <2>  push %1
 11184                              <2>  %endif
 11185                              <2> 
 11186                              <2>  %rotate -1
 11187                              <2> 
 11188                              <2> 
 11189                              <2> 
 11190                              <2> 
 11191                              <2> 
 11192                              <2> 
 11193                              <2> 
 11194                              <2>  %ifidni %1, cs
 11195                              <2>  o16 push %1
 11196                              <2>  %elifidni %1, ds
 11197                              <2>  o16 push %1
 11198                              <2>  %elifidni %1, es
 11199                              <2>  o16 push %1
 11200                              <2>  %elifidni %1, fs
 11201                              <2>  o16 push %1
 11202                              <2>  %elifidni %1, gs
 11203                              <2>  o16 push %1
 11204                              <2>  %elifidni %1, word cs
 11205                              <2>  o16 push %1
 11206                              <2>  %elifidni %1, word ds
 11207                              <2>  o16 push %1
 11208                              <2>  %elifidni %1, word es
 11209                              <2>  o16 push %1
 11210                              <2>  %elifidni %1, word fs
 11211                              <2>  o16 push %1
 11212                              <2>  %elifidni %1, word gs
 11213                              <2>  o16 push %1
 11214                              <2>  %else
 11215 00000C52 66FF750C            <2>  push %1
 11216                              <2>  %endif
 11217                              <2> 
 11218                              <2>  %rotate -1
 11219                              <2> 
 11220                              <2> 
 11221                              <2> 
 11222                              <2> 
 11223                              <2> 
 11224                              <2> 
 11225                              <2> 
 11226                              <2>  %ifidni %1, cs
 11227                              <2>  o16 push %1
 11228                              <2>  %elifidni %1, ds
 11229                              <2>  o16 push %1
 11230                              <2>  %elifidni %1, es
 11231                              <2>  o16 push %1
 11232                              <2>  %elifidni %1, fs
 11233                              <2>  o16 push %1
 11234                              <2>  %elifidni %1, gs
 11235                              <2>  o16 push %1
 11236                              <2>  %elifidni %1, word cs
 11237                              <2>  o16 push %1
 11238                              <2>  %elifidni %1, word ds
 11239                              <2>  o16 push %1
 11240                              <2>  %elifidni %1, word es
 11241                              <2>  o16 push %1
 11242                              <2>  %elifidni %1, word fs
 11243                              <2>  o16 push %1
 11244                              <2>  %elifidni %1, word gs
 11245                              <2>  o16 push %1
 11246                              <2>  %else
 11247 00000C56 FF7508              <2>  push %1
 11248                              <2>  %endif
 11249                              <2> 
 11250                              <2>  %rotate -1
 11251 00000C59 E8E3F5FFFF          <1> call %1
 11252                              <1> %if (%0!=1)
 11253 00000C5E 83C410              <1>  add esp, byte %1_arglen
 11254                              <1> %endif
 11255 00000C61 668B07                  	mov	ax, [edi]
 11256 00000C64 668B5F02                	mov	bx, [edi + 2]
 11257 00000C68 8B3D[4E000000]          	mov	edi, [_QueueTail]
 11258                                  
 11259 00000C6E 6640                    	inc	ax			;
 11260 00000C70 668907                  	mov	[edi], ax		;
 11261 00000C73 66895F02                	mov	[edi + 2], bx		; enqueue (X + 1, Y)
 11262                                  
 11263 00000C77 662D0200                	sub	ax, 2			;
 11264 00000C7B 66894704                	mov	[edi + 4], ax		;
 11265 00000C7F 66895F06                	mov	[edi + 6], bx		; enqueue (X - 1, Y)
 11266                                  
 11267 00000C83 6640                    	inc	ax			;
 11268 00000C85 66894708                	mov	[edi + 8], ax		;
 11269 00000C89 6643                    	inc	bx			;
 11270 00000C8B 66895F0A                	mov	[edi + 10], bx		; enqueue (X, Y + 1)
 11271                                  
 11272 00000C8F 6689470C                	mov	[edi + 12], ax		;
 11273 00000C93 6681EB0200              	sub	bx, 2			;
 11274 00000C98 66895F0E                	mov	[edi + 14], bx		; enqueue (X, Y - 1)
 11275                                  
 11276 00000C9C 8105[4E000000]1000-     	add	dword [_QueueTail], 16
 11277 00000CA4 0000               
 11278 00000CA6 E9DEFEFFFF              	jmp	.loopFill
 11279                                  
 11280                                  .done
 11281 00000CAB 5F                      	pop	edi
 11282 00000CAC 5E                      	pop	esi
 11283                                  	ret
 11284                              <1> %ifnctx proc
 11285                              <1>  ret %1
 11286                              <1> %else
 11287 00000CAD 89EC                <1>  mov esp, ebp
 11288 00000CAF 5D                  <1>  pop ebp
 11289 00000CB0 C3                  <1>  ret %1
 11290                              <1> %endif
 11291                                  
 11292                                  endproc
 11293                              <1> %ifnctx proc
 11294                              <1> %error Mismatched `endproc'/`proc'
 11295                              <1> %else
 11296                              <1> .STACK_FRAME_SIZE equ %$local
 11297                              <1> 
 11298                              <1> 
 11299                              <1> %ifdef LEGACY_ENDPROC
 11300                              <1>  ret
 11301                              <1> %endif
 11302                              <1> 
 11303                              <1> 
 11304                              <1> 
 11305                              <1> 
 11306                              <1> 
 11307                              <1> 
 11308                              <1> 
 11309                              <1> 
 11310                              <1> 
 11311                              <1> %pop
 11312                              <1> %endif
 11313                                  _FloodFill_arglen	EQU	20
 11314                                  
 11315                                  ;--------------------------------------------------------------
 11316                                  ;-- dword InstallKeyboard(void)                              --
 11317                                  ;--------------------------------------------------------------
 11318                                  ; Inputs : -
 11319                                  ; Outputs : -
 11320                                  ; Returns : 1 on error; 0 otherwise
 11321                                  ; Calls : _LockArea
 11322                                  ; - installs teh keyboard ISR
 11323                                  _InstallKeyboard
 11324                                  ;	call	_libInstallKeyboard
 11325                                  
 11326                                  	invoke	_LockArea, ds, dword _kbINT, dword 1	;
 11327                              <1> %rotate -1
 11328                              <1> 
 11329                              <1> %rep (%0-1)
 11330                              <1> 
 11331                              <1> 
 11332                              <1> 
 11333                              <1> 
 11334                              <1> 
 11335                              <1> 
 11336                              <1> 
 11337                              <1>  %ifidni %1, cs
 11338                              <1>  o16 push %1
 11339                              <1>  %elifidni %1, ds
 11340                              <1>  o16 push %1
 11341                              <1>  %elifidni %1, es
 11342                              <1>  o16 push %1
 11343                              <1>  %elifidni %1, fs
 11344                              <1>  o16 push %1
 11345                              <1>  %elifidni %1, gs
 11346                              <1>  o16 push %1
 11347                              <1>  %elifidni %1, word cs
 11348                              <1>  o16 push %1
 11349                              <1>  %elifidni %1, word ds
 11350                              <1>  o16 push %1
 11351                              <1>  %elifidni %1, word es
 11352                              <1>  o16 push %1
 11353                              <1>  %elifidni %1, word fs
 11354                              <1>  o16 push %1
 11355                              <1>  %elifidni %1, word gs
 11356                              <1>  o16 push %1
 11357                              <1>  %else
 11358                              <1>  push %1
 11359                              <1>  %endif
 11360                              <1> 
 11361                              <1>  %rotate -1
 11362                              <1> %endrep
 11363                              <2> 
 11364                              <2> 
 11365                              <2> 
 11366                              <2> 
 11367                              <2> 
 11368                              <2> 
 11369                              <2> 
 11370                              <2>  %ifidni %1, cs
 11371                              <2>  o16 push %1
 11372                              <2>  %elifidni %1, ds
 11373                              <2>  o16 push %1
 11374                              <2>  %elifidni %1, es
 11375                              <2>  o16 push %1
 11376                              <2>  %elifidni %1, fs
 11377                              <2>  o16 push %1
 11378                              <2>  %elifidni %1, gs
 11379                              <2>  o16 push %1
 11380                              <2>  %elifidni %1, word cs
 11381                              <2>  o16 push %1
 11382                              <2>  %elifidni %1, word ds
 11383                              <2>  o16 push %1
 11384                              <2>  %elifidni %1, word es
 11385                              <2>  o16 push %1
 11386                              <2>  %elifidni %1, word fs
 11387                              <2>  o16 push %1
 11388                              <2>  %elifidni %1, word gs
 11389                              <2>  o16 push %1
 11390                              <2>  %else
 11391 00000CB1 6801000000          <2>  push %1
 11392                              <2>  %endif
 11393                              <2> 
 11394                              <2>  %rotate -1
 11395                              <2> 
 11396                              <2> 
 11397                              <2> 
 11398                              <2> 
 11399                              <2> 
 11400                              <2> 
 11401                              <2> 
 11402                              <2>  %ifidni %1, cs
 11403                              <2>  o16 push %1
 11404                              <2>  %elifidni %1, ds
 11405                              <2>  o16 push %1
 11406                              <2>  %elifidni %1, es
 11407                              <2>  o16 push %1
 11408                              <2>  %elifidni %1, fs
 11409                              <2>  o16 push %1
 11410                              <2>  %elifidni %1, gs
 11411                              <2>  o16 push %1
 11412                              <2>  %elifidni %1, word cs
 11413                              <2>  o16 push %1
 11414                              <2>  %elifidni %1, word ds
 11415                              <2>  o16 push %1
 11416                              <2>  %elifidni %1, word es
 11417                              <2>  o16 push %1
 11418                              <2>  %elifidni %1, word fs
 11419                              <2>  o16 push %1
 11420                              <2>  %elifidni %1, word gs
 11421                              <2>  o16 push %1
 11422                              <2>  %else
 11423 00000CB6 68[02000000]        <2>  push %1
 11424                              <2>  %endif
 11425                              <2> 
 11426                              <2>  %rotate -1
 11427                              <2> 
 11428                              <2> 
 11429                              <2> 
 11430                              <2> 
 11431                              <2> 
 11432                              <2> 
 11433                              <2> 
 11434                              <2>  %ifidni %1, cs
 11435                              <2>  o16 push %1
 11436                              <2>  %elifidni %1, ds
 11437 00000CBB 661E                <2>  o16 push %1
 11438                              <2>  %elifidni %1, es
 11439                              <2>  o16 push %1
 11440                              <2>  %elifidni %1, fs
 11441                              <2>  o16 push %1
 11442                              <2>  %elifidni %1, gs
 11443                              <2>  o16 push %1
 11444                              <2>  %elifidni %1, word cs
 11445                              <2>  o16 push %1
 11446                              <2>  %elifidni %1, word ds
 11447                              <2>  o16 push %1
 11448                              <2>  %elifidni %1, word es
 11449                              <2>  o16 push %1
 11450                              <2>  %elifidni %1, word fs
 11451                              <2>  o16 push %1
 11452                              <2>  %elifidni %1, word gs
 11453                              <2>  o16 push %1
 11454                              <2>  %else
 11455                              <2>  push %1
 11456                              <2>  %endif
 11457                              <2> 
 11458                              <2>  %rotate -1
 11459 00000CBD E8(00000000)        <1> call %1
 11460                              <1> %if (%0!=1)
 11461 00000CC2 83C40A              <1>  add esp, byte %1_arglen
 11462                              <1> %endif
 11463                                  	invoke	_LockArea, ds, dword _kbIRQ, dword 1	;
 11464                              <1> %rotate -1
 11465                              <1> 
 11466                              <1> %rep (%0-1)
 11467                              <1> 
 11468                              <1> 
 11469                              <1> 
 11470                              <1> 
 11471                              <1> 
 11472                              <1> 
 11473                              <1> 
 11474                              <1>  %ifidni %1, cs
 11475                              <1>  o16 push %1
 11476                              <1>  %elifidni %1, ds
 11477                              <1>  o16 push %1
 11478                              <1>  %elifidni %1, es
 11479                              <1>  o16 push %1
 11480                              <1>  %elifidni %1, fs
 11481                              <1>  o16 push %1
 11482                              <1>  %elifidni %1, gs
 11483                              <1>  o16 push %1
 11484                              <1>  %elifidni %1, word cs
 11485                              <1>  o16 push %1
 11486                              <1>  %elifidni %1, word ds
 11487                              <1>  o16 push %1
 11488                              <1>  %elifidni %1, word es
 11489                              <1>  o16 push %1
 11490                              <1>  %elifidni %1, word fs
 11491                              <1>  o16 push %1
 11492                              <1>  %elifidni %1, word gs
 11493                              <1>  o16 push %1
 11494                              <1>  %else
 11495                              <1>  push %1
 11496                              <1>  %endif
 11497                              <1> 
 11498                              <1>  %rotate -1
 11499                              <1> %endrep
 11500                              <2> 
 11501                              <2> 
 11502                              <2> 
 11503                              <2> 
 11504                              <2> 
 11505                              <2> 
 11506                              <2> 
 11507                              <2>  %ifidni %1, cs
 11508                              <2>  o16 push %1
 11509                              <2>  %elifidni %1, ds
 11510                              <2>  o16 push %1
 11511                              <2>  %elifidni %1, es
 11512                              <2>  o16 push %1
 11513                              <2>  %elifidni %1, fs
 11514                              <2>  o16 push %1
 11515                              <2>  %elifidni %1, gs
 11516                              <2>  o16 push %1
 11517                              <2>  %elifidni %1, word cs
 11518                              <2>  o16 push %1
 11519                              <2>  %elifidni %1, word ds
 11520                              <2>  o16 push %1
 11521                              <2>  %elifidni %1, word es
 11522                              <2>  o16 push %1
 11523                              <2>  %elifidni %1, word fs
 11524                              <2>  o16 push %1
 11525                              <2>  %elifidni %1, word gs
 11526                              <2>  o16 push %1
 11527                              <2>  %else
 11528 00000CC5 6801000000          <2>  push %1
 11529                              <2>  %endif
 11530                              <2> 
 11531                              <2>  %rotate -1
 11532                              <2> 
 11533                              <2> 
 11534                              <2> 
 11535                              <2> 
 11536                              <2> 
 11537                              <2> 
 11538                              <2> 
 11539                              <2>  %ifidni %1, cs
 11540                              <2>  o16 push %1
 11541                              <2>  %elifidni %1, ds
 11542                              <2>  o16 push %1
 11543                              <2>  %elifidni %1, es
 11544                              <2>  o16 push %1
 11545                              <2>  %elifidni %1, fs
 11546                              <2>  o16 push %1
 11547                              <2>  %elifidni %1, gs
 11548                              <2>  o16 push %1
 11549                              <2>  %elifidni %1, word cs
 11550                              <2>  o16 push %1
 11551                              <2>  %elifidni %1, word ds
 11552                              <2>  o16 push %1
 11553                              <2>  %elifidni %1, word es
 11554                              <2>  o16 push %1
 11555                              <2>  %elifidni %1, word fs
 11556                              <2>  o16 push %1
 11557                              <2>  %elifidni %1, word gs
 11558                              <2>  o16 push %1
 11559                              <2>  %else
 11560 00000CCA 68[03000000]        <2>  push %1
 11561                              <2>  %endif
 11562                              <2> 
 11563                              <2>  %rotate -1
 11564                              <2> 
 11565                              <2> 
 11566                              <2> 
 11567                              <2> 
 11568                              <2> 
 11569                              <2> 
 11570                              <2> 
 11571                              <2>  %ifidni %1, cs
 11572                              <2>  o16 push %1
 11573                              <2>  %elifidni %1, ds
 11574 00000CCF 661E                <2>  o16 push %1
 11575                              <2>  %elifidni %1, es
 11576                              <2>  o16 push %1
 11577                              <2>  %elifidni %1, fs
 11578                              <2>  o16 push %1
 11579                              <2>  %elifidni %1, gs
 11580                              <2>  o16 push %1
 11581                              <2>  %elifidni %1, word cs
 11582                              <2>  o16 push %1
 11583                              <2>  %elifidni %1, word ds
 11584                              <2>  o16 push %1
 11585                              <2>  %elifidni %1, word es
 11586                              <2>  o16 push %1
 11587                              <2>  %elifidni %1, word fs
 11588                              <2>  o16 push %1
 11589                              <2>  %elifidni %1, word gs
 11590                              <2>  o16 push %1
 11591                              <2>  %else
 11592                              <2>  push %1
 11593                              <2>  %endif
 11594                              <2> 
 11595                              <2>  %rotate -1
 11596 00000CD1 E8(00000000)        <1> call %1
 11597                              <1> %if (%0!=1)
 11598 00000CD6 83C40A              <1>  add esp, byte %1_arglen
 11599                              <1> %endif
 11600                                  	invoke	_LockArea, ds, dword _kbIRQ, dword 2	;
 11601                              <1> %rotate -1
 11602                              <1> 
 11603                              <1> %rep (%0-1)
 11604                              <1> 
 11605                              <1> 
 11606                              <1> 
 11607                              <1> 
 11608                              <1> 
 11609                              <1> 
 11610                              <1> 
 11611                              <1>  %ifidni %1, cs
 11612                              <1>  o16 push %1
 11613                              <1>  %elifidni %1, ds
 11614                              <1>  o16 push %1
 11615                              <1>  %elifidni %1, es
 11616                              <1>  o16 push %1
 11617                              <1>  %elifidni %1, fs
 11618                              <1>  o16 push %1
 11619                              <1>  %elifidni %1, gs
 11620                              <1>  o16 push %1
 11621                              <1>  %elifidni %1, word cs
 11622                              <1>  o16 push %1
 11623                              <1>  %elifidni %1, word ds
 11624                              <1>  o16 push %1
 11625                              <1>  %elifidni %1, word es
 11626                              <1>  o16 push %1
 11627                              <1>  %elifidni %1, word fs
 11628                              <1>  o16 push %1
 11629                              <1>  %elifidni %1, word gs
 11630                              <1>  o16 push %1
 11631                              <1>  %else
 11632                              <1>  push %1
 11633                              <1>  %endif
 11634                              <1> 
 11635                              <1>  %rotate -1
 11636                              <1> %endrep
 11637                              <2> 
 11638                              <2> 
 11639                              <2> 
 11640                              <2> 
 11641                              <2> 
 11642                              <2> 
 11643                              <2> 
 11644                              <2>  %ifidni %1, cs
 11645                              <2>  o16 push %1
 11646                              <2>  %elifidni %1, ds
 11647                              <2>  o16 push %1
 11648                              <2>  %elifidni %1, es
 11649                              <2>  o16 push %1
 11650                              <2>  %elifidni %1, fs
 11651                              <2>  o16 push %1
 11652                              <2>  %elifidni %1, gs
 11653                              <2>  o16 push %1
 11654                              <2>  %elifidni %1, word cs
 11655                              <2>  o16 push %1
 11656                              <2>  %elifidni %1, word ds
 11657                              <2>  o16 push %1
 11658                              <2>  %elifidni %1, word es
 11659                              <2>  o16 push %1
 11660                              <2>  %elifidni %1, word fs
 11661                              <2>  o16 push %1
 11662                              <2>  %elifidni %1, word gs
 11663                              <2>  o16 push %1
 11664                              <2>  %else
 11665 00000CD9 6802000000          <2>  push %1
 11666                              <2>  %endif
 11667                              <2> 
 11668                              <2>  %rotate -1
 11669                              <2> 
 11670                              <2> 
 11671                              <2> 
 11672                              <2> 
 11673                              <2> 
 11674                              <2> 
 11675                              <2> 
 11676                              <2>  %ifidni %1, cs
 11677                              <2>  o16 push %1
 11678                              <2>  %elifidni %1, ds
 11679                              <2>  o16 push %1
 11680                              <2>  %elifidni %1, es
 11681                              <2>  o16 push %1
 11682                              <2>  %elifidni %1, fs
 11683                              <2>  o16 push %1
 11684                              <2>  %elifidni %1, gs
 11685                              <2>  o16 push %1
 11686                              <2>  %elifidni %1, word cs
 11687                              <2>  o16 push %1
 11688                              <2>  %elifidni %1, word ds
 11689                              <2>  o16 push %1
 11690                              <2>  %elifidni %1, word es
 11691                              <2>  o16 push %1
 11692                              <2>  %elifidni %1, word fs
 11693                              <2>  o16 push %1
 11694                              <2>  %elifidni %1, word gs
 11695                              <2>  o16 push %1
 11696                              <2>  %else
 11697 00000CDE 68[03000000]        <2>  push %1
 11698                              <2>  %endif
 11699                              <2> 
 11700                              <2>  %rotate -1
 11701                              <2> 
 11702                              <2> 
 11703                              <2> 
 11704                              <2> 
 11705                              <2> 
 11706                              <2> 
 11707                              <2> 
 11708                              <2>  %ifidni %1, cs
 11709                              <2>  o16 push %1
 11710                              <2>  %elifidni %1, ds
 11711 00000CE3 661E                <2>  o16 push %1
 11712                              <2>  %elifidni %1, es
 11713                              <2>  o16 push %1
 11714                              <2>  %elifidni %1, fs
 11715                              <2>  o16 push %1
 11716                              <2>  %elifidni %1, gs
 11717                              <2>  o16 push %1
 11718                              <2>  %elifidni %1, word cs
 11719                              <2>  o16 push %1
 11720                              <2>  %elifidni %1, word ds
 11721                              <2>  o16 push %1
 11722                              <2>  %elifidni %1, word es
 11723                              <2>  o16 push %1
 11724                              <2>  %elifidni %1, word fs
 11725                              <2>  o16 push %1
 11726                              <2>  %elifidni %1, word gs
 11727                              <2>  o16 push %1
 11728                              <2>  %else
 11729                              <2>  push %1
 11730                              <2>  %endif
 11731                              <2> 
 11732                              <2>  %rotate -1
 11733 00000CE5 E8(00000000)        <1> call %1
 11734                              <1> %if (%0!=1)
 11735 00000CEA 83C40A              <1>  add esp, byte %1_arglen
 11736                              <1> %endif
 11737 00000CED B8[0A0E0000]            	mov	eax, _KeyboardISR_end			;
 11738 00000CF2 B8[370D0000]            	mov	eax, _KeyboardISR			;
 11739                                  	invoke	_LockArea, cs, dword _KeyboardISR, eax	; lock variables and handler
 11740                              <1> %rotate -1
 11741                              <1> 
 11742                              <1> %rep (%0-1)
 11743                              <1> 
 11744                              <1> 
 11745                              <1> 
 11746                              <1> 
 11747                              <1> 
 11748                              <1> 
 11749                              <1> 
 11750                              <1>  %ifidni %1, cs
 11751                              <1>  o16 push %1
 11752                              <1>  %elifidni %1, ds
 11753                              <1>  o16 push %1
 11754                              <1>  %elifidni %1, es
 11755                              <1>  o16 push %1
 11756                              <1>  %elifidni %1, fs
 11757                              <1>  o16 push %1
 11758                              <1>  %elifidni %1, gs
 11759                              <1>  o16 push %1
 11760                              <1>  %elifidni %1, word cs
 11761                              <1>  o16 push %1
 11762                              <1>  %elifidni %1, word ds
 11763                              <1>  o16 push %1
 11764                              <1>  %elifidni %1, word es
 11765                              <1>  o16 push %1
 11766                              <1>  %elifidni %1, word fs
 11767                              <1>  o16 push %1
 11768                              <1>  %elifidni %1, word gs
 11769                              <1>  o16 push %1
 11770                              <1>  %else
 11771                              <1>  push %1
 11772                              <1>  %endif
 11773                              <1> 
 11774                              <1>  %rotate -1
 11775                              <1> %endrep
 11776                              <2> 
 11777                              <2> 
 11778                              <2> 
 11779                              <2> 
 11780                              <2> 
 11781                              <2> 
 11782                              <2> 
 11783                              <2>  %ifidni %1, cs
 11784                              <2>  o16 push %1
 11785                              <2>  %elifidni %1, ds
 11786                              <2>  o16 push %1
 11787                              <2>  %elifidni %1, es
 11788                              <2>  o16 push %1
 11789                              <2>  %elifidni %1, fs
 11790                              <2>  o16 push %1
 11791                              <2>  %elifidni %1, gs
 11792                              <2>  o16 push %1
 11793                              <2>  %elifidni %1, word cs
 11794                              <2>  o16 push %1
 11795                              <2>  %elifidni %1, word ds
 11796                              <2>  o16 push %1
 11797                              <2>  %elifidni %1, word es
 11798                              <2>  o16 push %1
 11799                              <2>  %elifidni %1, word fs
 11800                              <2>  o16 push %1
 11801                              <2>  %elifidni %1, word gs
 11802                              <2>  o16 push %1
 11803                              <2>  %else
 11804 00000CF7 50                  <2>  push %1
 11805                              <2>  %endif
 11806                              <2> 
 11807                              <2>  %rotate -1
 11808                              <2> 
 11809                              <2> 
 11810                              <2> 
 11811                              <2> 
 11812                              <2> 
 11813                              <2> 
 11814                              <2> 
 11815                              <2>  %ifidni %1, cs
 11816                              <2>  o16 push %1
 11817                              <2>  %elifidni %1, ds
 11818                              <2>  o16 push %1
 11819                              <2>  %elifidni %1, es
 11820                              <2>  o16 push %1
 11821                              <2>  %elifidni %1, fs
 11822                              <2>  o16 push %1
 11823                              <2>  %elifidni %1, gs
 11824                              <2>  o16 push %1
 11825                              <2>  %elifidni %1, word cs
 11826                              <2>  o16 push %1
 11827                              <2>  %elifidni %1, word ds
 11828                              <2>  o16 push %1
 11829                              <2>  %elifidni %1, word es
 11830                              <2>  o16 push %1
 11831                              <2>  %elifidni %1, word fs
 11832                              <2>  o16 push %1
 11833                              <2>  %elifidni %1, word gs
 11834                              <2>  o16 push %1
 11835                              <2>  %else
 11836 00000CF8 68[370D0000]        <2>  push %1
 11837                              <2>  %endif
 11838                              <2> 
 11839                              <2>  %rotate -1
 11840                              <2> 
 11841                              <2> 
 11842                              <2> 
 11843                              <2> 
 11844                              <2> 
 11845                              <2> 
 11846                              <2> 
 11847                              <2>  %ifidni %1, cs
 11848 00000CFD 660E                <2>  o16 push %1
 11849                              <2>  %elifidni %1, ds
 11850                              <2>  o16 push %1
 11851                              <2>  %elifidni %1, es
 11852                              <2>  o16 push %1
 11853                              <2>  %elifidni %1, fs
 11854                              <2>  o16 push %1
 11855                              <2>  %elifidni %1, gs
 11856                              <2>  o16 push %1
 11857                              <2>  %elifidni %1, word cs
 11858                              <2>  o16 push %1
 11859                              <2>  %elifidni %1, word ds
 11860                              <2>  o16 push %1
 11861                              <2>  %elifidni %1, word es
 11862                              <2>  o16 push %1
 11863                              <2>  %elifidni %1, word fs
 11864                              <2>  o16 push %1
 11865                              <2>  %elifidni %1, word gs
 11866                              <2>  o16 push %1
 11867                              <2>  %else
 11868                              <2>  push %1
 11869                              <2>  %endif
 11870                              <2> 
 11871                              <2>  %rotate -1
 11872 00000CFF E8(00000000)        <1> call %1
 11873                              <1> %if (%0!=1)
 11874 00000D04 83C40A              <1>  add esp, byte %1_arglen
 11875                              <1> %endif
 11876                                  
 11877 00000D07 0FB605[02000000]        	movzx	eax, byte [_kbINT]
 11878                                  	invoke	_Install_Int, eax, dword _KeyboardISR
 11879                              <1> %rotate -1
 11880                              <1> 
 11881                              <1> %rep (%0-1)
 11882                              <1> 
 11883                              <1> 
 11884                              <1> 
 11885                              <1> 
 11886                              <1> 
 11887                              <1> 
 11888                              <1> 
 11889                              <1>  %ifidni %1, cs
 11890                              <1>  o16 push %1
 11891                              <1>  %elifidni %1, ds
 11892                              <1>  o16 push %1
 11893                              <1>  %elifidni %1, es
 11894                              <1>  o16 push %1
 11895                              <1>  %elifidni %1, fs
 11896                              <1>  o16 push %1
 11897                              <1>  %elifidni %1, gs
 11898                              <1>  o16 push %1
 11899                              <1>  %elifidni %1, word cs
 11900                              <1>  o16 push %1
 11901                              <1>  %elifidni %1, word ds
 11902                              <1>  o16 push %1
 11903                              <1>  %elifidni %1, word es
 11904                              <1>  o16 push %1
 11905                              <1>  %elifidni %1, word fs
 11906                              <1>  o16 push %1
 11907                              <1>  %elifidni %1, word gs
 11908                              <1>  o16 push %1
 11909                              <1>  %else
 11910                              <1>  push %1
 11911                              <1>  %endif
 11912                              <1> 
 11913                              <1>  %rotate -1
 11914                              <1> %endrep
 11915                              <2> 
 11916                              <2> 
 11917                              <2> 
 11918                              <2> 
 11919                              <2> 
 11920                              <2> 
 11921                              <2> 
 11922                              <2>  %ifidni %1, cs
 11923                              <2>  o16 push %1
 11924                              <2>  %elifidni %1, ds
 11925                              <2>  o16 push %1
 11926                              <2>  %elifidni %1, es
 11927                              <2>  o16 push %1
 11928                              <2>  %elifidni %1, fs
 11929                              <2>  o16 push %1
 11930                              <2>  %elifidni %1, gs
 11931                              <2>  o16 push %1
 11932                              <2>  %elifidni %1, word cs
 11933                              <2>  o16 push %1
 11934                              <2>  %elifidni %1, word ds
 11935                              <2>  o16 push %1
 11936                              <2>  %elifidni %1, word es
 11937                              <2>  o16 push %1
 11938                              <2>  %elifidni %1, word fs
 11939                              <2>  o16 push %1
 11940                              <2>  %elifidni %1, word gs
 11941                              <2>  o16 push %1
 11942                              <2>  %else
 11943 00000D0E 68[370D0000]        <2>  push %1
 11944                              <2>  %endif
 11945                              <2> 
 11946                              <2>  %rotate -1
 11947                              <2> 
 11948                              <2> 
 11949                              <2> 
 11950                              <2> 
 11951                              <2> 
 11952                              <2> 
 11953                              <2> 
 11954                              <2>  %ifidni %1, cs
 11955                              <2>  o16 push %1
 11956                              <2>  %elifidni %1, ds
 11957                              <2>  o16 push %1
 11958                              <2>  %elifidni %1, es
 11959                              <2>  o16 push %1
 11960                              <2>  %elifidni %1, fs
 11961                              <2>  o16 push %1
 11962                              <2>  %elifidni %1, gs
 11963                              <2>  o16 push %1
 11964                              <2>  %elifidni %1, word cs
 11965                              <2>  o16 push %1
 11966                              <2>  %elifidni %1, word ds
 11967                              <2>  o16 push %1
 11968                              <2>  %elifidni %1, word es
 11969                              <2>  o16 push %1
 11970                              <2>  %elifidni %1, word fs
 11971                              <2>  o16 push %1
 11972                              <2>  %elifidni %1, word gs
 11973                              <2>  o16 push %1
 11974                              <2>  %else
 11975 00000D13 50                  <2>  push %1
 11976                              <2>  %endif
 11977                              <2> 
 11978                              <2>  %rotate -1
 11979 00000D14 E8(00000000)        <1> call %1
 11980                              <1> %if (%0!=1)
 11981 00000D19 83C408              <1>  add esp, byte %1_arglen
 11982                              <1> %endif
 11983 00000D1C 85C0                    	test	eax, eax	; check for error
 11984 00000D1E 7405                    	jz	.done
 11985 00000D20 B801000000              	mov	eax, 1
 11986                                  
 11987                                  .done
 11988                                  	ret
 11989                              <1> %ifnctx proc
 11990 00000D25 C3                  <1>  ret %1
 11991                              <1> %else
 11992                              <1>  mov esp, ebp
 11993                              <1>  pop ebp
 11994                              <1>  ret %1
 11995                              <1> %endif
 11996                                  
 11997                                  ;--------------------------------------------------------------
 11998                                  ;-- void RemoveKeyboard(void)                                --
 11999                                  ;--------------------------------------------------------------
 12000                                  ; Inputs : -
 12001                                  ; Outputs : -
 12002                                  ; Returns : -
 12003                                  ; Calls : -
 12004                                  ; - uninstalls the keyboard ISR
 12005                                  _RemoveKeyboard
 12006                                  ;	call	_libRemoveKeyboard
 12007                                  
 12008 00000D26 0FB605[02000000]        	movzx	eax, byte [_kbINT]
 12009                                  	invoke	_Remove_Int, eax
 12010                              <1> %rotate -1
 12011                              <1> 
 12012                              <1> %rep (%0-1)
 12013                              <1> 
 12014                              <1> 
 12015                              <1> 
 12016                              <1> 
 12017                              <1> 
 12018                              <1> 
 12019                              <1> 
 12020                              <1>  %ifidni %1, cs
 12021                              <1>  o16 push %1
 12022                              <1>  %elifidni %1, ds
 12023                              <1>  o16 push %1
 12024                              <1>  %elifidni %1, es
 12025                              <1>  o16 push %1
 12026                              <1>  %elifidni %1, fs
 12027                              <1>  o16 push %1
 12028                              <1>  %elifidni %1, gs
 12029                              <1>  o16 push %1
 12030                              <1>  %elifidni %1, word cs
 12031                              <1>  o16 push %1
 12032                              <1>  %elifidni %1, word ds
 12033                              <1>  o16 push %1
 12034                              <1>  %elifidni %1, word es
 12035                              <1>  o16 push %1
 12036                              <1>  %elifidni %1, word fs
 12037                              <1>  o16 push %1
 12038                              <1>  %elifidni %1, word gs
 12039                              <1>  o16 push %1
 12040                              <1>  %else
 12041                              <1>  push %1
 12042                              <1>  %endif
 12043                              <1> 
 12044                              <1>  %rotate -1
 12045                              <1> %endrep
 12046                              <2> 
 12047                              <2> 
 12048                              <2> 
 12049                              <2> 
 12050                              <2> 
 12051                              <2> 
 12052                              <2> 
 12053                              <2>  %ifidni %1, cs
 12054                              <2>  o16 push %1
 12055                              <2>  %elifidni %1, ds
 12056                              <2>  o16 push %1
 12057                              <2>  %elifidni %1, es
 12058                              <2>  o16 push %1
 12059                              <2>  %elifidni %1, fs
 12060                              <2>  o16 push %1
 12061                              <2>  %elifidni %1, gs
 12062                              <2>  o16 push %1
 12063                              <2>  %elifidni %1, word cs
 12064                              <2>  o16 push %1
 12065                              <2>  %elifidni %1, word ds
 12066                              <2>  o16 push %1
 12067                              <2>  %elifidni %1, word es
 12068                              <2>  o16 push %1
 12069                              <2>  %elifidni %1, word fs
 12070                              <2>  o16 push %1
 12071                              <2>  %elifidni %1, word gs
 12072                              <2>  o16 push %1
 12073                              <2>  %else
 12074 00000D2D 50                  <2>  push %1
 12075                              <2>  %endif
 12076                              <2> 
 12077                              <2>  %rotate -1
 12078 00000D2E E8(00000000)        <1> call %1
 12079                              <1> %if (%0!=1)
 12080 00000D33 83C404              <1>  add esp, byte %1_arglen
 12081                              <1> %endif
 12082                                  	ret
 12083                              <1> %ifnctx proc
 12084 00000D36 C3                  <1>  ret %1
 12085                              <1> %else
 12086                              <1>  mov esp, ebp
 12087                              <1>  pop ebp
 12088                              <1>  ret %1
 12089                              <1> %endif
 12090                                  
 12091                                  ;--------------------------------------------------------------
 12092                                  ;-- void KeyboardISR(void)                                   --
 12093                                  ;--------------------------------------------------------------
 12094                                  ; Inputs : keypress waiting at port [_kbPort], [_kbIRQ]
 12095                                  ; Outputs : [_key], [_MPFlags]
 12096                                  ; Returns : -
 12097                                  ; Calls : -
 12098                                  ; - handles keyboard input from the user
 12099                                  _KeyboardISR
 12100                                  ;	call	_libKeyboardISR
 12101                                  
 12102 00000D37 668B15[04000000]        	mov	dx, [_kbPort]
 12103 00000D3E 66ED                    	in	ax, dx
 12104 00000D40 3C01                    	cmp	al, 1				;see if ESC was pressed
 12105 00000D42 0F849F000000            	je NEAR .Escape
 12106 00000D48 A880                    	test	al, 10000000b			;test whether it's a press or a release
 12107 00000D4A 7426                    	jz	.Press
 12108                                  .Release
 12109 00000D4C 247F                    	and	al, 01111111b			;set MSB to 0
 12110 00000D4E 3C2A                    	cmp	al, 42				;compare with left shift
 12111 00000D50 750C                    	jne	.RSRCheck
 12112 00000D52 8025[26000000]EF        	and	byte[_MPFlags], 11101111b	;clear the left shift flag
 12113 00000D59 E990000000              	jmp	.Ack
 12114                                  .RSRCheck
 12115 00000D5E 3C36                    	cmp	al, 54				;compare with right shift
 12116 00000D60 0F8588000000            	jne	NEAR .Ack
 12117 00000D66 8025[26000000]F7        	and	byte[_MPFlags], 11110111b	;clear the right shift flag
 12118 00000D6D E97C000000              	jmp	.Ack
 12119                                  .Press
 12120 00000D72 F605[26000000]18        	test	byte[_MPFlags], 00011000b	;check whether shift flag is set
 12121 00000D79 7527                    	jnz	.shiftDown
 12122 00000D7B BB00000000              	mov	ebx, 0
 12123 00000D80 88C3                    	mov	bl, al
 12124 00000D82 8A93[A1000000]          	mov	dl, byte[_QwertyNames+ebx]	;if shift flag is 0, use _QwertyNames
 12125 00000D88 8815[52000000]          	mov	[_key], dl
 12126 00000D8E 3C2A                    	cmp	al, 42
 12127 00000D90 742F                    	je	.LSPress
 12128 00000D92 3C36                    	cmp	al, 54
 12129 00000D94 743E                    	je	.RSPress
 12130 00000D96 800D[26000000]20        	or	byte[_MPFlags], 00100000b	;set bit 5 for key other than shift pressed
 12131 00000D9D E94C000000              	jmp	.Ack
 12132                                  .shiftDown					;Shift flag is 1, so use _QwertyShift table
 12133 00000DA2 BB00000000              	mov	ebx, 0
 12134 00000DA7 88C3                    	mov	bl, al
 12135 00000DA9 8A93[F6000000]          	mov	dl, byte[_QwertyShift+ebx]
 12136 00000DAF 8815[52000000]          	mov	[_key], dl
 12137 00000DB5 800D[26000000]20        	or	byte[_MPFlags], 00100000b	;set bit 5 for key other than shift pressed
 12138 00000DBC E92D000000              	jmp	.Ack
 12139                                  .LSPress
 12140 00000DC1 800D[26000000]10        	or	byte[_MPFlags], 00010000b	;set the appropriate flags for shift pressed
 12141 00000DC8 8025[26000000]DF        	and	byte[_MPFlags], 11011111b	;
 12142 00000DCF E91A000000              	jmp	.Ack			 	;  
 12143                                  .RSPress					;
 12144 00000DD4 800D[26000000]08        	or	byte[_MPFlags], 00001000b	;	
 12145 00000DDB 8025[26000000]DF        	and	byte[_MPFlags], 11011111b	;
 12146 00000DE2 E907000000              	jmp	.Ack				;
 12147                                  .Escape	
 12148 00000DE7 800D[26000000]01        	or	byte[_MPFlags], 00000001b
 12149                                  .Ack 	
 12150 00000DEE E461                    	in	al, 61h
 12151 00000DF0 0C40                    	or	al, 1000000b
 12152 00000DF2 E661                    	out	61h, al
 12153 00000DF4 243F                    	and	al, 0111111b
 12154 00000DF6 E661                    	out	61h, al
 12155 00000DF8 B020                    	mov	al, 20h
 12156 00000DFA E620                    	out	20h, al
 12157 00000DFC 803D[03000000]08        	cmp	byte[_kbIRQ], 8			;ACK with slave pic for [_kbIRQ]>=8
 12158 00000E03 7C04                    	jl	.Done
 12159 00000E05 B020                    	mov	al, 20h
 12160 00000E07 E6A0                    	out	0A0h, al
 12161                                  .Done
 12162                                  	ret
 12163                              <1> %ifnctx proc
 12164 00000E09 C3                  <1>  ret %1
 12165                              <1> %else
 12166                              <1>  mov esp, ebp
 12167                              <1>  pop ebp
 12168                              <1>  ret %1
 12169                              <1> %endif
 12170                                  _KeyboardISR_end
 12171                                  
 12172                                  ;--------------------------------------------------------------
 12173                                  ;-- dword InstallMouse(void)                                 --
 12174                                  ;--------------------------------------------------------------
 12175                                  ; Inputs : -
 12176                                  ; Outputs : [_MouseSeg], [_MouseOff]
 12177                                  ; Returns : 1 on error; 0 otherwise
 12178                                  ; Calls : _LockArea, _Get_RMCB, DPMI_Int
 12179                                  ; - installs the mouse callback
 12180                                  _InstallMouse
 12181                                  ;	call	_libInstallMouse
 12182                                  
 12183                                  	invoke	_LockArea, ds, _MouseX, dword 2
 12184                              <1> %rotate -1
 12185                              <1> 
 12186                              <1> %rep (%0-1)
 12187                              <1> 
 12188                              <1> 
 12189                              <1> 
 12190                              <1> 
 12191                              <1> 
 12192                              <1> 
 12193                              <1> 
 12194                              <1>  %ifidni %1, cs
 12195                              <1>  o16 push %1
 12196                              <1>  %elifidni %1, ds
 12197                              <1>  o16 push %1
 12198                              <1>  %elifidni %1, es
 12199                              <1>  o16 push %1
 12200                              <1>  %elifidni %1, fs
 12201                              <1>  o16 push %1
 12202                              <1>  %elifidni %1, gs
 12203                              <1>  o16 push %1
 12204                              <1>  %elifidni %1, word cs
 12205                              <1>  o16 push %1
 12206                              <1>  %elifidni %1, word ds
 12207                              <1>  o16 push %1
 12208                              <1>  %elifidni %1, word es
 12209                              <1>  o16 push %1
 12210                              <1>  %elifidni %1, word fs
 12211                              <1>  o16 push %1
 12212                              <1>  %elifidni %1, word gs
 12213                              <1>  o16 push %1
 12214                              <1>  %else
 12215                              <1>  push %1
 12216                              <1>  %endif
 12217                              <1> 
 12218                              <1>  %rotate -1
 12219                              <1> %endrep
 12220                              <2> 
 12221                              <2> 
 12222                              <2> 
 12223                              <2> 
 12224                              <2> 
 12225                              <2> 
 12226                              <2> 
 12227                              <2>  %ifidni %1, cs
 12228                              <2>  o16 push %1
 12229                              <2>  %elifidni %1, ds
 12230                              <2>  o16 push %1
 12231                              <2>  %elifidni %1, es
 12232                              <2>  o16 push %1
 12233                              <2>  %elifidni %1, fs
 12234                              <2>  o16 push %1
 12235                              <2>  %elifidni %1, gs
 12236                              <2>  o16 push %1
 12237                              <2>  %elifidni %1, word cs
 12238                              <2>  o16 push %1
 12239                              <2>  %elifidni %1, word ds
 12240                              <2>  o16 push %1
 12241                              <2>  %elifidni %1, word es
 12242                              <2>  o16 push %1
 12243                              <2>  %elifidni %1, word fs
 12244                              <2>  o16 push %1
 12245                              <2>  %elifidni %1, word gs
 12246                              <2>  o16 push %1
 12247                              <2>  %else
 12248 00000E0A 6802000000          <2>  push %1
 12249                              <2>  %endif
 12250                              <2> 
 12251                              <2>  %rotate -1
 12252                              <2> 
 12253                              <2> 
 12254                              <2> 
 12255                              <2> 
 12256                              <2> 
 12257                              <2> 
 12258                              <2> 
 12259                              <2>  %ifidni %1, cs
 12260                              <2>  o16 push %1
 12261                              <2>  %elifidni %1, ds
 12262                              <2>  o16 push %1
 12263                              <2>  %elifidni %1, es
 12264                              <2>  o16 push %1
 12265                              <2>  %elifidni %1, fs
 12266                              <2>  o16 push %1
 12267                              <2>  %elifidni %1, gs
 12268                              <2>  o16 push %1
 12269                              <2>  %elifidni %1, word cs
 12270                              <2>  o16 push %1
 12271                              <2>  %elifidni %1, word ds
 12272                              <2>  o16 push %1
 12273                              <2>  %elifidni %1, word es
 12274                              <2>  o16 push %1
 12275                              <2>  %elifidni %1, word fs
 12276                              <2>  o16 push %1
 12277                              <2>  %elifidni %1, word gs
 12278                              <2>  o16 push %1
 12279                              <2>  %else
 12280 00000E0F 68[0A000000]        <2>  push %1
 12281                              <2>  %endif
 12282                              <2> 
 12283                              <2>  %rotate -1
 12284                              <2> 
 12285                              <2> 
 12286                              <2> 
 12287                              <2> 
 12288                              <2> 
 12289                              <2> 
 12290                              <2> 
 12291                              <2>  %ifidni %1, cs
 12292                              <2>  o16 push %1
 12293                              <2>  %elifidni %1, ds
 12294 00000E14 661E                <2>  o16 push %1
 12295                              <2>  %elifidni %1, es
 12296                              <2>  o16 push %1
 12297                              <2>  %elifidni %1, fs
 12298                              <2>  o16 push %1
 12299                              <2>  %elifidni %1, gs
 12300                              <2>  o16 push %1
 12301                              <2>  %elifidni %1, word cs
 12302                              <2>  o16 push %1
 12303                              <2>  %elifidni %1, word ds
 12304                              <2>  o16 push %1
 12305                              <2>  %elifidni %1, word es
 12306                              <2>  o16 push %1
 12307                              <2>  %elifidni %1, word fs
 12308                              <2>  o16 push %1
 12309                              <2>  %elifidni %1, word gs
 12310                              <2>  o16 push %1
 12311                              <2>  %else
 12312                              <2>  push %1
 12313                              <2>  %endif
 12314                              <2> 
 12315                              <2>  %rotate -1
 12316 00000E16 E8(00000000)        <1> call %1
 12317                              <1> %if (%0!=1)
 12318 00000E1B 83C40A              <1>  add esp, byte %1_arglen
 12319                              <1> %endif
 12320                                  	invoke	_LockArea, ds, _MouseY, dword 2
 12321                              <1> %rotate -1
 12322                              <1> 
 12323                              <1> %rep (%0-1)
 12324                              <1> 
 12325                              <1> 
 12326                              <1> 
 12327                              <1> 
 12328                              <1> 
 12329                              <1> 
 12330                              <1> 
 12331                              <1>  %ifidni %1, cs
 12332                              <1>  o16 push %1
 12333                              <1>  %elifidni %1, ds
 12334                              <1>  o16 push %1
 12335                              <1>  %elifidni %1, es
 12336                              <1>  o16 push %1
 12337                              <1>  %elifidni %1, fs
 12338                              <1>  o16 push %1
 12339                              <1>  %elifidni %1, gs
 12340                              <1>  o16 push %1
 12341                              <1>  %elifidni %1, word cs
 12342                              <1>  o16 push %1
 12343                              <1>  %elifidni %1, word ds
 12344                              <1>  o16 push %1
 12345                              <1>  %elifidni %1, word es
 12346                              <1>  o16 push %1
 12347                              <1>  %elifidni %1, word fs
 12348                              <1>  o16 push %1
 12349                              <1>  %elifidni %1, word gs
 12350                              <1>  o16 push %1
 12351                              <1>  %else
 12352                              <1>  push %1
 12353                              <1>  %endif
 12354                              <1> 
 12355                              <1>  %rotate -1
 12356                              <1> %endrep
 12357                              <2> 
 12358                              <2> 
 12359                              <2> 
 12360                              <2> 
 12361                              <2> 
 12362                              <2> 
 12363                              <2> 
 12364                              <2>  %ifidni %1, cs
 12365                              <2>  o16 push %1
 12366                              <2>  %elifidni %1, ds
 12367                              <2>  o16 push %1
 12368                              <2>  %elifidni %1, es
 12369                              <2>  o16 push %1
 12370                              <2>  %elifidni %1, fs
 12371                              <2>  o16 push %1
 12372                              <2>  %elifidni %1, gs
 12373                              <2>  o16 push %1
 12374                              <2>  %elifidni %1, word cs
 12375                              <2>  o16 push %1
 12376                              <2>  %elifidni %1, word ds
 12377                              <2>  o16 push %1
 12378                              <2>  %elifidni %1, word es
 12379                              <2>  o16 push %1
 12380                              <2>  %elifidni %1, word fs
 12381                              <2>  o16 push %1
 12382                              <2>  %elifidni %1, word gs
 12383                              <2>  o16 push %1
 12384                              <2>  %else
 12385 00000E1E 6802000000          <2>  push %1
 12386                              <2>  %endif
 12387                              <2> 
 12388                              <2>  %rotate -1
 12389                              <2> 
 12390                              <2> 
 12391                              <2> 
 12392                              <2> 
 12393                              <2> 
 12394                              <2> 
 12395                              <2> 
 12396                              <2>  %ifidni %1, cs
 12397                              <2>  o16 push %1
 12398                              <2>  %elifidni %1, ds
 12399                              <2>  o16 push %1
 12400                              <2>  %elifidni %1, es
 12401                              <2>  o16 push %1
 12402                              <2>  %elifidni %1, fs
 12403                              <2>  o16 push %1
 12404                              <2>  %elifidni %1, gs
 12405                              <2>  o16 push %1
 12406                              <2>  %elifidni %1, word cs
 12407                              <2>  o16 push %1
 12408                              <2>  %elifidni %1, word ds
 12409                              <2>  o16 push %1
 12410                              <2>  %elifidni %1, word es
 12411                              <2>  o16 push %1
 12412                              <2>  %elifidni %1, word fs
 12413                              <2>  o16 push %1
 12414                              <2>  %elifidni %1, word gs
 12415                              <2>  o16 push %1
 12416                              <2>  %else
 12417 00000E23 68[0C000000]        <2>  push %1
 12418                              <2>  %endif
 12419                              <2> 
 12420                              <2>  %rotate -1
 12421                              <2> 
 12422                              <2> 
 12423                              <2> 
 12424                              <2> 
 12425                              <2> 
 12426                              <2> 
 12427                              <2> 
 12428                              <2>  %ifidni %1, cs
 12429                              <2>  o16 push %1
 12430                              <2>  %elifidni %1, ds
 12431 00000E28 661E                <2>  o16 push %1
 12432                              <2>  %elifidni %1, es
 12433                              <2>  o16 push %1
 12434                              <2>  %elifidni %1, fs
 12435                              <2>  o16 push %1
 12436                              <2>  %elifidni %1, gs
 12437                              <2>  o16 push %1
 12438                              <2>  %elifidni %1, word cs
 12439                              <2>  o16 push %1
 12440                              <2>  %elifidni %1, word ds
 12441                              <2>  o16 push %1
 12442                              <2>  %elifidni %1, word es
 12443                              <2>  o16 push %1
 12444                              <2>  %elifidni %1, word fs
 12445                              <2>  o16 push %1
 12446                              <2>  %elifidni %1, word gs
 12447                              <2>  o16 push %1
 12448                              <2>  %else
 12449                              <2>  push %1
 12450                              <2>  %endif
 12451                              <2> 
 12452                              <2>  %rotate -1
 12453 00000E2A E8(00000000)        <1> call %1
 12454                              <1> %if (%0!=1)
 12455 00000E2F 83C40A              <1>  add esp, byte %1_arglen
 12456                              <1> %endif
 12457                                  	invoke	_LockArea, ds, _MPFlags, dword 1
 12458                              <1> %rotate -1
 12459                              <1> 
 12460                              <1> %rep (%0-1)
 12461                              <1> 
 12462                              <1> 
 12463                              <1> 
 12464                              <1> 
 12465                              <1> 
 12466                              <1> 
 12467                              <1> 
 12468                              <1>  %ifidni %1, cs
 12469                              <1>  o16 push %1
 12470                              <1>  %elifidni %1, ds
 12471                              <1>  o16 push %1
 12472                              <1>  %elifidni %1, es
 12473                              <1>  o16 push %1
 12474                              <1>  %elifidni %1, fs
 12475                              <1>  o16 push %1
 12476                              <1>  %elifidni %1, gs
 12477                              <1>  o16 push %1
 12478                              <1>  %elifidni %1, word cs
 12479                              <1>  o16 push %1
 12480                              <1>  %elifidni %1, word ds
 12481                              <1>  o16 push %1
 12482                              <1>  %elifidni %1, word es
 12483                              <1>  o16 push %1
 12484                              <1>  %elifidni %1, word fs
 12485                              <1>  o16 push %1
 12486                              <1>  %elifidni %1, word gs
 12487                              <1>  o16 push %1
 12488                              <1>  %else
 12489                              <1>  push %1
 12490                              <1>  %endif
 12491                              <1> 
 12492                              <1>  %rotate -1
 12493                              <1> %endrep
 12494                              <2> 
 12495                              <2> 
 12496                              <2> 
 12497                              <2> 
 12498                              <2> 
 12499                              <2> 
 12500                              <2> 
 12501                              <2>  %ifidni %1, cs
 12502                              <2>  o16 push %1
 12503                              <2>  %elifidni %1, ds
 12504                              <2>  o16 push %1
 12505                              <2>  %elifidni %1, es
 12506                              <2>  o16 push %1
 12507                              <2>  %elifidni %1, fs
 12508                              <2>  o16 push %1
 12509                              <2>  %elifidni %1, gs
 12510                              <2>  o16 push %1
 12511                              <2>  %elifidni %1, word cs
 12512                              <2>  o16 push %1
 12513                              <2>  %elifidni %1, word ds
 12514                              <2>  o16 push %1
 12515                              <2>  %elifidni %1, word es
 12516                              <2>  o16 push %1
 12517                              <2>  %elifidni %1, word fs
 12518                              <2>  o16 push %1
 12519                              <2>  %elifidni %1, word gs
 12520                              <2>  o16 push %1
 12521                              <2>  %else
 12522 00000E32 6801000000          <2>  push %1
 12523                              <2>  %endif
 12524                              <2> 
 12525                              <2>  %rotate -1
 12526                              <2> 
 12527                              <2> 
 12528                              <2> 
 12529                              <2> 
 12530                              <2> 
 12531                              <2> 
 12532                              <2> 
 12533                              <2>  %ifidni %1, cs
 12534                              <2>  o16 push %1
 12535                              <2>  %elifidni %1, ds
 12536                              <2>  o16 push %1
 12537                              <2>  %elifidni %1, es
 12538                              <2>  o16 push %1
 12539                              <2>  %elifidni %1, fs
 12540                              <2>  o16 push %1
 12541                              <2>  %elifidni %1, gs
 12542                              <2>  o16 push %1
 12543                              <2>  %elifidni %1, word cs
 12544                              <2>  o16 push %1
 12545                              <2>  %elifidni %1, word ds
 12546                              <2>  o16 push %1
 12547                              <2>  %elifidni %1, word es
 12548                              <2>  o16 push %1
 12549                              <2>  %elifidni %1, word fs
 12550                              <2>  o16 push %1
 12551                              <2>  %elifidni %1, word gs
 12552                              <2>  o16 push %1
 12553                              <2>  %else
 12554 00000E37 68[26000000]        <2>  push %1
 12555                              <2>  %endif
 12556                              <2> 
 12557                              <2>  %rotate -1
 12558                              <2> 
 12559                              <2> 
 12560                              <2> 
 12561                              <2> 
 12562                              <2> 
 12563                              <2> 
 12564                              <2> 
 12565                              <2>  %ifidni %1, cs
 12566                              <2>  o16 push %1
 12567                              <2>  %elifidni %1, ds
 12568 00000E3C 661E                <2>  o16 push %1
 12569                              <2>  %elifidni %1, es
 12570                              <2>  o16 push %1
 12571                              <2>  %elifidni %1, fs
 12572                              <2>  o16 push %1
 12573                              <2>  %elifidni %1, gs
 12574                              <2>  o16 push %1
 12575                              <2>  %elifidni %1, word cs
 12576                              <2>  o16 push %1
 12577                              <2>  %elifidni %1, word ds
 12578                              <2>  o16 push %1
 12579                              <2>  %elifidni %1, word es
 12580                              <2>  o16 push %1
 12581                              <2>  %elifidni %1, word fs
 12582                              <2>  o16 push %1
 12583                              <2>  %elifidni %1, word gs
 12584                              <2>  o16 push %1
 12585                              <2>  %else
 12586                              <2>  push %1
 12587                              <2>  %endif
 12588                              <2> 
 12589                              <2>  %rotate -1
 12590 00000E3E E8(00000000)        <1> call %1
 12591                              <1> %if (%0!=1)
 12592 00000E43 83C40A              <1>  add esp, byte %1_arglen
 12593                              <1> %endif
 12594                                  	invoke	_LockArea, cs, _MouseCallback, _MouseCallback_end-_MouseCallback
 12595                              <1> %rotate -1
 12596                              <1> 
 12597                              <1> %rep (%0-1)
 12598                              <1> 
 12599                              <1> 
 12600                              <1> 
 12601                              <1> 
 12602                              <1> 
 12603                              <1> 
 12604                              <1> 
 12605                              <1>  %ifidni %1, cs
 12606                              <1>  o16 push %1
 12607                              <1>  %elifidni %1, ds
 12608                              <1>  o16 push %1
 12609                              <1>  %elifidni %1, es
 12610                              <1>  o16 push %1
 12611                              <1>  %elifidni %1, fs
 12612                              <1>  o16 push %1
 12613                              <1>  %elifidni %1, gs
 12614                              <1>  o16 push %1
 12615                              <1>  %elifidni %1, word cs
 12616                              <1>  o16 push %1
 12617                              <1>  %elifidni %1, word ds
 12618                              <1>  o16 push %1
 12619                              <1>  %elifidni %1, word es
 12620                              <1>  o16 push %1
 12621                              <1>  %elifidni %1, word fs
 12622                              <1>  o16 push %1
 12623                              <1>  %elifidni %1, word gs
 12624                              <1>  o16 push %1
 12625                              <1>  %else
 12626                              <1>  push %1
 12627                              <1>  %endif
 12628                              <1> 
 12629                              <1>  %rotate -1
 12630                              <1> %endrep
 12631                              <2> 
 12632                              <2> 
 12633                              <2> 
 12634                              <2> 
 12635                              <2> 
 12636                              <2> 
 12637                              <2> 
 12638                              <2>  %ifidni %1, cs
 12639                              <2>  o16 push %1
 12640                              <2>  %elifidni %1, ds
 12641                              <2>  o16 push %1
 12642                              <2>  %elifidni %1, es
 12643                              <2>  o16 push %1
 12644                              <2>  %elifidni %1, fs
 12645                              <2>  o16 push %1
 12646                              <2>  %elifidni %1, gs
 12647                              <2>  o16 push %1
 12648                              <2>  %elifidni %1, word cs
 12649                              <2>  o16 push %1
 12650                              <2>  %elifidni %1, word ds
 12651                              <2>  o16 push %1
 12652                              <2>  %elifidni %1, word es
 12653                              <2>  o16 push %1
 12654                              <2>  %elifidni %1, word fs
 12655                              <2>  o16 push %1
 12656                              <2>  %elifidni %1, word gs
 12657                              <2>  o16 push %1
 12658                              <2>  %else
 12659 00000E46 685F000000          <2>  push %1
 12660                              <2>  %endif
 12661                              <2> 
 12662                              <2>  %rotate -1
 12663                              <2> 
 12664                              <2> 
 12665                              <2> 
 12666                              <2> 
 12667                              <2> 
 12668                              <2> 
 12669                              <2> 
 12670                              <2>  %ifidni %1, cs
 12671                              <2>  o16 push %1
 12672                              <2>  %elifidni %1, ds
 12673                              <2>  o16 push %1
 12674                              <2>  %elifidni %1, es
 12675                              <2>  o16 push %1
 12676                              <2>  %elifidni %1, fs
 12677                              <2>  o16 push %1
 12678                              <2>  %elifidni %1, gs
 12679                              <2>  o16 push %1
 12680                              <2>  %elifidni %1, word cs
 12681                              <2>  o16 push %1
 12682                              <2>  %elifidni %1, word ds
 12683                              <2>  o16 push %1
 12684                              <2>  %elifidni %1, word es
 12685                              <2>  o16 push %1
 12686                              <2>  %elifidni %1, word fs
 12687                              <2>  o16 push %1
 12688                              <2>  %elifidni %1, word gs
 12689                              <2>  o16 push %1
 12690                              <2>  %else
 12691 00000E4B 68[0A0F0000]        <2>  push %1
 12692                              <2>  %endif
 12693                              <2> 
 12694                              <2>  %rotate -1
 12695                              <2> 
 12696                              <2> 
 12697                              <2> 
 12698                              <2> 
 12699                              <2> 
 12700                              <2> 
 12701                              <2> 
 12702                              <2>  %ifidni %1, cs
 12703 00000E50 660E                <2>  o16 push %1
 12704                              <2>  %elifidni %1, ds
 12705                              <2>  o16 push %1
 12706                              <2>  %elifidni %1, es
 12707                              <2>  o16 push %1
 12708                              <2>  %elifidni %1, fs
 12709                              <2>  o16 push %1
 12710                              <2>  %elifidni %1, gs
 12711                              <2>  o16 push %1
 12712                              <2>  %elifidni %1, word cs
 12713                              <2>  o16 push %1
 12714                              <2>  %elifidni %1, word ds
 12715                              <2>  o16 push %1
 12716                              <2>  %elifidni %1, word es
 12717                              <2>  o16 push %1
 12718                              <2>  %elifidni %1, word fs
 12719                              <2>  o16 push %1
 12720                              <2>  %elifidni %1, word gs
 12721                              <2>  o16 push %1
 12722                              <2>  %else
 12723                              <2>  push %1
 12724                              <2>  %endif
 12725                              <2> 
 12726                              <2>  %rotate -1
 12727 00000E52 E8(00000000)        <1> call %1
 12728                              <1> %if (%0!=1)
 12729 00000E57 83C40A              <1>  add esp, byte %1_arglen
 12730                              <1> %endif
 12731                                  	invoke  _Get_RMCB, _MouseSeg, _MouseOff, _MouseCallback, 1
 12732                              <1> %rotate -1
 12733                              <1> 
 12734                              <1> %rep (%0-1)
 12735                              <1> 
 12736                              <1> 
 12737                              <1> 
 12738                              <1> 
 12739                              <1> 
 12740                              <1> 
 12741                              <1> 
 12742                              <1>  %ifidni %1, cs
 12743                              <1>  o16 push %1
 12744                              <1>  %elifidni %1, ds
 12745                              <1>  o16 push %1
 12746                              <1>  %elifidni %1, es
 12747                              <1>  o16 push %1
 12748                              <1>  %elifidni %1, fs
 12749                              <1>  o16 push %1
 12750                              <1>  %elifidni %1, gs
 12751                              <1>  o16 push %1
 12752                              <1>  %elifidni %1, word cs
 12753                              <1>  o16 push %1
 12754                              <1>  %elifidni %1, word ds
 12755                              <1>  o16 push %1
 12756                              <1>  %elifidni %1, word es
 12757                              <1>  o16 push %1
 12758                              <1>  %elifidni %1, word fs
 12759                              <1>  o16 push %1
 12760                              <1>  %elifidni %1, word gs
 12761                              <1>  o16 push %1
 12762                              <1>  %else
 12763                              <1>  push %1
 12764                              <1>  %endif
 12765                              <1> 
 12766                              <1>  %rotate -1
 12767                              <1> %endrep
 12768                              <2> 
 12769                              <2> 
 12770                              <2> 
 12771                              <2> 
 12772                              <2> 
 12773                              <2> 
 12774                              <2> 
 12775                              <2>  %ifidni %1, cs
 12776                              <2>  o16 push %1
 12777                              <2>  %elifidni %1, ds
 12778                              <2>  o16 push %1
 12779                              <2>  %elifidni %1, es
 12780                              <2>  o16 push %1
 12781                              <2>  %elifidni %1, fs
 12782                              <2>  o16 push %1
 12783                              <2>  %elifidni %1, gs
 12784                              <2>  o16 push %1
 12785                              <2>  %elifidni %1, word cs
 12786                              <2>  o16 push %1
 12787                              <2>  %elifidni %1, word ds
 12788                              <2>  o16 push %1
 12789                              <2>  %elifidni %1, word es
 12790                              <2>  o16 push %1
 12791                              <2>  %elifidni %1, word fs
 12792                              <2>  o16 push %1
 12793                              <2>  %elifidni %1, word gs
 12794                              <2>  o16 push %1
 12795                              <2>  %else
 12796 00000E5A 6801000000          <2>  push %1
 12797                              <2>  %endif
 12798                              <2> 
 12799                              <2>  %rotate -1
 12800                              <2> 
 12801                              <2> 
 12802                              <2> 
 12803                              <2> 
 12804                              <2> 
 12805                              <2> 
 12806                              <2> 
 12807                              <2>  %ifidni %1, cs
 12808                              <2>  o16 push %1
 12809                              <2>  %elifidni %1, ds
 12810                              <2>  o16 push %1
 12811                              <2>  %elifidni %1, es
 12812                              <2>  o16 push %1
 12813                              <2>  %elifidni %1, fs
 12814                              <2>  o16 push %1
 12815                              <2>  %elifidni %1, gs
 12816                              <2>  o16 push %1
 12817                              <2>  %elifidni %1, word cs
 12818                              <2>  o16 push %1
 12819                              <2>  %elifidni %1, word ds
 12820                              <2>  o16 push %1
 12821                              <2>  %elifidni %1, word es
 12822                              <2>  o16 push %1
 12823                              <2>  %elifidni %1, word fs
 12824                              <2>  o16 push %1
 12825                              <2>  %elifidni %1, word gs
 12826                              <2>  o16 push %1
 12827                              <2>  %else
 12828 00000E5F 68[0A0F0000]        <2>  push %1
 12829                              <2>  %endif
 12830                              <2> 
 12831                              <2>  %rotate -1
 12832                              <2> 
 12833                              <2> 
 12834                              <2> 
 12835                              <2> 
 12836                              <2> 
 12837                              <2> 
 12838                              <2> 
 12839                              <2>  %ifidni %1, cs
 12840                              <2>  o16 push %1
 12841                              <2>  %elifidni %1, ds
 12842                              <2>  o16 push %1
 12843                              <2>  %elifidni %1, es
 12844                              <2>  o16 push %1
 12845                              <2>  %elifidni %1, fs
 12846                              <2>  o16 push %1
 12847                              <2>  %elifidni %1, gs
 12848                              <2>  o16 push %1
 12849                              <2>  %elifidni %1, word cs
 12850                              <2>  o16 push %1
 12851                              <2>  %elifidni %1, word ds
 12852                              <2>  o16 push %1
 12853                              <2>  %elifidni %1, word es
 12854                              <2>  o16 push %1
 12855                              <2>  %elifidni %1, word fs
 12856                              <2>  o16 push %1
 12857                              <2>  %elifidni %1, word gs
 12858                              <2>  o16 push %1
 12859                              <2>  %else
 12860 00000E64 68[08000000]        <2>  push %1
 12861                              <2>  %endif
 12862                              <2> 
 12863                              <2>  %rotate -1
 12864                              <2> 
 12865                              <2> 
 12866                              <2> 
 12867                              <2> 
 12868                              <2> 
 12869                              <2> 
 12870                              <2> 
 12871                              <2>  %ifidni %1, cs
 12872                              <2>  o16 push %1
 12873                              <2>  %elifidni %1, ds
 12874                              <2>  o16 push %1
 12875                              <2>  %elifidni %1, es
 12876                              <2>  o16 push %1
 12877                              <2>  %elifidni %1, fs
 12878                              <2>  o16 push %1
 12879                              <2>  %elifidni %1, gs
 12880                              <2>  o16 push %1
 12881                              <2>  %elifidni %1, word cs
 12882                              <2>  o16 push %1
 12883                              <2>  %elifidni %1, word ds
 12884                              <2>  o16 push %1
 12885                              <2>  %elifidni %1, word es
 12886                              <2>  o16 push %1
 12887                              <2>  %elifidni %1, word fs
 12888                              <2>  o16 push %1
 12889                              <2>  %elifidni %1, word gs
 12890                              <2>  o16 push %1
 12891                              <2>  %else
 12892 00000E69 68[06000000]        <2>  push %1
 12893                              <2>  %endif
 12894                              <2> 
 12895                              <2>  %rotate -1
 12896 00000E6E E8(00000000)        <1> call %1
 12897                              <1> %if (%0!=1)
 12898 00000E73 83C410              <1>  add esp, byte %1_arglen
 12899                              <1> %endif
 12900 00000E76 3D00000000              	cmp		eax, 0
 12901 00000E7B 7543                    	jne		.Error
 12902 00000E7D 66C705[00000000]0C-     	mov		word [DPMI_EAX], 000Ch              ;function 000Ch
 12903 00000E85 00                 
 12904 00000E86 66C705[00000000]07-     	mov		word [DPMI_ECX], 0007h              ;bits 0,1,2 for call mask
 12905 00000E8E 00                 
 12906 00000E8F 668B0D[06000000]        	mov		cx, [_MouseSeg] 
 12907 00000E96 66890D[00000000]        	mov		word [DPMI_ES],cx                   ;segment address
 12908 00000E9D 668B0D[08000000]        	mov		cx, [_MouseOff]                    
 12909 00000EA4 66890D[00000000]        	mov		word [DPMI_EDX], cx                 ;offset address
 12910 00000EAB 66BB3300                	mov		bx, 33h
 12911 00000EAF E8(00000000)            	call	DPMI_Int
 12912 00000EB4 720A                    	jc		.Error
 12913 00000EB6 B800000000              	mov		eax, 0
 12914 00000EBB E905000000              	jmp		.Done
 12915                                  .Error
 12916 00000EC0 B801000000              	mov		eax, 1
 12917                                  .Done
 12918                                          ret			    
 12919                              <1> %ifnctx proc
 12920 00000EC5 C3                  <1>  ret %1
 12921                              <1> %else
 12922                              <1>  mov esp, ebp
 12923                              <1>  pop ebp
 12924                              <1>  ret %1
 12925                              <1> %endif
 12926                                  
 12927                                  ;--------------------------------------------------------------
 12928                                  ;-- void RemoveMouse(void)                                   --
 12929                                  ;--------------------------------------------------------------
 12930                                  ; Inputs : [_MouseSeg], [_MouseOff]
 12931                                  ; Outputs : -
 12932                                  ; Returns : -
 12933                                  ; Calls : _Free_RMCB, DPMI_Int
 12934                                  ; - removes the mouse callback
 12935                                  _RemoveMouse
 12936                                  ;	call	_libRemoveMouse
 12937                                  
 12938 00000EC6 66C705[00000000]0C-     	mov	word [DPMI_EAX], 000Ch	;function 000Ch
 12939 00000ECE 00                 
 12940 00000ECF 66C705[00000000]07-     	mov	word [DPMI_ECX], 0007h	;bits 0,1,2 for call mask
 12941 00000ED7 00                 
 12942 00000ED8 66C705[00000000]00-     	mov	word [DPMI_ES], 0	;0000:0000 for "no callback"
 12943 00000EE0 00                 
 12944 00000EE1 66C705[00000000]00-     	mov	word [DPMI_EDX], 0
 12945 00000EE9 00                 
 12946 00000EEA 66BB3300                	mov	bx, 33h
 12947 00000EEE E8(00000000)            	call	DPMI_Int
 12948                                          invoke  _Free_RMCB, word[_MouseSeg], word[_MouseOff]
 12949                              <1> %rotate -1
 12950                              <1> 
 12951                              <1> %rep (%0-1)
 12952                              <1> 
 12953                              <1> 
 12954                              <1> 
 12955                              <1> 
 12956                              <1> 
 12957                              <1> 
 12958                              <1> 
 12959                              <1>  %ifidni %1, cs
 12960                              <1>  o16 push %1
 12961                              <1>  %elifidni %1, ds
 12962                              <1>  o16 push %1
 12963                              <1>  %elifidni %1, es
 12964                              <1>  o16 push %1
 12965                              <1>  %elifidni %1, fs
 12966                              <1>  o16 push %1
 12967                              <1>  %elifidni %1, gs
 12968                              <1>  o16 push %1
 12969                              <1>  %elifidni %1, word cs
 12970                              <1>  o16 push %1
 12971                              <1>  %elifidni %1, word ds
 12972                              <1>  o16 push %1
 12973                              <1>  %elifidni %1, word es
 12974                              <1>  o16 push %1
 12975                              <1>  %elifidni %1, word fs
 12976                              <1>  o16 push %1
 12977                              <1>  %elifidni %1, word gs
 12978                              <1>  o16 push %1
 12979                              <1>  %else
 12980                              <1>  push %1
 12981                              <1>  %endif
 12982                              <1> 
 12983                              <1>  %rotate -1
 12984                              <1> %endrep
 12985                              <2> 
 12986                              <2> 
 12987                              <2> 
 12988                              <2> 
 12989                              <2> 
 12990                              <2> 
 12991                              <2> 
 12992                              <2>  %ifidni %1, cs
 12993                              <2>  o16 push %1
 12994                              <2>  %elifidni %1, ds
 12995                              <2>  o16 push %1
 12996                              <2>  %elifidni %1, es
 12997                              <2>  o16 push %1
 12998                              <2>  %elifidni %1, fs
 12999                              <2>  o16 push %1
 13000                              <2>  %elifidni %1, gs
 13001                              <2>  o16 push %1
 13002                              <2>  %elifidni %1, word cs
 13003                              <2>  o16 push %1
 13004                              <2>  %elifidni %1, word ds
 13005                              <2>  o16 push %1
 13006                              <2>  %elifidni %1, word es
 13007                              <2>  o16 push %1
 13008                              <2>  %elifidni %1, word fs
 13009                              <2>  o16 push %1
 13010                              <2>  %elifidni %1, word gs
 13011                              <2>  o16 push %1
 13012                              <2>  %else
 13013 00000EF3 66FF35[08000000]    <2>  push %1
 13014                              <2>  %endif
 13015                              <2> 
 13016                              <2>  %rotate -1
 13017                              <2> 
 13018                              <2> 
 13019                              <2> 
 13020                              <2> 
 13021                              <2> 
 13022                              <2> 
 13023                              <2> 
 13024                              <2>  %ifidni %1, cs
 13025                              <2>  o16 push %1
 13026                              <2>  %elifidni %1, ds
 13027                              <2>  o16 push %1
 13028                              <2>  %elifidni %1, es
 13029                              <2>  o16 push %1
 13030                              <2>  %elifidni %1, fs
 13031                              <2>  o16 push %1
 13032                              <2>  %elifidni %1, gs
 13033                              <2>  o16 push %1
 13034                              <2>  %elifidni %1, word cs
 13035                              <2>  o16 push %1
 13036                              <2>  %elifidni %1, word ds
 13037                              <2>  o16 push %1
 13038                              <2>  %elifidni %1, word es
 13039                              <2>  o16 push %1
 13040                              <2>  %elifidni %1, word fs
 13041                              <2>  o16 push %1
 13042                              <2>  %elifidni %1, word gs
 13043                              <2>  o16 push %1
 13044                              <2>  %else
 13045 00000EFA 66FF35[06000000]    <2>  push %1
 13046                              <2>  %endif
 13047                              <2> 
 13048                              <2>  %rotate -1
 13049 00000F01 E8(00000000)        <1> call %1
 13050                              <1> %if (%0!=1)
 13051 00000F06 83C404              <1>  add esp, byte %1_arglen
 13052                              <1> %endif
 13053                                          ret
 13054                              <1> %ifnctx proc
 13055 00000F09 C3                  <1>  ret %1
 13056                              <1> %else
 13057                              <1>  mov esp, ebp
 13058                              <1>  pop ebp
 13059                              <1>  ret %1
 13060                              <1> %endif
 13061                                  
 13062                                  ;--------------------------------------------------------------
 13063                                  ;-- void MouseCallback(dword *DPMIRegsPtr)                   --
 13064                                  ;--------------------------------------------------------------
 13065                                  ; Inputs : DPMIRegsPtr - pointer to DPMI register structure
 13066                                  ;          [_MouseX], [_MouseY], [_MPFlags]
 13067                                  ; Outputs : [_MouseX], [_MouseY], [_MPFlags]
 13068                                  ; Returns : -
 13069                                  ; Calls : -
 13070                                  ; - handles mouse input from user
 13071                                  proc _MouseCallback
 13072                              <1> %ifctx proc
 13073                              <1> %error Mismatched `endproc'/`proc'
 13074                              <1> %else
 13075                              <1> %push proc
 13076                              <1>  global %1
 13077 00000F0A 55                  <1> %1: push ebp
 13078 00000F0B 89E5                <1>  mov ebp, esp
 13079                              <1> %assign %$arg 8
 13080                              <1> %assign %$local 0
 13081                              <1> 
 13082                              <1> %define %$procname %1
 13083                              <1> %endif
 13084                                  .DPMIRegsPtr   arg     4
 13085                              <1> .DPMIRegsPtr equ %$arg
 13086                              <1> 
 13087                              <1> 
 13088                              <1> %assign %$arg %1+%$arg
 13089                                  
 13090                                  ;	invoke	_libMouseCallback, dword [ebp+.DPMIRegsPtr]
 13091                                  
 13092 00000F0D 8B4508                  	mov	eax, dword[ebp+.DPMIRegsPtr]
 13093 00000F10 26668B5018              	mov	dx, [es:eax+DPMI_ECX_off]           
 13094 00000F15 668915[0A000000]        	mov	[_MouseX], dx			;update YCoord
 13095 00000F1C 26668B5014              	mov	dx, [es:eax+DPMI_EDX_off]	;update XCoord
 13096 00000F21 668915[0C000000]        	mov	[_MouseY], dx
 13097                                  .TestButton
 13098 00000F28 26668B5010              	mov	dx, [es:eax+DPMI_EBX_off]	;status reg
 13099 00000F2D 6681E20100              	and	dx, 0001h			;bit 0, button press
 13100 00000F32 6681FA0000              	cmp	dx, 0
 13101 00000F37 7415                    	je	.ButtonUp
 13102                                  .ButtonDown
 13103 00000F39 F605[26000000]02        	test	byte[_MPFlags], 00000010b	;see if button was already down
 13104 00000F40 7523                    	jnz	.Done
 13105 00000F42 800D[26000000]06        	or	byte[_MPFlags], 00000110b	;if it wasn't, update flags
 13106 00000F49 E917000000              	jmp	.Done
 13107                                  .ButtonUp
 13108 00000F4E F605[26000000]02        	test	byte[_MPFlags], 00000010b	;see if the button was already up
 13109 00000F55 740E                    	jz	.Done
 13110 00000F57 800D[26000000]04        	or	byte[_MPFlags], 00000100b	;if it wasn't down, update flags
 13111 00000F5E 8025[26000000]FD        	and	byte[_MPFlags], 11111101b
 13112                                  .Done
 13113                                  	ret
 13114                              <1> %ifnctx proc
 13115                              <1>  ret %1
 13116                              <1> %else
 13117 00000F65 89EC                <1>  mov esp, ebp
 13118 00000F67 5D                  <1>  pop ebp
 13119 00000F68 C3                  <1>  ret %1
 13120                              <1> %endif
 13121                                  
 13122                                  endproc
 13123                              <1> %ifnctx proc
 13124                              <1> %error Mismatched `endproc'/`proc'
 13125                              <1> %else
 13126                              <1> .STACK_FRAME_SIZE equ %$local
 13127                              <1> 
 13128                              <1> 
 13129                              <1> %ifdef LEGACY_ENDPROC
 13130                              <1>  ret
 13131                              <1> %endif
 13132                              <1> 
 13133                              <1> 
 13134                              <1> 
 13135                              <1> 
 13136                              <1> 
 13137                              <1> 
 13138                              <1> 
 13139                              <1> 
 13140                              <1> 
 13141                              <1> %pop
 13142                              <1> %endif
 13143                                  _MouseCallback_end
 13144                                  _MouseCallback_arglen	EQU	4
